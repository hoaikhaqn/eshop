(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{352:function(t,e,n){(function(t,e){!function(n){"use strict";try{(function(){var r,i=function(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}(n);function o(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),s=c[e];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[s].apply(console,o(["["+i+"]  "+t.name+":"],n))}}(Te=r=r||{})[Te.DEBUG=0]="DEBUG",Te[Te.VERBOSE=1]="VERBOSE",Te[Te.INFO=2]="INFO",Te[Te.WARN=3]="WARN",Te[Te.ERROR=4]="ERROR",Te[Te.SILENT=5]="SILENT";var u={debug:r.DEBUG,verbose:r.VERBOSE,info:r.INFO,warn:r.WARN,error:r.ERROR,silent:r.SILENT},a=r.INFO,c=((Ne={})[r.DEBUG]="log",Ne[r.VERBOSE]="log",Ne[r.INFO]="info",Ne[r.WARN]="warn",Ne[r.ERROR]="error",Ne),h=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in r))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?u[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,o([this,r.DEBUG],t)),this._logHandler.apply(this,o([this,r.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,o([this,r.VERBOSE],t)),this._logHandler.apply(this,o([this,r.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,o([this,r.INFO],t)),this._logHandler.apply(this,o([this,r.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,o([this,r.WARN],t)),this._logHandler.apply(this,o([this,r.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,o([this,r.ERROR],t)),this._logHandler.apply(this,o([this,r.ERROR],t))},f);function f(t){this.name=t,this._logLevel=a,this._logHandler=s,this._userLogHandler=null}var l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function p(t,e){function n(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function d(t,e,n,r){return new(n=n||Promise)((function(i,o){function s(t){try{a(r.next(t))}catch(t){o(t)}}function u(t){try{a(r.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):((e=t.value)instanceof n?e:new n((function(t){t(e)}))).then(s,u)}a((r=r.apply(t,e||[])).next())}))}function y(t,e){var n,r,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s={next:u(0),throw:u(1),return:u(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=0<(i=o.trys).length&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}function v(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function g(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var m,w=(p(b,m=Error),b);function b(t,e,n){return(e=m.call(this,e)||this).code=t,e.customData=n,e.name="FirebaseError",Object.setPrototypeOf(e,b.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,I.prototype.create),e}var I=(_.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t;return t=(t=this.errors[t])?(r=i,t.replace(E,(function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"}))):"Error",t=this.serviceName+": "+t+" ("+o+").",new w(o,t,i)},_);function _(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function N(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var S,A="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},x={},D=A||self;function O(){}function k(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function P(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var L="closure_uid_"+(1e9*Math.random()>>>0),C=0;function R(t,e,n){return t.call.apply(t.bind,arguments)}function V(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function M(t,e,n){return(M=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?R:V).apply(null,arguments)}function U(t){var e=Array.prototype.slice.call(arguments,1);return function(){var n=e.slice();return n.push.apply(n,arguments),t.apply(this,n)}}function j(){return Date.now()}function q(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,(t.prototype.constructor=t).Kb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,L)&&t[L]||(t[L]=++C))},F.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var H=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function G(){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function K(t){return/^[\s\xa0]*$/.test(t)}var J,W=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function Y(t,e){return t<e?-1:e<t?1:0}var Q=D.navigator;function $(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Z(t){var e,n={};for(e in t)n[e]=t[e];return n}J=Q&&(Q=Q.userAgent)?Q:"";var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<tt.length;i++)e=tt[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function nt(t){return nt[" "](t),t}nt[" "]=O;var rt,it=X(J,"Opera"),ot=X(J,"Trident")||X(J,"MSIE"),st=X(J,"Edge"),ut=st||ot,at=X(J,"Gecko")&&!(X(J.toLowerCase(),"webkit")&&!X(J,"Edge"))&&!(X(J,"Trident")||X(J,"MSIE"))&&!X(J,"Edge"),ct=X(J.toLowerCase(),"webkit")&&!X(J,"Edge");function ht(){var t=D.document;return t?t.documentMode:void 0}var ft="",lt=(lt=J,at?/rv:([^\);]+)(\)|;)/.exec(lt):st?/Edge\/([\d\.]+)/.exec(lt):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(lt):ct?/WebKit\/(\S+)/.exec(lt):it?/(?:Version)[ \/]?(\S+)/.exec(lt):void 0);lt&&(ft=lt?lt[1]:""),rt=ot&&null!=(lt=ht())&&lt>parseFloat(ft)?String(lt):ft;var pt={};function dt(t){return e=t,n=function(){for(var e=0,n=W(String(rt)).split("."),r=W(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",u=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],0==s[0].length&&0==u[0].length)break;e=Y(0==s[1].length?0:parseInt(s[1],10),0==u[1].length?0:parseInt(u[1],10))||Y(0==s[2].length,0==u[2].length)||Y(s[2],u[2]),s=s[3],u=u[3]}while(0==e)}return 0<=e},r=pt,Object.prototype.hasOwnProperty.call(r,e)?r[e]:r[e]=n();var e,n,r}var yt=D.document&&ot&&(ht()||parseInt(rt,10))||void 0,vt=!ot||9<=Number(yt),gt=ot&&!dt("9"),mt=function(){if(!D.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{D.addEventListener("test",O,e),D.removeEventListener("test",O,e)}catch(t){}return t}();function wt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function bt(t,e){if(wt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(at){t:{try{nt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:It[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}wt.prototype.b=function(){this.defaultPrevented=!0},q(bt,wt);var It={2:"touch",3:"pen",4:"mouse"};bt.prototype.b=function(){bt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,gt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var _t="closure_listenable_"+(1e6*Math.random()|0),Et=0;function Tt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Et,this.Y=this.Z=!1}function Nt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function St(t){this.src=t,this.a={},this.b=0}function At(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=H(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Nt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function xt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}St.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=xt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Tt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Dt="closure_lm_"+(1e6*Math.random()|0),Ot={};function kt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=jt(r),e&&e[_t]?e.wa(n,r,P(i)?!!i.capture:!!i,o):Pt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)kt(t,e[o],n,r,i);return null}return n=jt(n),t&&t[_t]?t.va(e,n,P(r)?!!r.capture:!!r,i):Pt(t,e,n,!1,r,i)}function Pt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=P(i)?!!i.capture:!!i;if(s&&!vt)return null;var u,a,c=Mt(t);if(c||(t[Dt]=c=new St(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Vt,r=a=vt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)mt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ct(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Lt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[_t]?At(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ct(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Mt(e))?(At(n,t),0==n.b&&(n.src=null,e[Dt]=null)):Nt(t)))}function Ct(t){return t in Ot?Ot[t]:Ot[t]="on"+t}function Rt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Lt(t),n.call(r,e)}function Vt(t,e){if(t.Y)return!0;if(vt)return Rt(t,new bt(e,this));if(!e)t:{e=["window","event"];for(var n=D,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Rt(t,e=new bt(e,this))}function Mt(t){return(t=t[Dt])instanceof St?t:null}var Ut="__closure_events_fn_"+(1e9*Math.random()>>>0);function jt(t){return"function"==typeof t?t:(t[Ut]||(t[Ut]=function(e){return t.handleEvent(e)}),t[Ut])}function qt(){F.call(this),this.c=new St(this),(this.J=this).C=null}function Ft(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new wt(e,t):e instanceof wt?e.target=e.target||t:(s=e,et(e=new wt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Ht(o,r,!0,e)&&s;if(s=Ht(o=e.a=t,r,!0,e)&&s,s=Ht(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Ht(o=e.a=n[i],r,!1,e)&&s}function Ht(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&At(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}q(qt,F),qt.prototype[_t]=!0,(S=qt.prototype).addEventListener=function(t,e,n,r){kt(this,t,e,n,r)},S.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=P(i)?!!i.capture:!!i,r=jt(r),e&&e[_t]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=xt(s=e.a[n],r,i,o))&&(Nt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Mt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=xt(n,r,i,o)),(r=-1<e?n[e]:null)&&Lt(r))}(this,t,e,n,r)},S.G=function(){if(qt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Nt(n[r]);delete e.a[t],e.b--}}this.C=null},S.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},S.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Bt=D.JSON.stringify;function Gt(){this.b=this.a=null}var zt,Kt=(Jt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Jt((function(){return new Wt}),(function(t){t.reset()})));function Jt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Wt(){this.next=this.b=this.a=null}function Xt(t,e){var n;zt||(n=D.Promise.resolve(void 0),zt=function(){n.then($t)}),Yt||(zt(),Yt=!0),Qt.add(t,e)}Gt.prototype.add=function(t,e){var n=Kt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Wt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Yt=!(Wt.prototype.reset=function(){this.next=this.b=this.a=null}),Qt=new Gt;function $t(){for(var t,e;n=e=void 0,n=null,(e=Qt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){D.setTimeout((function(){throw t}),0)}(t)}var n=Kt;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}Yt=!1}function Zt(t,e){qt.call(this),this.b=t||1,this.a=e||D,this.f=M(this.Za,this),this.g=j()}function te(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ee(t,e,n){if("function"==typeof t)n&&(t=M(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=M(t.handleEvent,t)}return 2147483647<Number(e)?-1:D.setTimeout(t,e||0)}q(Zt,qt),(S=Zt.prototype).aa=!1,S.M=null,S.Za=function(){var t;this.aa&&(0<(t=j()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Ft(this,"tick"),this.aa&&(te(this),this.start())))},S.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=j())},S.G=function(){Zt.X.G.call(this),te(this),delete this.a};var ne,re,ie,oe=(T(re=ue,ie=ne=F),re.prototype=null===ie?Object.create(ie):(se.prototype=ie.prototype,new se),ue.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ee((function(){e.a=null,e.c&&(e.c=!1,t(e))}),e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ue.prototype.G=function(){ne.prototype.G.call(this),this.a&&(D.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ue);function se(){this.constructor=re}function ue(t,e){var n=ne.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function ae(t){F.call(this),this.b=t,this.a={}}q(ae,F);var ce=[];function he(t,e,n,r){Array.isArray(n)||(n&&(ce[0]=n.toString()),n=ce);for(var i=0;i<n.length;i++){var o=kt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function fe(t){$(t.a,(function(t,e){this.a.hasOwnProperty(e)&&Lt(t)}),t),t.a={}}function le(){this.a=!0}function pe(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return Bt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}ae.prototype.G=function(){ae.X.G.call(this),fe(this)},ae.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},le.prototype.info=function(){};var de={},ye=null;function ve(){return ye=ye||new qt}function ge(t){wt.call(this,de.Fa,t)}function me(t){var e=ve();Ft(e,new ge(e))}function we(t,e){wt.call(this,de.STAT_EVENT,t),this.stat=e}function be(t){var e=ve();Ft(e,new we(e,t))}function Ie(t){wt.call(this,de.Ga,t)}function _e(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return D.setTimeout((function(){t()}),e)}de.Fa="serverreachability",q(ge,wt),de.STAT_EVENT="statevent",q(we,wt),de.Ga="timingevent",q(Ie,wt);var Ee,Te={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},Ne={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function Se(){}function Ae(t){var e;return(e=t.a)||(e=t.a={}),e}function xe(){}function De(){wt.call(this,"d")}function Oe(){wt.call(this,"c")}function ke(){}function Pe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ae(this),this.P=Le,t=ut?125:void 0,this.R=new Zt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}Se.prototype.a=null,A={OPEN:"a",eb:"b",Ea:"c",qb:"d"},q(De,wt),q(Oe,wt),q(ke,Se),Ee=new ke;var Le=45e3,Ce={},Re={};function Ve(t,e,n){t.H=1,t.i=rn(Qe(e)),t.j=n,t.I=!0,Me(t,null)}function Me(t,e){t.u=j(),je(t),t.l=Qe(t.i);var n,r,i,o,s,u,a=t.l,c=t.S;Array.isArray(c)||(c=[String(c)]),gn(a.b,"t",c),t.D=0,t.a=hr(t.g,t.g.C?e:null),0<t.O&&(t.F=new oe(M(t.Ca,t,t.a),t.O)),he(t.J,t.a,"readystatechange",t.Xa),e=t.B?Z(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),me(),n=t.c,r=t.m,i=t.l,o=t.f,s=t.S,u=t.j,n.info((function(){if(n.a)if(u)for(var t="",e=u.split("&"),a=0;a<e.length;a++){var c,h,f=e[a].split("=");1<f.length&&(c=f[0],f=f[1],t=2<=(h=c.split("_")).length&&"type"==h[1]?t+(c+"=")+f+"&":t+(c+"=redacted&"))}else t=null;else t=u;return"XMLHTTP REQ ("+o+") [attempt "+s+"]: "+r+"\n"+i+"\n"+t}))}function Ue(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Re:(i=Number(u.substring(i,o)),isNaN(i)?Ce:(o+=1)+i>u.length?Re:(u=u.substr(o,i),r.D=o+i,u)));if(u==Re){4==e&&(t.h=4,be(14),s=!1),pe(t.c,t.f,null,"[Incomplete Response]");break}if(u==Ce){t.h=4,be(15),pe(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}pe(t.c,t.f,u,null),Ge(t,u)}4==e&&0==n.length&&(t.h=1,be(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),nr(e),e.F=!0,be(11))):(pe(t.c,t.f,n,"[Invalid Chunked Response]"),Be(t),He(t))}function je(t){t.T=j()+t.P,qe(t,t.P)}function qe(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=_e(M(t.Va,t),e)}function Fe(t){t.o&&(D.clearTimeout(t.o),t.o=null)}function He(t){0==t.g.v||t.A||or(t.g,t)}function Be(t){Fe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,te(t.R),fe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ge(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||Tn(u.b,t)))if(u.I=t.N,!t.C&&Tn(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;ir(u),Jn(u)}er(u),be(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=_e(M(u.Sa,u),6e3));if(En(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else ur(u,11)}else if(!t.C&&u.a!=t||ir(u),!K(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(X(r,"spdy")||X(r,"quic")||X(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(Nn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,nn(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=j()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=cr(n,n.C?n.ga:null,n.fa),i.C?(Sn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Fe(o),je(o)),n.a=i):tr(n),0<u.g.length&&Yn(u)):"stop"!=c[0]&&"close"!=c[0]||ur(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?ur(u,7):Kn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0);me()}catch(t){}}function ze(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(k(t)||"string"==typeof t)B(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(k(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(k(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ke(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ke)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Je(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];We(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)We(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function We(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(S=Pe.prototype).setTimeout=function(t){this.P=t},S.Xa=function(t){t=t.target;var e=this.F;e&&3==Hn(t)?e.f():this.Ca(t)},S.Ca=function(t){try{if(t==this.a)t:{var e=Hn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!ut&&!this.a.$())){this.A||4!=e||7==n||me(),Fe(this);var i=this.a.W();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.S,f=e,l=i,r.info((function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l})),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,be(12),Be(this),He(this);break t}pe(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ge(this,s)}this.I?(Ue(this,e,n),ut&&this.b&&3==e&&(he(this.J,this.R,"tick",this.Wa),this.R.start())):(pe(this.c,this.f,n,null),Ge(this,n)),4==e&&Be(this),this.b&&!this.A&&(4==e?or(this.g,this):(this.b=!1,je(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,be(12)):(this.h=0,be(13)),Be(this),He(this)}}}catch(t){}var u,a,c,h,f,l},S.Wa=function(){var t,e;this.a&&(t=Hn(this.a),e=this.a.$(),this.D<e.length&&(Fe(this),Ue(this,t,e),this.b&&4!=t&&je(this)))},S.cancel=function(){this.A=!0,Be(this)},S.Va=function(){this.o=null;var t,e,n=j();0<=n-this.T?(t=this.c,e=this.l,t.info((function(){return"TIMEOUT: "+e})),2!=this.H&&(me(),be(17)),Be(this),this.h=2,He(this)):qe(this,this.T-n)},(S=Ke.prototype).K=function(){Je(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},S.L=function(){return Je(this),this.a.concat()},S.get=function(t,e){return We(this.b,t)?this.b[t]:e},S.set=function(t,e){We(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},S.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Xe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ye(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ye?(this.a=void 0!==e?e:t.a,$e(this,t.f),this.j=t.j,Ze(this,t.c),tn(this,t.h),this.g=t.g,e=t.b,(n=new pn).c=e.c,e.a&&(n.a=new Ke(e.a),n.b=e.b),en(this,n),this.i=t.i):t&&(n=String(t).match(Xe))?(this.a=!!e,$e(this,n[1]||"",!0),this.j=on(n[2]||""),Ze(this,n[3]||"",!0),tn(this,n[4]),this.g=on(n[5]||"",!0),en(this,n[6]||"",!0),this.i=on(n[7]||"")):(this.a=!!e,this.b=new pn(null,this.a))}function Qe(t){return new Ye(t)}function $e(t,e,n){t.f=n?on(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ze(t,e,n){t.c=n?on(e,!0):e}function tn(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function en(t,e,n){var r,i;e instanceof pn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(dn(r),r.c=null,r.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(yn(this,e),gn(this,n,t))}),r)),r.f=i):(n||(e=sn(e,fn)),t.b=new pn(e,t.a))}function nn(t,e,n){t.b.set(e,n)}function rn(t){return nn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^j()).toString(36)),t}function on(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function sn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,un),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function un(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ye.prototype.toString=function(){var t=[],e=this.f;e&&t.push(sn(e,an,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(sn(e,an,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(sn(n,"/"==n.charAt(0)?hn:cn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",sn(n,ln)),t.join("")};var an=/[#\/\?@]/g,cn=/[#\?:]/g,hn=/[#\?]/g,fn=/[#\?@]/g,ln=/#/g;function pn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function dn(t){t.a||(t.a=new Ke,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function yn(t,e){dn(t),e=mn(t,e),We(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,We((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Je(t)))}function vn(t,e){return dn(t),e=mn(t,e),We(t.a.b,e)}function gn(t,e,n){yn(t,e),0<n.length&&(t.c=null,t.a.set(mn(t,e),z(n)),t.b+=n.length)}function mn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(S=pn.prototype).add=function(t,e){dn(this),this.c=null,t=mn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},S.forEach=function(t,e){dn(this),this.a.forEach((function(n,r){B(n,(function(n){t.call(e,n,r,this)}),this)}),this)},S.L=function(){dn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},S.K=function(t){dn(this);var e=[];if("string"==typeof t)vn(this,t)&&(e=G(e,this.a.get(mn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},S.set=function(t,e){return dn(this),this.c=null,vn(this,t=mn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},S.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},S.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),o=(r=this.K(r),0);o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var wn=function(t,e){this.b=t,this.a=e};function bn(t){this.g=t||In,t=D.PerformanceNavigationTiming?0<(t=D.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(D.ia&&D.ia.ya&&D.ia.ya()&&D.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var In=10;function _n(t){return t.b||t.a&&t.a.size>=t.f}function En(t){return t.b?1:t.a?t.a.size:0}function Tn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Nn(t,e){t.a?t.a.add(e):t.b=e}function Sn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function An(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=N(t.a.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function xn(){}function Dn(){this.a=new xn}function On(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}bn.prototype.cancel=function(){var t,e;if(this.c=An(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=N(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},xn.prototype.stringify=function(t){return D.JSON.stringify(t,void 0)},xn.prototype.parse=function(t){return D.JSON.parse(t,void 0)};var kn=D.JSON.parse;function Pn(t){qt.call(this),this.headers=new Ke,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Ln,this.D=this.F=!1}q(Pn,qt);var Ln="",Cn=/^https?$/i,Rn=["POST","PUT"];function Vn(t){return"content-type"==t.toLowerCase()}function Mn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Un(t),qn(t)}function Un(t){t.u||(t.u=!0,Ft(t,"complete"),Ft(t,"error"))}function jn(t){if(t.b&&void 0!==x&&(!t.s[1]||4!=Hn(t)||2!=t.W()))if(t.l&&4==Hn(t))ee(t.za,0,t);else if(Ft(t,"readystatechange"),4==Hn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Xe)[1]||null)&&D.self&&D.self.location&&(i=(r=D.self.location.protocol).substr(0,r.length-1)),n=!Cn.test(i?i.toLowerCase():"")),e=n),e)Ft(t,"complete"),Ft(t,"success");else{t.h=6;try{var u=2<Hn(t)?t.a.statusText:""}catch(o){u=""}t.f=u+" ["+t.W()+"]",Un(t)}}finally{qn(t)}}}function qn(t,e){if(t.a){Fn(t);var n=t.a,r=t.s[0]?O:null;t.a=null,t.s=null,e||Ft(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Fn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(D.clearTimeout(t.m),t.m=null)}function Hn(t){return t.a?t.a.readyState:0}function Bn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",$(n,(function(t,e){i+=e,i+=":",i+=t,i+="\r\n"})),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):nn(t,e,n))}function Gn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function zn(t){this.pa=0,this.g=[],this.c=new le,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Gn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Gn("baseRetryDelayMs",5e3,t),this.Ra=Gn("retryDelaySeedMs",1e4,t),this.Ma=Gn("forwardChannelMaxRetries",2,t),this.ma=Gn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new bn(t&&t.concurrentRequestLimit),this.ka=new Dn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Kn(t){var e,n;Wn(t),3==t.v&&(e=t.R++,nn(n=Qe(t.B),"SID",t.J),nn(n,"RID",e),nn(n,"TYPE","terminate"),$n(t,n),(e=new Pe(t,t.c,e,void 0)).H=2,e.i=rn(Qe(n)),n=!1,D.navigator&&D.navigator.sendBeacon&&(n=D.navigator.sendBeacon(e.i.toString(),"")),!n&&D.Image&&((new Image).src=e.i,n=!0),n||(e.a=hr(e.g,null),e.a.ba(e.i)),e.u=j(),je(e)),ar(t)}function Jn(t){t.a&&(nr(t),t.a.cancel(),t.a=null)}function Wn(t){Jn(t),t.j&&(D.clearTimeout(t.j),t.j=null),ir(t),t.b.cancel(),t.h&&("number"==typeof t.h&&D.clearTimeout(t.h),t.h=null)}function Xn(t,e){t.g.push(new wn(t.Oa++,e)),3==t.v&&Yn(t)}function Yn(t){_n(t.b)||t.h||(t.h=!0,Xt(t.Ba,t),t.u=0)}function Qn(t,e){var n=e?e.f:t.R++,r=Qe(t.B);nn(r,"SID",t.J),nn(r,"RID",n),nn(r,"AID",t.P),$n(t,r),t.i&&t.l&&Bn(r,t.i,t.l),n=new Pe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Zn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Nn(t.b,n),Ve(n,r,e)}function $n(t,e){t.f&&ze({},(function(t,n){nn(e,n,t)}))}function Zn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?M(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,e,n){var r=n||"";try{ze(t,(function(t,n){var i=t;P(t)&&(i=Bt(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function tr(t){t.a||t.j||(t.T=1,Xt(t.Aa,t),t.o=0)}function er(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=_e(M(t.Aa,t),sr(t,t.o)),t.o++,1)}function nr(t){null!=t.s&&(D.clearTimeout(t.s),t.s=null)}function rr(t){t.a=new Pe(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Qe(t.la);nn(e,"RID","rpc"),nn(e,"SID",t.J),nn(e,"CI",t.H?"0":"1"),nn(e,"AID",t.P),$n(t,e),nn(e,"TYPE","xmlhttp"),t.i&&t.l&&Bn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=rn(Qe(e)),n.j=null,n.I=!0,Me(n,t)}function ir(t){null!=t.m&&(D.clearTimeout(t.m),t.m=null)}function or(t,e){var n,r=null;if(t.a==e){ir(t),nr(t),t.a=null;var i=2}else{if(!Tn(t.b,e))return;r=e.s,Sn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b)1==i?(r=e.j?e.j.length:0,e=j()-e.u,n=t.u,Ft(i=ve(),new Ie(i)),Yn(t)):tr(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(En(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)))return t.h=_e(M(t.Ba,t,e),sr(t,t.u)),t.u++,1}}(t,e)||2==i&&er(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:ur(t,5);break;case 4:ur(t,10);break;case 3:ur(t,6);break;default:ur(t,2)}}function sr(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function ur(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=M(t.Ya,t),r||(r=new Ye("//www.google.com/images/cleardot.gif"),D.location&&"http"==D.location.protocol||$e(r,"https"),rn(r)),n=r.toString(),r=o,o=new le,D.Image?((i=new Image).onload=U(On,o,i,"TestLoadImage: loaded",!0,r),i.onerror=U(On,o,i,"TestLoadImage: error",!1,r),i.onabort=U(On,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=U(On,o,i,"TestLoadImage: timeout",!1,r),D.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=n):r(!1)):be(2),t.v=0,t.f&&t.f.ra(e),ar(t),Wn(t)}function ar(t){t.v=0,t.I=-1,t.f&&(0==An(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function cr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Ye?Qe(s):new Ye(s,void 0);return""!=a.c?(e&&Ze(a,e+"."+a.c),tn(a,a.h)):(r=(u=D.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Ye(null,void 0),r&&$e(u,r),i&&Ze(u,i),o&&tn(u,o),s&&(u.g=s),a=u),t.V&&$(t.V,(function(t,e){nn(a,e,t)})),e=t.A,n=t.na,e&&n&&nn(a,e,n),nn(a,"VER",t.ha),$n(t,a),a}function hr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Pn(t.Na)).F=t.C,e}function fr(){}function lr(){if(ot&&!(10<=Number(yt)))throw Error("Environmental error: no available transport.")}function pr(t,e){qt.call(this),this.a=new zn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!K(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!K(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new vr(this)}function dr(t){De.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function yr(){Oe.call(this),this.status=1}function vr(t){this.a=t}(S=Pn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ae(this.H):Ae(Ee),this.a.onreadystatechange=M(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Mn(this,t)}t=n||"";var i,o=new Ke(this.headers);r&&ze(r,(function(t,e){o.set(e,t)})),r=function(t){t:{for(var e=Vn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=D.FormData&&t instanceof D.FormData,0<=H(Rn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Fn(this),0<this.o&&((this.D=(i=this.a,ot&&dt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=M(this.xa,this)):this.m=ee(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Mn(this,t)}},S.xa=function(){void 0!==x&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Ft(this,"timeout"),this.abort(8))},S.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Ft(this,"complete"),Ft(this,"abort"),qn(this))},S.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),qn(this,!0)),Pn.X.G.call(this)},S.za=function(){this.j||(this.A||this.l||this.g?jn(this):this.Ua())},S.Ua=function(){jn(this)},S.W=function(){try{return 2<Hn(this)?this.a.status:-1}catch(t){return-1}},S.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},S.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),kn(e)}},S.ua=function(){return this.h},S.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(S=zn.prototype).ha=8,S.v=1,S.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Pe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?et(r=Z(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Zn(this,n,e),nn(i=Qe(this.B),"RID",t),nn(i,"CVER",22),this.A&&nn(i,"X-HTTP-Session-Id",this.A),$n(this,i),this.i&&r&&Bn(i,this.i,r),Nn(this.b,n),this.Ia&&nn(i,"TYPE","init"),this.da?(nn(i,"$req",e),nn(i,"SID","null"),n.U=!0,Ve(n,i,null)):Ve(n,i,e),this.v=2}}else 3==this.v&&(t?Qn(this,t):0==this.g.length||_n(this.b)||Qn(this))},S.Aa=function(){var t;this.j=null,rr(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=_e(M(this.Ta,this),t))},S.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,be(10),Jn(this),rr(this))},S.Sa=function(){null!=this.m&&(this.m=null,Jn(this),er(this),be(19))},S.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),be(2)):(this.c.info("Failed to ping google.com"),be(1))},(S=fr.prototype).ta=function(){},S.sa=function(){},S.ra=function(){},S.qa=function(){},S.Ja=function(){},lr.prototype.a=function(t,e){return new pr(t,e)},q(pr,qt),pr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;be(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=cr(t,null,t.fa),Yn(t)},pr.prototype.close=function(){Kn(this.a)},pr.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Xn(this.a,e)):this.l?((e={}).__data__=Bt(t),Xn(this.a,e)):Xn(this.a,t)},pr.prototype.G=function(){this.a.f=null,delete this.f,Kn(this.a),delete this.a,pr.X.G.call(this)},q(dr,De),q(yr,Oe),q(vr,fr),vr.prototype.ta=function(){Ft(this.a,"a")},vr.prototype.sa=function(t){Ft(this.a,new dr(t))},vr.prototype.ra=function(t){Ft(this.a,new yr)},vr.prototype.qa=function(){Ft(this.a,"b")},lr.prototype.createWebChannel=lr.prototype.a,pr.prototype.send=pr.prototype.h,pr.prototype.open=pr.prototype.g,Te.NO_ERROR=0,Te.TIMEOUT=8,Te.HTTP_ERROR=6,Ne.COMPLETE="complete",(xe.EventType=A).OPEN="a",A.CLOSE="b",A.ERROR="c",A.MESSAGE="d",qt.prototype.listen=qt.prototype.va,Pn.prototype.listenOnce=Pn.prototype.wa,Pn.prototype.getLastError=Pn.prototype.Qa,Pn.prototype.getLastErrorCode=Pn.prototype.ua,Pn.prototype.getStatus=Pn.prototype.W,Pn.prototype.getResponseJson=Pn.prototype.Pa,Pn.prototype.getResponseText=Pn.prototype.$,Pn.prototype.send=Pn.prototype.ba;var gr=ve,mr=Te,wr=Ne,br=de,Ir=xe,_r=Pn,Er=new h("@firebase/firestore");function Tr(){return Er.logLevel}function Nr(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];Er.logLevel<=r.DEBUG&&(e=n.map(xr),Er.debug.apply(Er,v(["Firestore (8.2.2): "+t],e)))}function Sr(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];Er.logLevel<=r.ERROR&&(e=n.map(xr),Er.error.apply(Er,v(["Firestore (8.2.2): "+t],e)))}function Ar(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];Er.logLevel<=r.WARN&&(e=n.map(xr),Er.warn.apply(Er,v(["Firestore (8.2.2): "+t],e)))}function xr(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(e){return t}}function Dr(t){throw void 0===t&&(t="Unexpected state"),Sr(t="FIRESTORE (8.2.2) INTERNAL ASSERTION FAILED: "+t),new Error(t)}function Or(t){t||Dr()}var kr=(Pr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(40);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<40;r++)n[r]=Math.floor(256*Math.random());return n}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Pr);function Pr(){}function Lr(t,e){return t<e?-1:e<t?1:0}function Cr(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function Rr(t){return t+"\0"}var Vr=(Mr.fromBase64String=function(t){return new Mr(atob(t))},Mr.fromUint8Array=function(t){return new Mr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Mr.prototype.toBase64=function(){return t=this.i,btoa(t);var t},Mr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},Mr.prototype.o=function(){return 2*this.i.length},Mr.prototype.u=function(t){return Lr(this.i,t.i)},Mr.prototype.isEqual=function(t){return this.i===t.i},Mr);function Mr(t){this.i=t}Vr.h=new Vr("");var Ur,jr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},qr=(p(Gr,Ur=Error),Gr),Fr=(Br.fromBase64String=function(t){try{return new Br(Vr.fromBase64String(t))}catch(t){throw new qr(jr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},Br.fromUint8Array=function(t){return new Br(Vr.fromUint8Array(t))},Br.prototype.toBase64=function(){return this.l.toBase64()},Br.prototype.toUint8Array=function(){return this.l.toUint8Array()},Br.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Br.prototype.isEqual=function(t){return this.l.isEqual(t.l)},Br),Hr=function(t){this._=t};function Br(t){this.l=t}function Gr(t,e){var n=this;return(n=Ur.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function zr(){if("undefined"==typeof Uint8Array)throw new qr(jr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Kr(){if("undefined"==typeof atob)throw new qr(jr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Jr,Wr=(p(ti,Jr=Hr),ti.fromBase64String=function(t){return Kr(),new ti(Fr.fromBase64String(t))},ti.fromUint8Array=function(t){return zr(),new ti(Fr.fromUint8Array(t))},ti.prototype.toBase64=function(){return Kr(),this._.toBase64()},ti.prototype.toUint8Array=function(){return zr(),this._.toUint8Array()},ti.prototype.isEqual=function(t){return this._.isEqual(t._)},ti.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},ti),Xr=function(t,e,n,r,i,o){this.T=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.I=o},Yr=(Object.defineProperty(Zr.prototype,"m",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Zr.prototype.isEqual=function(t){return t instanceof Zr&&t.projectId===this.projectId&&t.database===this.database},Zr),Qr=($r.prototype.A=function(){return null!=this.uid},$r.prototype.R=function(){return this.A()?"uid:"+this.uid:"anonymous-user"},$r.prototype.isEqual=function(t){return t.uid===this.uid},$r);function $r(t){this.uid=t}function Zr(t,e){this.projectId=t,this.database=e||"(default)"}function ti(){return null!==Jr&&Jr.apply(this,arguments)||this}function ei(t,e){this.user=e,this.type="OAuth",this.V={},this.V.Authorization="Bearer "+t}Qr.UNAUTHENTICATED=new Qr(null),Qr.P=new Qr("google-credentials-uid"),Qr.g=new Qr("first-party-uid");var ni=(fi.prototype.getToken=function(){return Promise.resolve(null)},fi.prototype.v=function(){},fi.prototype.S=function(t){(this.p=t)(Qr.UNAUTHENTICATED)},fi.prototype.D=function(){this.p=null},fi),ri=(hi.prototype.getToken=function(){var t=this,e=this.O,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.O!==e?(Nr("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Or("string"==typeof n.accessToken),new ei(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},hi.prototype.v=function(){this.forceRefresh=!0},hi.prototype.S=function(t){this.p=t,this.N&&t(this.currentUser)},hi.prototype.D=function(){this.auth&&this.auth.removeAuthTokenListener(this.C),this.C=null,this.p=null},hi.prototype.F=function(){var t=this.auth&&this.auth.getUid();return Or(null===t||"string"==typeof t),new Qr(t)},hi),ii=(Object.defineProperty(ci.prototype,"V",{get:function(){var t={"X-Goog-AuthUser":this.M},e=this.k.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),ci),oi=(ai.prototype.getToken=function(){return Promise.resolve(new ii(this.k,this.M))},ai.prototype.S=function(t){t(Qr.g)},ai.prototype.D=function(){},ai.prototype.v=function(){},ai),si=(ui.prototype.$=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ui.prototype.next=function(){var t=++this.previousValue;return this.B&&this.B(t),t},ui);function ui(t,e){var n=this;this.previousValue=t,e&&(e.L=function(t){return n.$(t)},this.B=function(t){return e.q(t)})}function ai(t,e){this.k=t,this.M=e}function ci(t,e){this.k=t,this.M=e,this.type="FirstParty",this.user=Qr.g}function hi(t){var e=this;this.C=null,this.currentUser=Qr.UNAUTHENTICATED,this.N=!1,this.O=0,this.p=null,this.forceRefresh=!1,this.C=function(){e.O++,e.currentUser=e.F(),e.N=!0,e.p&&e.p(e.currentUser)},this.O=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.C):(this.C(null),t.get().then((function(t){e.auth=t,e.C&&e.auth.addAuthTokenListener(e.C)}),(function(){})))}function fi(){this.p=null}si.U=-1;var li,pi,di=(Ni.now=function(){return Ni.fromMillis(Date.now())},Ni.fromDate=function(t){return Ni.fromMillis(t.getTime())},Ni.fromMillis=function(t){var e=Math.floor(t/1e3);return new Ni(e,1e6*(t-1e3*e))},Ni.prototype.toDate=function(){return new Date(this.toMillis())},Ni.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Ni.prototype.K=function(t){return this.seconds===t.seconds?Lr(this.nanoseconds,t.nanoseconds):Lr(this.seconds,t.seconds)},Ni.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Ni.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Ni.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Ni.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Ni),yi=(Ti.j=function(t){return new Ti(t)},Ti.min=function(){return new Ti(new di(0,0))},Ti.prototype.u=function(t){return this.timestamp.K(t.timestamp)},Ti.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Ti.prototype.W=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Ti.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Ti.prototype.G=function(){return this.timestamp},Ti),vi=(Object.defineProperty(Ei.prototype,"length",{get:function(){return this.H},enumerable:!1,configurable:!0}),Ei.prototype.isEqual=function(t){return 0===Ei.J(this,t)},Ei.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Ei?t.forEach((function(t){e.push(t)})):e.push(t),this.Y(e)},Ei.prototype.limit=function(){return this.offset+this.length},Ei.prototype.X=function(t){return t=void 0===t?1:t,this.Y(this.segments,this.offset+t,this.length-t)},Ei.prototype.Z=function(){return this.Y(this.segments,this.offset,this.length-1)},Ei.prototype.tt=function(){return this.segments[this.offset]},Ei.prototype.et=function(){return this.get(this.length-1)},Ei.prototype.get=function(t){return this.segments[this.offset+t]},Ei.prototype.nt=function(){return 0===this.length},Ei.prototype.st=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Ei.prototype.it=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Ei.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Ei.prototype.rt=function(){return this.segments.slice(this.offset,this.limit())},Ei.J=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},p(_i,pi=Ne=Ei),_i.prototype.Y=function(t,e,n){return new _i(t,e,n)},_i.prototype.ot=function(){return this.rt().join("/")},_i.prototype.toString=function(){return this.ot()},_i.ct=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new qr(jr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter((function(t){return 0<t.length})))}return new _i(n)},_i.at=function(){return new _i([])},_i),gi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,mi=(p(Ii,li=Ne),Ii.prototype.Y=function(t,e,n){return new Ii(t,e,n)},Ii.ut=function(t){return gi.test(t)},Ii.prototype.ot=function(){return this.rt().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ii.ut(t)||(t="`"+t+"`"),t})).join(".")},Ii.prototype.toString=function(){return this.ot()},Ii.prototype.ht=function(){return 1===this.length&&"__name__"===this.get(0)},Ii.lt=function(){return new Ii(["__name__"])},Ii._t=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new qr(jr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new qr(jr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new qr(jr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new qr(jr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Ii(e)},Ii.at=function(){return new Ii([])},Ii),wi=(bi.ft=function(t){return new bi(vi.ct(t))},bi.dt=function(t){return new bi(vi.ct(t).X(5))},bi.prototype.wt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},bi.prototype.isEqual=function(t){return null!==t&&0===vi.J(this.path,t.path)},bi.prototype.toString=function(){return this.path.toString()},bi.J=function(t,e){return vi.J(t.path,e.path)},bi.Et=function(t){return t.length%2==0},bi.Tt=function(t){return new bi(new vi(t.slice()))},bi);function bi(t){this.path=t}function Ii(){return null!==li&&li.apply(this,arguments)||this}function _i(){return null!==pi&&pi.apply(this,arguments)||this}function Ei(t,e,n){void 0===e?e=0:e>t.length&&Dr(),void 0===n?n=t.length-e:n>t.length-e&&Dr(),this.segments=t,this.offset=e,this.H=n}function Ti(t){this.timestamp=t}function Ni(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new qr(jr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new qr(jr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new qr(jr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new qr(jr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Si(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Ai(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function xi(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Di=(ki.prototype.It=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].st(t))return!0;return!1},ki.prototype.isEqual=function(t){return Cr(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},ki),Oi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ki(t){(this.fields=t).sort(mi.J)}function Pi(t){if(Or(!!t),"string"!=typeof t)return{seconds:Li(t.seconds),nanos:Li(t.nanos)};var e=0,n=Oi.exec(t);return Or(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Li(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Ci(t){return"string"==typeof t?Vr.fromBase64String(t):Vr.fromUint8Array(t)}function Ri(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Vi(t){return t=Pi(t.mapValue.fields.__local_write_time__.timestampValue),new di(t.seconds,t.nanos)}function Mi(t){return null==t}function Ui(t){return 0===t&&1/t==-1/0}function ji(t){return"number"==typeof t&&Number.isInteger(t)&&!Ui(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function qi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ri(t)?4:10:Dr()}function Fi(t,e){var n,r=qi(t);if(r!==qi(e))return!1;switch(r){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Vi(t).isEqual(Vi(e));case 3:return function(e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=Pi(t.timestampValue);return e=Pi(e.timestampValue),n.seconds===e.seconds&&n.nanos===e.nanos}(e);case 5:return t.stringValue===e.stringValue;case 6:return n=e,Ci(t.bytesValue).isEqual(Ci(n.bytesValue));case 7:return t.referenceValue===e.referenceValue;case 8:return r=e,Li((n=t).geoPointValue.latitude)===Li(r.geoPointValue.latitude)&&Li(n.geoPointValue.longitude)===Li(r.geoPointValue.longitude);case 2:return function(t,e){return"integerValue"in t&&"integerValue"in e?Li(t.integerValue)===Li(e.integerValue):"doubleValue"in t&&"doubleValue"in e&&((t=Li(t.doubleValue))===(e=Li(e.doubleValue))?Ui(t)===Ui(e):isNaN(t)&&isNaN(e))}(t,e);case 9:return Cr(t.arrayValue.values||[],e.arrayValue.values||[],Fi);case 10:return function(){var n,r=t.mapValue.fields||{},i=e.mapValue.fields||{};if(Si(r)!==Si(i))return!1;for(n in r)if(r.hasOwnProperty(n)&&(void 0===i[n]||!Fi(r[n],i[n])))return!1;return!0}();default:return Dr()}}function Hi(t,e){return void 0!==(t.values||[]).find((function(t){return Fi(t,e)}))}function Bi(t,e){var n,r,i=qi(t),o=qi(e);if(i!==o)return Lr(i,o);switch(i){case 0:return 0;case 1:return Lr(t.booleanValue,e.booleanValue);case 2:return n=e,(r=Li(t.integerValue||t.doubleValue))<(n=Li(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return Gi(t.timestampValue,e.timestampValue);case 4:return Gi(Vi(t),Vi(e));case 5:return Lr(t.stringValue,e.stringValue);case 6:return function(t,e){return t=Ci(t),e=Ci(e),t.u(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Lr(n[i],r[i]);if(0!==o)return o}return Lr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=Lr(Li(i.latitude),Li(r.latitude)))?n:Lr(Li(i.longitude),Li(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Bi(n[i],r[i]);if(o)return o}return Lr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Lr(r[s],o[s]);if(0!==u)return u;if(0!==(u=Bi(n[r[s]],i[o[s]])))return u}return Lr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Dr()}}function Gi(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Lr(t,e);var n=Pi(t);return t=Pi(e),0!==(e=Lr(n.seconds,t.seconds))?e:Lr(n.nanos,t.nanos)}function zi(t){return function t(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(t){return"time("+(t=Pi(t)).seconds+","+t.nanos+")"}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Ci(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,wi.dt(n).toString()):"geoPointValue"in e?"geo("+(n=e.geoPointValue).latitude+","+n.longitude+")":"arrayValue"in e?function(e){for(var n="[",r=!0,i=0,o=e.values||[];i<o.length;i++)r?r=!1:n+=",",n+=t(o[i]);return n+"]"}(e.arrayValue):"mapValue"in e?function(e){for(var n="{",r=!0,i=0,o=Object.keys(e.fields||{}).sort();i<o.length;i++){var s=o[i];r?r=!1:n+=",",n+=s+":"+t(e.fields[s])}return n+"}"}(e.mapValue):Dr();var n}(t)}function Ki(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.ot()}}function Ji(t){return t&&"integerValue"in t}function Wi(t){return!!t&&"arrayValue"in t}function Xi(t){return t&&"nullValue"in t}function Yi(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Qi(t){return t&&"mapValue"in t}var $i=(eo.empty=function(){return new eo({mapValue:{}})},eo.prototype.field=function(t){if(t.nt())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Qi(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.et()])||null},eo.prototype.isEqual=function(t){return Fi(this.proto,t.proto)},eo),Zi=(to.prototype.set=function(t,e){return this.Pt(t,e),this},to.prototype.delete=function(t){return this.Pt(t,null),this},to.prototype.Pt=function(t,e){for(var n=this.Rt,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map||(o=o&&10===qi(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),n=o}n.set(t.et(),e)},to.prototype.yt=function(){var t=this.gt(mi.at(),this.Rt);return null!=t?new $i(t):this.At},to.prototype.gt=function(t,e){var n=this,r=!1,i=this.At.field(t),o=Qi(i)?Object.assign({},i.mapValue.fields):{};return e.forEach((function(e,i){var s;e instanceof Map?null!=(s=n.gt(t.child(i),e))&&(o[i]=s,r=!0):null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)})),r?{mapValue:{fields:o}}:null},to);function to(t){void 0===t&&(t=$i.empty()),this.At=t,this.Rt=new Map}function eo(t){this.proto=t}var no,ro,io,oo=(p(fo,io=h=function(t,e){this.key=t,this.version=e}),fo.prototype.field=function(t){return this.Vt.field(t)},fo.prototype.data=function(){return this.Vt},fo.prototype.vt=function(){return this.Vt.proto},fo.prototype.isEqual=function(t){return t instanceof fo&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.bt===t.bt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Vt.isEqual(t.Vt)},fo.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Vt.toString()+", {hasLocalMutations: "+this.bt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(fo.prototype,"hasPendingWrites",{get:function(){return this.bt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),fo),so=(p(ho,ro=h),ho.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(ho.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),ho.prototype.isEqual=function(t){return t instanceof ho&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},ho),uo=(p(co,no=h),co.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(co.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),co.prototype.isEqual=function(t){return t instanceof co&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},co),ao=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.St=null};function co(){return null!==no&&no.apply(this,arguments)||this}function ho(t,e,n){var r=this;return(r=ro.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function fo(t,e,n,r){var i=this;return(i=io.call(this,t,e)||this).Vt=n,i.bt=!!r.bt,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function lo(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new ao(t,e,n,r,i,o,s)}function po(t){var e=t;return null===e.St&&(t=e.path.ot(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((function(t){return(t=t).field.ot()+t.op.toString()+zi(t.value)})).join(","),t+="|ob:",t+=e.orderBy.map((function(t){return(t=t).field.ot()+t.dir})).join(","),Mi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Bo(e.startAt)),e.endAt&&(t+="|ub:",t+=Bo(e.endAt)),e.St=t),e.St}function yo(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Fi(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ko(t.startAt,e.startAt)&&Ko(t.endAt,e.endAt)}function vo(t){return wi.Et(t.path)&&null===t.collectionGroup&&0===t.filters.length}var go,mo=(p(wo,go=function(){}),wo.create=function(t,e,n){return t.ht()?"in"===e||"not-in"===e?this.Dt(t,e,n):new Eo(t,e,n):"array-contains"===e?new Co(t,n):"in"===e?new Ro(t,n):"not-in"===e?new Vo(t,n):"array-contains-any"===e?new Mo(t,n):new wo(t,e,n)},wo.Dt=function(t,e,n){return new("in"===e?To:No)(t,n)},wo.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this.Ct(Bi(t,this.value)):null!==t&&qi(this.value)===qi(t)&&this.Ct(Bi(t,this.value))},wo.prototype.Ct=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Dr()}},wo.prototype.xt=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},wo);function wo(t,e,n){var r=this;return(r=go.call(this)||this).field=t,r.op=e,r.value=n,r}var bo,Io,_o,Eo=(p(xo,_o=mo),xo.prototype.matches=function(t){return t=wi.J(t.key,this.key),this.Ct(t)},xo),To=(p(Ao,Io=mo),Ao.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},Ao),No=(p(So,bo=mo),So.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},So);function So(t,e){var n=this;return(n=bo.call(this,t,"not-in",e)||this).keys=Do(0,e),n}function Ao(t,e){var n=this;return(n=Io.call(this,t,"in",e)||this).keys=Do(0,e),n}function xo(t,e,n){var r=this;return(r=_o.call(this,t,e,n)||this).key=wi.dt(n.referenceValue),r}function Do(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map((function(t){return wi.dt(t.referenceValue)}))}var Oo,ko,Po,Lo,Co=(p(Ho,Lo=mo),Ho.prototype.matches=function(t){return Wi(t=t.field(this.field))&&Hi(t.arrayValue,this.value)},Ho),Ro=(p(Fo,Po=mo),Fo.prototype.matches=function(t){return null!==(t=t.field(this.field))&&Hi(this.value.arrayValue,t)},Fo),Vo=(p(qo,ko=mo),qo.prototype.matches=function(t){return!Hi(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&null!==(t=t.field(this.field))&&!Hi(this.value.arrayValue,t)},qo),Mo=(p(jo,Oo=mo),jo.prototype.matches=function(t){var e=this;return!(!Wi(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some((function(t){return Hi(e.value.arrayValue,t)}))},jo),Uo=function(t,e){this.position=t,this.before=e};function jo(t,e){return Oo.call(this,t,"array-contains-any",e)||this}function qo(t,e){return ko.call(this,t,"not-in",e)||this}function Fo(t,e){return Po.call(this,t,"in",e)||this}function Ho(t,e){return Lo.call(this,t,"array-contains",e)||this}function Bo(t){return(t.before?"b":"a")+":"+t.position.map(zi).join(",")}var Go=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function zo(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.ht()?wi.J(wi.dt(s.referenceValue),n.key):Bi(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Ko(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Fi(t.position[n],e.position[n]))return!1;return!0}var Jo=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Nt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Ot=null,this.Ft=null,this.startAt,this.endAt};function Wo(t,e,n,r,i,o,s,u){return new Jo(t,e,n,r,i,o,s,u)}function Xo(t){return new Jo(t)}function Yo(t){return!Mi(t.limit)&&"F"===t.limitType}function Qo(t){return!Mi(t.limit)&&"L"===t.limitType}function $o(t){return 0<t.Nt.length?t.Nt[0].field:null}function Zo(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.xt())return r.field}return null}function ts(t){return null!==t.collectionGroup}function es(t){var e=t;if(null===e.Ot){e.Ot=[];var n=Zo(e);if(t=$o(e),null!==n&&null===t)n.ht()||e.Ot.push(new Go(n)),e.Ot.push(new Go(mi.lt(),"asc"));else{for(var r=!1,i=0,o=e.Nt;i<o.length;i++){var s=o[i];e.Ot.push(s),s.field.ht()&&(r=!0)}r||(n=0<e.Nt.length?e.Nt[e.Nt.length-1].dir:"asc",e.Ot.push(new Go(mi.lt(),n)))}}return e.Ot}function ns(t){var e=t;if(!e.Ft)if("F"===e.limitType)e.Ft=lo(e.path,e.collectionGroup,es(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=es(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Go(o.field,s))}var u=e.endAt?new Uo(e.endAt.position,!e.endAt.before):null;t=e.startAt?new Uo(e.startAt.position,!e.startAt.before):null,e.Ft=lo(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.Ft}function rs(t,e,n){return new Jo(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function is(t,e){return yo(ns(t),ns(e))&&t.limitType===e.limitType}function os(t){return po(ns(t))+"|lt:"+t.limitType}function ss(t){return"Query(target="+(n=(e=ns(t)).path.ot(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map((function(t){return(t=t).field.ot()+" "+t.op+" "+zi(t.value)})).join(", ")+"]"),Mi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map((function(t){return(t=t).field.ot()+" ("+t.dir+")"})).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Bo(e.startAt)),e.endAt&&(n+=", endAt: "+Bo(e.endAt)),"Target("+n+"); limitType=")+t.limitType+")";var e,n}function us(t,e){return n=t,r=e.key.path,(null!==n.collectionGroup?e.key.wt(n.collectionGroup)&&n.path.st(r):wi.Et(n.path)?n.path.isEqual(r):n.path.it(r))&&function(e){for(var n=0,r=t.Nt;n<r.length;n++){var i=r[n];if(!i.field.ht()&&null===e.field(i.field))return}return 1}(e)&&function(e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return;return 1}(e)&&(r=e,(!(e=t).startAt||zo(e.startAt,es(e),r))&&(!e.endAt||!zo(e.endAt,es(e),r)));var n,r}function as(t){return function(e,n){for(var r=!1,i=0,o=es(t);i<o.length;i++){var s=o[i],u=function(t,e,n){switch(n=t.field.ht()?wi.J(e.key,n.key):function(t,n){var r=e.field(t);return t=n.field(t),null!==r&&null!==t?Bi(r,t):Dr()}(t.field,n),t.dir){case"asc":return n;case"desc":return-1*n;default:return Dr()}}(s,e,n);if(0!==u)return u;r=r||s.field.ht()}return 0}}var cs=(hs.prototype.Lt=function(t){return new hs(this.target,this.targetId,this.kt,t,this.Mt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},hs.prototype.$t=function(t,e){return new hs(this.target,this.targetId,this.kt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},hs.prototype.Bt=function(t){return new hs(this.target,this.targetId,this.kt,this.sequenceNumber,this.Mt,t,this.resumeToken)},hs);function hs(t,e,n,r,i,o,s){void 0===i&&(i=yi.min()),void 0===o&&(o=yi.min()),void 0===s&&(s=Vr.h),this.target=t,this.targetId=e,this.kt=n,this.sequenceNumber=r,this.Mt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function fs(t,e){if(t.qt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ui(e)?"-0":e}}function ls(t){return{integerValue:""+t}}function ps(t,e){return ji(e)?ls(e):fs(t,e)}function ds(t,e){return t instanceof As?Ji(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var ys,vs,gs=(p(bs,vs=Ne=function(){this.Ut=void 0}),bs),ms=(p(ws,ys=Ne),ws);function ws(t){var e=this;return(e=ys.call(this)||this).elements=t,e}function bs(){return null!==vs&&vs.apply(this,arguments)||this}function Is(t,e){for(var n=Os(e),r=0,i=t.elements;r<i.length;r++)!function(t){n.some((function(e){return Fi(e,t)}))||n.push(t)}(i[r]);return{arrayValue:{values:n}}}var _s,Es=(p(Ts,_s=Ne),Ts);function Ts(t){var e=this;return(e=_s.call(this)||this).elements=t,e}function Ns(t,e){for(var n=Os(e),r=0,i=t.elements;r<i.length;r++)!function(t){n=n.filter((function(e){return!Fi(e,t)}))}(i[r]);return{arrayValue:{values:n}}}var Ss,As=(p(xs,Ss=Ne),xs);function xs(t,e){var n=this;return(n=Ss.call(this)||this).Kt=t,n.Qt=e,n}function Ds(t){return Li(t.integerValue||t.doubleValue)}function Os(t){return Wi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function ks(t,e){this.version=t,this.transformResults=e}var Ps=function(t,e){this.field=t,this.transform=e},Ls=(Cs.jt=function(){return new Cs},Cs.exists=function(t){return new Cs(void 0,t)},Cs.updateTime=function(t){return new Cs(t)},Object.defineProperty(Cs.prototype,"Wt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Cs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Cs);function Cs(t,e){this.updateTime=t,this.exists=e}function Rs(t,e){return void 0!==t.updateTime?e instanceof oo&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof oo}function Vs(t,e,n,r){return t instanceof Fs?function(t,e,n){if(!Rs(t.Gt,e))return e;var r=t.value;return n=Js(t.fieldTransforms,n,e),r=Ws(t.fieldTransforms,r,n),e=Us(e),new oo(t.key,e,r,{bt:!0})}(t,e,r):t instanceof Hs?function(t,e,n){if(!Rs(t.Gt,e))return e;var r=Us(e);return e=zs(t,e,Js(t.fieldTransforms,n,e)),new oo(t.key,r,e,{bt:!0})}(t,e,r):(e=e,Rs((t=t).Gt,e)?new so(t.key,yi.min()):e)}function Ms(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Gt.isEqual(e.Gt)&&(n=t.fieldTransforms,r=e.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&Cr(n,r,(function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof ms&&e instanceof ms||t instanceof Es&&e instanceof Es?Cr(t.elements,e.elements,Fi):t instanceof As&&e instanceof As?Fi(t.Qt,e.Qt):t instanceof gs&&e instanceof gs)}))))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.zt.isEqual(e.zt));var n,r}function Us(t){return t instanceof oo?t.version:yi.min()}var js,qs,Fs=(p(Gs,qs=h=function(){}),Gs),Hs=(p(Bs,js=h),Bs);function Bs(t,e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=js.call(this)||this).key=t,o.data=e,o.zt=n,o.Gt=r,o.fieldTransforms=i,o.type=1,o}function Gs(t,e,n,r){void 0===r&&(r=[]);var i=this;return(i=qs.call(this)||this).key=t,i.value=e,i.Gt=n,i.fieldTransforms=r,i.type=0,i}function zs(t,e,n){var r,i,o;return i=t,e=e instanceof oo?e.data():$i.empty(),o=new Zi(e),i.zt.fields.forEach((function(t){var e;t.nt()||(null!==(e=i.data.field(t))?o.set(t,e):o.delete(t))})),r=o.yt(),Ws(t.fieldTransforms,r,n)}function Ks(t,e,n){var r=[];Or(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof oo&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof ms?Is(o,s):o instanceof Es?Ns(o,s):u))}return r}function Js(t,e,n){for(var r,i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof oo&&(c=n.field(u.field)),i.push((r=c,u=e,c=void 0,(a=a)instanceof gs?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:u.seconds,nanos:u.nanoseconds}}}},r&&(c.fields.__previous_value__=r),{mapValue:c}):a instanceof ms?Is(a,r):a instanceof Es?Ns(a,r):(r=Ds(a=ds(c=a,r))+Ds(c.Qt),Ji(a)&&Ji(c.Qt)?ls(r):fs(c.Kt,r))))}return i}function Ws(t,e,n){for(var r=new Zi(e),i=0;i<t.length;i++){var o=t[i];r.set(o.field,n[i])}return r.yt()}function Xs(t){this.count=t}var Ys,Qs,$s,Zs=(p(nu,$s=h),nu),tu=(p(eu,Qs=h),eu);function eu(t,e){var n=this;return(n=Qs.call(this)||this).key=t,n.Gt=e,n.type=3,n.fieldTransforms=[],n}function nu(t,e){var n=this;return(n=$s.call(this)||this).key=t,n.Gt=e,n.type=2,n.fieldTransforms=[],n}function ru(t){switch(t){case jr.OK:return Dr(),0;case jr.CANCELLED:case jr.UNKNOWN:case jr.DEADLINE_EXCEEDED:case jr.RESOURCE_EXHAUSTED:case jr.INTERNAL:case jr.UNAVAILABLE:case jr.UNAUTHENTICATED:return;case jr.INVALID_ARGUMENT:case jr.NOT_FOUND:case jr.ALREADY_EXISTS:case jr.PERMISSION_DENIED:case jr.FAILED_PRECONDITION:case jr.ABORTED:case jr.OUT_OF_RANGE:case jr.UNIMPLEMENTED:case jr.DATA_LOSS:return 1;default:return Dr(),0}}function iu(t){if(void 0===t)return Sr("GRPC error has no .code"),jr.UNKNOWN;switch(t){case Ys.OK:return jr.OK;case Ys.CANCELLED:return jr.CANCELLED;case Ys.UNKNOWN:return jr.UNKNOWN;case Ys.DEADLINE_EXCEEDED:return jr.DEADLINE_EXCEEDED;case Ys.RESOURCE_EXHAUSTED:return jr.RESOURCE_EXHAUSTED;case Ys.INTERNAL:return jr.INTERNAL;case Ys.UNAVAILABLE:return jr.UNAVAILABLE;case Ys.UNAUTHENTICATED:return jr.UNAUTHENTICATED;case Ys.INVALID_ARGUMENT:return jr.INVALID_ARGUMENT;case Ys.NOT_FOUND:return jr.NOT_FOUND;case Ys.ALREADY_EXISTS:return jr.ALREADY_EXISTS;case Ys.PERMISSION_DENIED:return jr.PERMISSION_DENIED;case Ys.FAILED_PRECONDITION:return jr.FAILED_PRECONDITION;case Ys.ABORTED:return jr.ABORTED;case Ys.OUT_OF_RANGE:return jr.OUT_OF_RANGE;case Ys.UNIMPLEMENTED:return jr.UNIMPLEMENTED;case Ys.DATA_LOSS:return jr.DATA_LOSS;default:return Dr()}}(Ne=Ys=Ys||{})[Ne.OK=0]="OK",Ne[Ne.CANCELLED=1]="CANCELLED",Ne[Ne.UNKNOWN=2]="UNKNOWN",Ne[Ne.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ne[Ne.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ne[Ne.NOT_FOUND=5]="NOT_FOUND",Ne[Ne.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ne[Ne.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ne[Ne.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ne[Ne.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ne[Ne.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ne[Ne.ABORTED=10]="ABORTED",Ne[Ne.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ne[Ne.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ne[Ne.INTERNAL=13]="INTERNAL",Ne[Ne.UNAVAILABLE=14]="UNAVAILABLE",Ne[Ne.DATA_LOSS=15]="DATA_LOSS";var ou=(hu.prototype.Ht=function(t,e){return new hu(this.J,this.root.Ht(t,e,this.J).copy(null,null,uu.Jt,null,null))},hu.prototype.remove=function(t){return new hu(this.J,this.root.remove(t,this.J).copy(null,null,uu.Jt,null,null))},hu.prototype.get=function(t){for(var e=this.root;!e.nt();){var n=this.J(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},hu.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.nt();){var r=this.J(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},hu.prototype.nt=function(){return this.root.nt()},Object.defineProperty(hu.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),hu.prototype.Yt=function(){return this.root.Yt()},hu.prototype.Xt=function(){return this.root.Xt()},hu.prototype.Zt=function(t){return this.root.Zt(t)},hu.prototype.forEach=function(t){this.Zt((function(e,n){return t(e,n),!1}))},hu.prototype.toString=function(){var t=[];return this.Zt((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},hu.prototype.te=function(t){return this.root.te(t)},hu.prototype.ee=function(){return new su(this.root,null,this.J,!1)},hu.prototype.ne=function(t){return new su(this.root,t,this.J,!1)},hu.prototype.se=function(){return new su(this.root,null,this.J,!0)},hu.prototype.ie=function(t){return new su(this.root,t,this.J,!0)},hu),su=(cu.prototype.ce=function(){var t=this.oe.pop(),e={key:t.key,value:t.value};if(this.re)for(t=t.left;!t.nt();)this.oe.push(t),t=t.right;else for(t=t.right;!t.nt();)this.oe.push(t),t=t.left;return e},cu.prototype.ae=function(){return 0<this.oe.length},cu.prototype.ue=function(){if(0===this.oe.length)return null;var t=this.oe[this.oe.length-1];return{key:t.key,value:t.value}},cu),uu=(au.prototype.copy=function(t,e,n,r,i){return new au(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},au.prototype.nt=function(){return!1},au.prototype.Zt=function(t){return this.left.Zt(t)||t(this.key,this.value)||this.right.Zt(t)},au.prototype.te=function(t){return this.right.te(t)||t(this.key,this.value)||this.left.te(t)},au.prototype.min=function(){return this.left.nt()?this:this.left.min()},au.prototype.Yt=function(){return this.min().key},au.prototype.Xt=function(){return this.right.nt()?this.key:this.right.Xt()},au.prototype.Ht=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Ht(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Ht(t,e,n))).he()},au.prototype.le=function(){if(this.left.nt())return au.EMPTY;var t=this;return t.left._e()||t.left.left._e()||(t=t.fe()),(t=t.copy(null,null,null,t.left.le(),null)).he()},au.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.nt()||r.left._e()||r.left.left._e()||(r=r.fe()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left._e()&&(r=r.de()),r.right.nt()||r.right._e()||r.right.left._e()||(r=r.we()),0===e(t,r.key)){if(r.right.nt())return au.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.le())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.he()},au.prototype._e=function(){return this.color},au.prototype.he=function(){var t=this;return t.right._e()&&!t.left._e()&&(t=t.Ee()),t.left._e()&&t.left.left._e()&&(t=t.de()),t.left._e()&&t.right._e()&&(t=t.Te()),t},au.prototype.fe=function(){var t=this.Te();return t.right.left._e()&&(t=(t=(t=t.copy(null,null,null,null,t.right.de())).Ee()).Te()),t},au.prototype.we=function(){var t=this.Te();return t.left.left._e()&&(t=(t=t.de()).Te()),t},au.prototype.Ee=function(){var t=this.copy(null,null,au.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},au.prototype.de=function(){var t=this.copy(null,null,au.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},au.prototype.Te=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},au.prototype.Ie=function(){var t=this.me();return Math.pow(2,t)<=this.size+1},au.prototype.me=function(){if(this._e()&&this.left._e())throw Dr();if(this.right._e())throw Dr();var t=this.left.me();if(t!==this.right.me())throw Dr();return t+(this._e()?0:1)},au);function au(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:au.RED,this.left=null!=r?r:au.EMPTY,this.right=null!=i?i:au.EMPTY,this.size=this.left.size+1+this.right.size}function cu(t,e,n,r){this.re=r,this.oe=[];for(var i=1;!t.nt();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.re?t.left:t.right;else{if(0===i){this.oe.push(t);break}this.oe.push(t),t=this.re?t.right:t.left}}function hu(t,e){this.J=t,this.root=e||uu.EMPTY}function fu(){this.size=0}uu.EMPTY=null,uu.RED=!0,uu.Jt=!1,uu.EMPTY=(Object.defineProperty(fu.prototype,"key",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),Object.defineProperty(fu.prototype,"value",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),Object.defineProperty(fu.prototype,"color",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),Object.defineProperty(fu.prototype,"left",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),Object.defineProperty(fu.prototype,"right",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),fu.prototype.copy=function(t,e,n,r,i){return this},fu.prototype.Ht=function(t,e,n){return new uu(t,e)},fu.prototype.remove=function(t,e){return this},fu.prototype.nt=function(){return!0},fu.prototype.Zt=function(t){return!1},fu.prototype.te=function(t){return!1},fu.prototype.Yt=function(){return null},fu.prototype.Xt=function(){return null},fu.prototype._e=function(){return!1},fu.prototype.Ie=function(){return!0},fu.prototype.me=function(){return 0},new fu);var lu=(vu.prototype.has=function(t){return null!==this.data.get(t)},vu.prototype.first=function(){return this.data.Yt()},vu.prototype.last=function(){return this.data.Xt()},Object.defineProperty(vu.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),vu.prototype.indexOf=function(t){return this.data.indexOf(t)},vu.prototype.forEach=function(t){this.data.Zt((function(e,n){return t(e),!1}))},vu.prototype.Ae=function(t,e){for(var n=this.data.ne(t[0]);n.ae();){var r=n.ce();if(0<=this.J(r.key,t[1]))return;e(r.key)}},vu.prototype.Re=function(t,e){for(var n=void 0!==e?this.data.ne(e):this.data.ee();n.ae();)if(!t(n.ce().key))return},vu.prototype.Pe=function(t){return(t=this.data.ne(t)).ae()?t.ce().key:null},vu.prototype.ee=function(){return new pu(this.data.ee())},vu.prototype.ne=function(t){return new pu(this.data.ne(t))},vu.prototype.add=function(t){return this.copy(this.data.remove(t).Ht(t,!0))},vu.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},vu.prototype.nt=function(){return this.data.nt()},vu.prototype.ye=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},vu.prototype.isEqual=function(t){if(!(t instanceof vu))return!1;if(this.size!==t.size)return!1;for(var e=this.data.ee(),n=t.data.ee();e.ae();){var r=e.ce().key,i=n.ce().key;if(0!==this.J(r,i))return!1}return!0},vu.prototype.rt=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},vu.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},vu.prototype.copy=function(t){var e=new vu(this.J);return e.data=t,e},vu),pu=(yu.prototype.ce=function(){return this.ge.ce().key},yu.prototype.ae=function(){return this.ge.ae()},yu),du=new ou(wi.J);function yu(t){this.ge=t}function vu(t){this.J=t,this.data=new ou(this.J)}var gu=new ou(wi.J),mu=new ou(wi.J),wu=new lu(wi.J);function bu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=wu,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Iu=new lu(Lr),_u=(Uu.be=function(t){return new Uu(t.J)},Uu.prototype.has=function(t){return null!=this.Ve.get(t)},Uu.prototype.get=function(t){return this.Ve.get(t)},Uu.prototype.first=function(){return this.pe.Yt()},Uu.prototype.last=function(){return this.pe.Xt()},Uu.prototype.nt=function(){return this.pe.nt()},Uu.prototype.indexOf=function(t){return(t=this.Ve.get(t))?this.pe.indexOf(t):-1},Object.defineProperty(Uu.prototype,"size",{get:function(){return this.pe.size},enumerable:!1,configurable:!0}),Uu.prototype.forEach=function(t){this.pe.Zt((function(e,n){return t(e),!1}))},Uu.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ve.Ht(t.key,t),e.pe.Ht(t,null))},Uu.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ve.remove(t),this.pe.remove(e)):this},Uu.prototype.isEqual=function(t){if(!(t instanceof Uu))return!1;if(this.size!==t.size)return!1;for(var e=this.pe.ee(),n=t.pe.ee();e.ae();){var r=e.ce().key,i=n.ce().key;if(!r.isEqual(i))return!1}return!0},Uu.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},Uu.prototype.copy=function(t,e){var n=new Uu;return n.J=this.J,n.Ve=t,n.pe=e,n},Uu),Eu=(Mu.prototype.track=function(t){var e=t.doc.key,n=this.ve.get(e);!n||0!==t.type&&3===n.type?this.ve=this.ve.Ht(e,t):3===t.type&&1!==n.type?this.ve=this.ve.Ht(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ve=this.ve.Ht(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ve=this.ve.remove(e):1===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):Dr()},Mu.prototype.Se=function(){var t=[];return this.ve.Zt((function(e,n){t.push(n)})),t},Mu),Tu=(Vu.Oe=function(t,e,n,r){var i=[];return e.forEach((function(t){i.push({type:0,doc:t})})),new Vu(t,e,_u.be(e),i,n,r,!0,!1)},Object.defineProperty(Vu.prototype,"hasPendingWrites",{get:function(){return!this.Ce.nt()},enumerable:!1,configurable:!0}),Vu.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.xe===t.xe&&this.Ce.isEqual(t.Ce)&&is(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.De.isEqual(t.De)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Vu),Nu=(Ru.$e=function(t,e){var n=new Map;return n.set(t,Su.Be(t,e)),new Ru(yi.min(),n,Iu,du,bu())},Ru),Su=(Cu.Be=function(t,e){return new Cu(Vr.h,e,bu(),bu(),bu())},Cu),Au=function(t,e,n,r){this.je=t,this.removedTargetIds=e,this.key=n,this.We=r},xu=function(t,e){this.targetId=t,this.Ge=e},Du=function(t,e,n,r){void 0===n&&(n=Vr.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Ou=(Object.defineProperty(Lu.prototype,"qe",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),Object.defineProperty(Lu.prototype,"resumeToken",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(Lu.prototype,"Ze",{get:function(){return 0!==this.ze},enumerable:!1,configurable:!0}),Object.defineProperty(Lu.prototype,"tn",{get:function(){return this.Xe},enumerable:!1,configurable:!0}),Lu.prototype.en=function(t){0<t.o()&&(this.Xe=!0,this.Je=t)},Lu.prototype.nn=function(){var t=bu(),e=bu(),n=bu();return this.He.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Dr()}})),new Su(this.Je,this.Ye,t,e,n)},Lu.prototype.sn=function(){this.Xe=!1,this.He=qu()},Lu.prototype.rn=function(t,e){this.Xe=!0,this.He=this.He.Ht(t,e)},Lu.prototype.on=function(t){this.Xe=!0,this.He=this.He.remove(t)},Lu.prototype.cn=function(){this.ze+=1},Lu.prototype.an=function(){--this.ze},Lu.prototype.un=function(){this.Xe=!0,this.Ye=!0},Lu),ku=(Pu.prototype.wn=function(t){for(var e=0,n=t.je;e<n.length;e++){var r=n[e];t.We instanceof oo?this.En(r,t.We):t.We instanceof so&&this.Tn(r,t.key,t.We)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.Tn(r,t.key,t.We)},Pu.prototype.In=function(t){var e=this;this.mn(t,(function(n){var r=e.An(n);switch(t.state){case 0:e.Rn(n)&&r.en(t.resumeToken);break;case 1:r.an(),r.Ze||r.sn(),r.en(t.resumeToken);break;case 2:r.an(),r.Ze||e.removeTarget(n);break;case 3:e.Rn(n)&&(r.un(),r.en(t.resumeToken));break;case 4:e.Rn(n)&&(e.Pn(n),r.en(t.resumeToken));break;default:Dr()}}))},Pu.prototype.mn=function(t,e){var n=this;0<t.targetIds.length?t.targetIds.forEach(e):this.ln.forEach((function(t,r){n.Rn(r)&&e(r)}))},Pu.prototype.yn=function(t){var e=t.targetId,n=t.Ge.count;(t=this.gn(e))&&(vo(t=t.target)?0===n?(t=new wi(t.path),this.Tn(e,t,new so(t,yi.min()))):Or(1===n):this.Vn(e)!==n&&(this.Pn(e),this.dn=this.dn.add(e)))},Pu.prototype.pn=function(t){var e=this,n=new Map;this.ln.forEach((function(r,i){var o=e.gn(i);o&&(r.qe&&vo(o.target)&&(o=new wi(o.target.path),null!==e._n.get(o)||e.bn(i,o)||e.Tn(i,o,new so(o,t))),r.tn&&(n.set(i,r.nn()),r.sn()))}));var r=bu();this.fn.forEach((function(t,n){var i=!0;n.Re((function(t){return!(t=e.gn(t))||2===t.kt||(i=!1)})),i&&(r=r.add(t))}));var i=new Nu(t,n,this.dn,this._n,r);return this._n=du,this.fn=ju(),this.dn=new lu(Lr),i},Pu.prototype.En=function(t,e){var n;this.Rn(t)&&(n=this.bn(t,e.key)?2:0,this.An(t).rn(e.key,n),this._n=this._n.Ht(e.key,e),this.fn=this.fn.Ht(e.key,this.vn(e.key).add(t)))},Pu.prototype.Tn=function(t,e,n){var r;this.Rn(t)&&(r=this.An(t),this.bn(t,e)?r.rn(e,1):r.on(e),this.fn=this.fn.Ht(e,this.vn(e).delete(t)),n&&(this._n=this._n.Ht(e,n)))},Pu.prototype.removeTarget=function(t){this.ln.delete(t)},Pu.prototype.Vn=function(t){var e=this.An(t).nn();return this.hn.Sn(t).size+e.Ue.size-e.Ke.size},Pu.prototype.cn=function(t){this.An(t).cn()},Pu.prototype.An=function(t){var e=this.ln.get(t);return e||(e=new Ou,this.ln.set(t,e)),e},Pu.prototype.vn=function(t){var e=this.fn.get(t);return e||(e=new lu(Lr),this.fn=this.fn.Ht(t,e)),e},Pu.prototype.Rn=function(t){var e=null!==this.gn(t);return e||Nr("WatchChangeAggregator","Detected inactive target",t),e},Pu.prototype.gn=function(t){var e=this.ln.get(t);return e&&e.Ze?null:this.hn.Dn(t)},Pu.prototype.Pn=function(t){var e=this;this.ln.set(t,new Ou),this.hn.Sn(t).forEach((function(n){e.Tn(t,n,null)}))},Pu.prototype.bn=function(t,e){return this.hn.Sn(t).has(e)},Pu);function Pu(t){this.hn=t,this.ln=new Map,this._n=du,this.fn=ju(),this.dn=new lu(Lr)}function Lu(){this.ze=0,this.He=qu(),this.Je=Vr.h,this.Ye=!1,this.Xe=!0}function Cu(t,e,n,r,i){this.resumeToken=t,this.qe=e,this.Ue=n,this.Qe=r,this.Ke=i}function Ru(t,e,n,r,i){this.Mt=t,this.Fe=e,this.ke=n,this.Me=r,this.Le=i}function Vu(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.De=n,this.docChanges=r,this.Ce=i,this.fromCache=o,this.xe=s,this.Ne=u}function Mu(){this.ve=new ou(wi.J)}function Uu(t){this.J=t?function(e,n){return t(e,n)||wi.J(e.key,n.key)}:function(t,e){return wi.J(t.key,e.key)},this.Ve=gu,this.pe=new ou(this.J)}function ju(){return new ou(wi.J)}function qu(){return new ou(wi.J)}var Fu={asc:"ASCENDING",desc:"DESCENDING"},Hu={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Bu=function(t,e){this.T=t,this.qt=e};function Gu(t,e){return t.qt?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function zu(t,e){return t.qt?e.toBase64():e.toUint8Array()}function Ku(t){return Or(!!t),yi.j((t=Pi(t),new di(t.seconds,t.nanos)))}function Ju(t,e){return new vi(["projects",t.projectId,"databases",t.database]).child("documents").child(e).ot()}function Wu(t){return Or(pa(t=vi.ct(t))),t}function Xu(t,e){return Ju(t.T,e.path)}function Yu(t,e){if((e=Wu(e)).get(1)!==t.T.projectId)throw new qr(jr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.T.projectId);if(e.get(3)!==t.T.database)throw new qr(jr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.T.database);return new wi(ta(e))}function Qu(t,e){return Ju(t.T,e)}function $u(t){return 4===(t=Wu(t)).length?vi.at():ta(t)}function Zu(t){return new vi(["projects",t.T.projectId,"databases",t.T.database]).ot()}function ta(t){return Or(4<t.length&&"documents"===t.get(4)),t.X(5)}function ea(t,e,n){return{name:Xu(t,e),fields:n.proto.mapValue.fields}}function na(t,e,n){var r=Yu(t,e.name);return t=Ku(e.updateTime),e=new $i({mapValue:{fields:e.fields}}),new oo(r,t,e,{hasCommittedMutations:!!n})}function ra(t,e){var n,r,i;if(e instanceof Fs)n={update:ea(t,e.key,e.value)};else if(e instanceof Zs)n={delete:Xu(t,e.key)};else if(e instanceof Hs)n={update:ea(t,e.key,e.data),updateMask:(i=e.zt,r=[],i.fields.forEach((function(t){return r.push(t.ot())})),{fieldPaths:r})};else{if(!(e instanceof tu))return Dr();n={verify:Xu(t,e.key)}}return 0<e.fieldTransforms.length&&(n.updateTransforms=e.fieldTransforms.map((function(t){var e=t.transform;if(e instanceof gs)return{fieldPath:t.field.ot(),setToServerValue:"REQUEST_TIME"};if(e instanceof ms)return{fieldPath:t.field.ot(),appendMissingElements:{values:e.elements}};if(e instanceof Es)return{fieldPath:t.field.ot(),removeAllFromArray:{values:e.elements}};if(e instanceof As)return{fieldPath:t.field.ot(),increment:e.Qt};throw Dr()}))),e.Gt.Wt||(n.currentDocument=void 0!==(i=e.Gt).updateTime?{updateTime:(e=t,t=i.updateTime,Gu(e,t.G()))}:void 0!==i.exists?{exists:i.exists}:Dr()),n}function ia(t,e){var n=e.currentDocument?void 0!==(s=e.currentDocument).updateTime?Ls.updateTime(Ku(s.updateTime)):void 0!==s.exists?Ls.exists(s.exists):Ls.jt():Ls.jt(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n,r=null;return"setToServerValue"in e?(Or("REQUEST_TIME"===e.setToServerValue),r=new gs):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],r=new ms(n)):"removeAllFromArray"in e?(n=e.removeAllFromArray.values||[],r=new Es(n)):"increment"in e?r=new As(t,e.increment):Dr(),e=mi._t(e.fieldPath),new Ps(e,r)}(t,e)})):[];if(e.update){e.update.name;var i=Yu(t,e.update.name),o=new $i({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=(s=e.updateMask.fieldPaths||[],new Di(s.map((function(t){return mi._t(t)}))));return new Hs(i,o,s,n,r)}return new Fs(i,o,n,r)}return e.delete?(r=Yu(t,e.delete),new Zs(r,n)):e.verify?(e=Yu(t,e.verify),new tu(e,n)):Dr()}function oa(t,e){return{documents:[Qu(t,e.path)]}}function sa(t,e){var n={structuredQuery:{}},r=e.path;return null!==e.collectionGroup?(n.parent=Qu(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Qu(t,r.Z()),n.structuredQuery.from=[{collectionId:r.et()}]),(r=function(t){if(0!==t.length)return 1===(t=t.map((function(t){if("=="===t.op){if(Yi(t.value))return{unaryFilter:{field:ha(t.field),op:"IS_NAN"}};if(Xi(t.value))return{unaryFilter:{field:ha(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Yi(t.value))return{unaryFilter:{field:ha(t.field),op:"IS_NOT_NAN"}};if(Xi(t.value))return{unaryFilter:{field:ha(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ha(t.field),op:(e=t.op,Hu[e]),value:t.value}};var e}))).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(e.filters))&&(n.structuredQuery.where=r),(r=function(t){if(0!==t.length)return t.map((function(t){return{field:ha((t=t).field),direction:(t=t.dir,Fu[t])}}))}(e.orderBy))&&(n.structuredQuery.orderBy=r),r=e.limit,null!==(r=t.qt||Mi(r)?r:{value:r})&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=aa(e.startAt)),e.endAt&&(n.structuredQuery.endAt=aa(e.endAt)),n}function ua(t){var e=$u(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Or(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function t(e){return e?void 0!==e.unaryFilter?[la(e)]:void 0!==e.fieldFilter?[(n=e,mo.create(fa(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Dr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((function(e){return t(e)})).reduce((function(t,e){return t.concat(e)})):Dr():[];var n}(n.where)),t=[],n.orderBy&&(t=n.orderBy.map((function(t){return new Go(fa((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}))),r=null,n.limit&&(r=Mi(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=ca(n.startAt));var u=null;return n.endAt&&(u=ca(n.endAt)),Wo(e,i,t,o,r,"F",s,u)}function aa(t){return{before:t.before,values:t.position}}function ca(t){var e=!!t.before;return t=t.values||[],new Uo(t,e)}function ha(t){return{fieldPath:t.ot()}}function fa(t){return mi._t(t.fieldPath)}function la(t){switch(t.unaryFilter.op){case"IS_NAN":var e=fa(t.unaryFilter.field);return mo.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=fa(t.unaryFilter.field);return mo.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":return n=fa(t.unaryFilter.field),mo.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return t=fa(t.unaryFilter.field),mo.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Dr()}}function pa(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var da,ya=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},va=(Na.prototype.catch=function(t){return this.next(void 0,t)},Na.prototype.next=function(t,e){var n=this;return this.On&&Dr(),this.On=!0,this.Nn?this.error?this.Fn(e,this.error):this.kn(t,this.result):new Na((function(r,i){n.Cn=function(e){n.kn(t,e).next(r,i)},n.xn=function(t){n.Fn(e,t).next(r,i)}}))},Na.prototype.Mn=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},Na.prototype.Ln=function(t){try{var e=t();return e instanceof Na?e:Na.resolve(e)}catch(t){return Na.reject(t)}},Na.prototype.kn=function(t,e){return t?this.Ln((function(){return t(e)})):Na.resolve(e)},Na.prototype.Fn=function(t,e){return t?this.Ln((function(){return t(e)})):Na.reject(e)},Na.resolve=function(t){return new Na((function(e,n){e(t)}))},Na.reject=function(t){return new Na((function(e,n){n(t)}))},Na.$n=function(t){return new Na((function(e,n){var r=0,i=0,o=!1;t.forEach((function(t){++r,t.next((function(){++i,o&&i===r&&e()}),(function(t){return n(t)}))})),o=!0,i===r&&e()}))},Na.Bn=function(t){for(var e=Na.resolve(!1),n=0,r=t;n<r.length;n++)!function(t){e=e.next((function(e){return e?Na.resolve(e):t()}))}(r[n]);return e},Na.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.$n(r)},Na),ga=(Ta.open=function(t,e,n,r){try{return new Ta(e,t.transaction(r,n))}catch(t){throw new ba(e,t)}},Object.defineProperty(Ta.prototype,"Un",{get:function(){return this.qn.promise},enumerable:!1,configurable:!0}),Ta.prototype.abort=function(t){t&&this.qn.reject(t),this.aborted||(Nr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Ta.prototype.store=function(t){return t=this.transaction.objectStore(t),new Aa(t)},Ta),ma=(Ea.delete=function(t){return Nr("SimpleDb","Removing database:",t),Da(window.indexedDB.deleteDatabase(t)).Mn()},Ea.jn=function(){if("undefined"==typeof indexedDB)return!1;if(Ea.Wn())return!0;var t=g(),e=0<(n=Ea.Kn(t))&&n<10,n=0<(n=Ea.Gn(t))&&n<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||e||n)},Ea.Wn=function(){var t;return void 0!==e&&"YES"===(null===(t=e.env)||void 0===t?void 0:t.zn)},Ea.Hn=function(t,e){return t.store(e)},Ea.Kn=function(t){return t=(t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i))?t[1].split("_").slice(0,2).join("."):"-1",Number(t)},Ea.Gn=function(t){return t=(t=t.match(/Android ([\d.]+)/i))?t[1].split(".").slice(0,2).join("."):"-1",Number(t)},Ea.prototype.Jn=function(t){return d(this,void 0,void 0,(function(){var e,n=this;return y(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(Nr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){t=t.target.result,e(t)},i.onblocked=function(){r(new ba(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){"VersionError"===(e=e.target.error).name?r(new qr(jr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new ba(t,e))},i.onupgradeneeded=function(t){Nr("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.Qn.Yn(e,i.transaction,t.oldVersion,n.version).next((function(){Nr("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Xn&&(this.db.onversionchange=function(t){return n.Xn(t)}),this.db)]}}))}))},Ea.prototype.Zn=function(t){this.Xn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},Ea.prototype.runTransaction=function(t,e,n,r){return d(this,void 0,void 0,(function(){var i,o,s,u;return y(this,(function(a){switch(a.label){case 0:i="readonly"===e,o=0,u=function(){var e,u,a;return y(this,(function(c){switch(c.label){case 0:++o,c.label=1;case 1:return c.trys.push([1,4,,5]),[4,s.Jn(t)];case 2:return s.db=c.sent(),e=ga.open(s.db,t,i?"readonly":"readwrite",n),u=r(e).catch((function(t){return e.abort(t),va.reject(t)})).Mn(),a={},u.catch((function(){})),[4,e.Un];case 3:return[2,(a.value=(c.sent(),u),a)];case 4:return u=c.sent(),a="FirebaseError"!==u.name&&o<3,Nr("SimpleDb","Transaction failed with error:",u.message,"Retrying:",a),s.close(),a?[3,5]:[2,{value:Promise.reject(u)}];case 5:return[2]}}))},s=this,a.label=1;case 1:return[5,u()];case 2:if("object"==typeof(u=a.sent()))return[2,u.value];a.label=3;case 3:return[3,1];case 4:return[2]}}))}))},Ea.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},Ea),wa=(Object.defineProperty(_a.prototype,"Nn",{get:function(){return this.es},enumerable:!1,configurable:!0}),Object.defineProperty(_a.prototype,"ss",{get:function(){return this.ns},enumerable:!1,configurable:!0}),Object.defineProperty(_a.prototype,"cursor",{set:function(t){this.ts=t},enumerable:!1,configurable:!0}),_a.prototype.done=function(){this.es=!0},_a.prototype.rs=function(t){this.ns=t},_a.prototype.delete=function(){return Da(this.ts.delete())},_a),ba=(p(Ia,da=qr),Ia);function Ia(t,e){var n=this;return(n=da.call(this,jr.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function _a(t){this.ts=t,this.es=!1,this.ns=null}function Ea(t,e,n){this.name=t,this.version=e,this.Qn=n,12.2===Ea.Kn(g())&&Sr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function Ta(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.qn=new ya,this.transaction.oncomplete=function(){n.qn.resolve()},this.transaction.onabort=function(){e.error?n.qn.reject(new ba(t,e.error)):n.qn.resolve()},this.transaction.onerror=function(e){e=ka(e.target.error),n.qn.reject(new ba(t,e))}}function Na(t){var e=this;this.Cn=null,this.xn=null,this.result=void 0,this.error=void 0,this.Nn=!1,this.On=!1,t((function(t){e.Nn=!0,e.result=t,e.Cn&&e.Cn(t)}),(function(t){e.Nn=!0,e.error=t,e.xn&&e.xn(t)}))}function Sa(t){return"IndexedDbTransactionError"===t.name}var Aa=(xa.prototype.put=function(t,e){return Da(t=void 0!==e?(Nr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Nr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},xa.prototype.add=function(t){return Nr("SimpleDb","ADD",this.store.name,t,t),Da(this.store.add(t))},xa.prototype.get=function(t){var e=this;return Da(this.store.get(t)).next((function(n){return void 0===n&&(n=null),Nr("SimpleDb","GET",e.store.name,t,n),n}))},xa.prototype.delete=function(t){return Nr("SimpleDb","DELETE",this.store.name,t),Da(this.store.delete(t))},xa.prototype.count=function(){return Nr("SimpleDb","COUNT",this.store.name),Da(this.store.count())},xa.prototype.os=function(t,e){e=this.cursor(this.options(t,e));var n=[];return this.cs(e,(function(t,e){n.push(e)})).next((function(){return n}))},xa.prototype.us=function(t,e){return Nr("SimpleDb","DELETE ALL",this.store.name),(e=this.options(t,e)).hs=!1,e=this.cursor(e),this.cs(e,(function(t,e,n){return n.delete()}))},xa.prototype.ls=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.cs(n,e)},xa.prototype._s=function(t){var e=this.cursor({});return new va((function(n,r){e.onerror=function(t){t=ka(t.target.error),r(t)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},xa.prototype.cs=function(t,e){var n=[];return new va((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i,o=t.target.result;o?(i=new wa(o),(t=e(o.primaryKey,o.value,i))instanceof va&&(t=t.catch((function(t){return i.done(),va.reject(t)})),n.push(t)),i.Nn?r():null===i.ss?o.continue():o.continue(i.ss)):r()}})).next((function(){return va.$n(n)}))},xa.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},xa.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.hs?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},xa);function xa(t){this.store=t}function Da(t){return new va((function(e,n){t.onsuccess=function(t){t=t.target.result,e(t)},t.onerror=function(t){t=ka(t.target.error),n(t)}}))}var Oa=!1;function ka(t){var e=ma.Kn(g());if(12.2<=e&&e<13&&(e="An internal error was encountered in the Indexed Database server",0<=t.message.indexOf(e))){var n=new qr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Oa||(Oa=!0,setTimeout((function(){throw n}),0)),n}return t}var Pa=(La.Is=function(t,e,n,r,i){return(i=new La(t,e,Date.now()+n,r,i)).start(n),i},La.prototype.start=function(t){var e=this;this.As=setTimeout((function(){return e.Rs()}),t)},La.prototype.Ps=function(){return this.Rs()},La.prototype.cancel=function(t){null!==this.As&&(this.clearTimeout(),this.Ts.reject(new qr(jr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},La.prototype.Rs=function(){var t=this;this.fs.ys((function(){return null!==t.As?(t.clearTimeout(),t.op().then((function(e){return t.Ts.resolve(e)}))):Promise.resolve()}))},La.prototype.clearTimeout=function(){null!==this.As&&(this.Es(this),clearTimeout(this.As),this.As=null)},La);function La(t,e,n,r,i){this.fs=t,this.ds=e,this.ws=n,this.op=r,this.Es=i,this.Ts=new ya,this.then=this.Ts.promise.then.bind(this.Ts.promise),this.Ts.promise.catch((function(t){}))}function Ca(t,e){if(Sr("AsyncQueue",e+": "+t),Sa(t))return new qr(jr.UNAVAILABLE,e+": "+t);throw t}var Ra="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";function Va(){this.gs=[]}function Ma(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=Ua(e)),e=function(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}(t.get(n),e);return Ua(e)}function Ua(t){return t+""}function ja(t){var e=t.length;if(Or(2<=e),2===e)return Or(""===t.charAt(0)&&""===t.charAt(1)),vi.at();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&Dr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Dr()}o=s+2}return new vi(r)}function qa(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}Va.prototype.Vs=function(t){this.gs.push(t)},Va.prototype.ps=function(){this.gs.forEach((function(t){return t()}))},h=Va;var Fa=function(t,e){this.seconds=t,this.nanoseconds=e};function Ha(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}function Ba(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}qa.store="owner",qa.key="owner",Ha.store="mutationQueues",Ha.keyPath="userId",Ba.store="mutations",Ba.keyPath="batchId",Ba.userMutationsIndex="userMutationsIndex",Ba.userMutationsKeyPath=["userId","batchId"];var Ga=(za.prefixForUser=function(t){return[t]},za.prefixForPath=function(t,e){return[t,Ma(e)]},za.key=function(t,e,n){return[t,Ma(e),n]},za);function za(){}function Ka(t,e){this.path=t,this.readTime=e}function Ja(t,e){this.path=t,this.version=e}Ga.store="documentMutations",Ga.PLACEHOLDER=new Ga;var Wa=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};function Xa(t){this.byteSize=t}function Ya(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s}Wa.store="remoteDocuments",Wa.readTimeIndex="readTimeIndex",Wa.readTimeIndexPath="readTime",Wa.collectionReadTimeIndex="collectionReadTimeIndex",Wa.collectionReadTimeIndexPath=["parentPath","readTime"],Xa.store="remoteDocumentGlobal",Xa.key="remoteDocumentGlobalKey",Ya.store="targets",Ya.keyPath="targetId",Ya.queryTargetsIndexName="queryTargetsIndex",Ya.queryTargetsKeyPath=["canonicalId","targetId"];var Qa=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};function $a(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}function Za(t,e){this.collectionId=t,this.parent=e}function tc(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r}function ec(t,e,n){this.bundleId=t,this.createTime=e,this.version=n}function nc(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n}Qa.store="targetDocuments",Qa.keyPath=["targetId","path"],Qa.documentTargetsIndex="documentTargetsIndex",Qa.documentTargetsKeyPath=["path","targetId"],$a.key="targetGlobalKey",$a.store="targetGlobal",Za.store="collectionParents",Za.keyPath=["collectionId","parent"],tc.store="clientMetadata",tc.keyPath="clientId",ec.store="bundles",ec.keyPath="bundleId",nc.store="namedQueries",nc.keyPath="name";var rc,ic=v(v(v(v([Ha.store,Ba.store,Ga.store,Wa.store,Ya.store,qa.store,$a.store,Qa.store],[tc.store]),[Xa.store]),[Za.store]),[ec.store,nc.store]),oc=(p(sc,rc=h),sc);function sc(t,e){var n=this;return(n=rc.call(this)||this).bs=t,n.vs=e,n}function uc(t,e){return ma.Hn(t.bs,e)}var ac=(lc.prototype.Ds=function(t,e,n){for(var r,i,o,s,u,a,c=n.Cs,h=0;h<this.mutations.length;h++){var f=this.mutations[h];f.key.isEqual(t)&&(r=f,i=e,o=c[h],f=a=u=s=void 0,e=r instanceof Fs?(u=o,f=(s=r).value,u.transformResults&&(a=Ks(s.fieldTransforms,i,u.transformResults),f=Ws(s.fieldTransforms,f,a)),new oo(s.key,u.version,f,{hasCommittedMutations:!0})):r instanceof Hs?function(t,e,n){return Rs(t.Gt,e)?(e=zs(t,e,n.transformResults?Ks(t.fieldTransforms,e,n.transformResults):[]),new oo(t.key,n.version,e,{hasCommittedMutations:!0})):new uo(t.key,n.version)}(r,i,o):new so(r.key,o.version,{hasCommittedMutations:!0}))}return e},lc.prototype.xs=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++)(i=r[n]).key.isEqual(t)&&(e=Vs(i,e,0,this.Ss));for(var i,o=0,s=this.mutations;o<s.length;o++)(i=s[o]).key.isEqual(t)&&(e=Vs(i,e,0,this.Ss));return e},lc.prototype.Ns=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.xs(r.key,t.get(r.key));i&&(n=n.Ht(r.key,i))})),n},lc.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),bu())},lc.prototype.isEqual=function(t){return this.batchId===t.batchId&&Cr(this.mutations,t.mutations,Ms)&&Cr(this.baseMutations,t.baseMutations,Ms)},lc),cc=(fc.from=function(t,e,n){Or(t.mutations.length===n.length);for(var r=mu,i=t.mutations,o=0;o<i.length;o++)r=r.Ht(i[o].key,n[o].version);return new fc(t,e,n,r)},fc),hc=function(t){this.ks=t};function fc(t,e,n,r){this.batch=t,this.Os=e,this.Cs=n,this.Fs=r}function lc(t,e,n,r){this.batchId=t,this.Ss=e,this.baseMutations=n,this.mutations=r}function pc(t,e){if(e.document)return na(t.ks,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=wi.Tt(e.noDocument.path),r=mc(e.noDocument.readTime);return new so(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}return e.unknownDocument?(n=wi.Tt(e.unknownDocument.path),r=mc(e.unknownDocument.version),new uo(n,r)):Dr()}function dc(t,e,n){var r=yc(n);if(n=e.key.path.Z().rt(),e instanceof oo){var i={name:Xu(o=t.ks,(s=e).key),fields:s.vt().mapValue.fields,updateTime:Gu(o,s.version.G())},o=e.hasCommittedMutations;return new Wa(null,null,i,o,r,n)}if(e instanceof so){var s=e.key.path.rt();return i=gc(e.version),o=e.hasCommittedMutations,new Wa(null,new Ka(s,i),null,o,r,n)}return e instanceof uo?(o=e.key.path.rt(),e=gc(e.version),new Wa(new Ja(o,e),null,null,!0,r,n)):Dr()}function yc(t){return[(t=t.G()).seconds,t.nanoseconds]}function vc(t){return t=new di(t[0],t[1]),yi.j(t)}function gc(t){return t=t.G(),new Fa(t.seconds,t.nanoseconds)}function mc(t){return t=new di(t.seconds,t.nanoseconds),yi.j(t)}function wc(t,e){for(var n=(e.baseMutations||[]).map((function(e){return ia(t.ks,e)})),r=e.mutations.length-1;0<=r;--r){var i=e.mutations[r];void 0!==(null==i?void 0:i.transform)&&(e.mutations[r-1].updateTransforms=i.transform.fieldTransforms,e.mutations.splice(r,1),--r)}var o=e.mutations.map((function(e){return ia(t.ks,e)})),s=di.fromMillis(e.localWriteTimeMs);return new ac(e.batchId,s,n,o)}function bc(t){var e=mc(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?mc(t.lastLimboFreeSnapshotVersion):yi.min(),r=void 0!==t.query.documents?(Or(1===(r=t.query).documents.length),ns(Xo($u(r.documents[0])))):ns(ua(t.query));return new cs(r,t.targetId,0,t.lastListenSequenceNumber,e,n,Vr.fromBase64String(t.resumeToken))}function Ic(t,e){var n=gc(e.Mt),r=gc(e.lastLimboFreeSnapshotVersion),i=(vo(e.target)?oa:sa)(t.ks,e.target);return t=e.resumeToken.toBase64(),new Ya(e.targetId,po(e.target),n,t,e.sequenceNumber,r,i)}function _c(t){var e=ua({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?rs(e,e.limit,"L"):e}var Ec=(Tc.prototype.Ms=function(t,e){return Nc(t).get(e).next((function(t){if(t)return{id:(t=t).bundleId,createTime:mc(t.createTime),version:t.version}}))},Tc.prototype.Ls=function(t,e){return Nc(t).put({bundleId:(e=e).id,createTime:gc(Ku(e.createTime)),version:e.version})},Tc.prototype.$s=function(t,e){return Sc(t).get(e).next((function(t){if(t)return{name:(t=t).name,query:_c(t.bundledQuery),readTime:mc(t.readTime)}}))},Tc.prototype.Bs=function(t,e){return Sc(t).put({name:(e=e).name,readTime:gc(Ku(e.readTime)),bundledQuery:e.bundledQuery})},Tc);function Tc(){}function Nc(t){return uc(t,ec.store)}function Sc(t){return uc(t,nc.store)}var Ac=(Pc.prototype.Us=function(t,e){return this.qs.add(e),va.resolve()},Pc.prototype.Qs=function(t,e){return va.resolve(this.qs.getEntries(e))},Pc),xc=(kc.prototype.add=function(t){var e=t.et(),n=t.Z(),r=this.index[e]||new lu(vi.J);return t=!r.has(n),this.index[e]=r.add(n),t},kc.prototype.has=function(t){var e=t.et();return t=t.Z(),(e=this.index[e])&&e.has(t)},kc.prototype.getEntries=function(t){return(this.index[t]||new lu(vi.J)).rt()},kc),Dc=(Oc.prototype.Us=function(t,e){var n=this;if(this.Ks.has(e))return va.resolve();var r=e.et(),i=e.Z();return t.Vs((function(){n.Ks.add(e)})),i={collectionId:r,parent:Ma(i)},Lc(t).put(i)},Oc.prototype.Qs=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Rr(e),""],!1,!0);return Lc(t).os(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(ja(o.parent))}return n}))},Oc);function Oc(){this.Ks=new xc}function kc(){this.index={}}function Pc(){this.qs=new xc}function Lc(t){return uc(t,Za.store)}var Cc={js:!1,Ws:0,Gs:0,zs:0},Rc=(Vc.Xs=function(t){return new Vc(t,Vc.Zs,Vc.ti)},Vc);function Vc(t,e,n){this.Hs=t,this.Js=e,this.Ys=n}function Mc(t){return d(this,void 0,void 0,(function(){return y(this,(function(e){if(t.code!==jr.FAILED_PRECONDITION||t.message!==Ra)throw t;return Nr("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}Rc.Zs=10,Rc.ti=1e3,Rc.ei=new Rc(41943040,Rc.Zs,Rc.ti),Rc.ni=new Rc(-1,0,0);var Uc=(qc.prototype.get=function(t){var e=this.si(t);if(void 0!==(e=this.ri[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.ii(i,t))return o}},qc.prototype.has=function(t){return void 0!==this.get(t)},qc.prototype.set=function(t,e){var n=this.si(t),r=this.ri[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.ii(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.ri[n]=[[t,e]]},qc.prototype.delete=function(t){var e=this.si(t),n=this.ri[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.ii(n[r][0],t))return 1===n.length?delete this.ri[e]:n.splice(r,1),!0;return!1},qc.prototype.forEach=function(t){Ai(this.ri,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=(s=i[r])[0],s=s[1];t(o,s)}}))},qc.prototype.nt=function(){return xi(this.ri)},qc);function jc(){this.oi=new Uc((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.ci=!1}function qc(t,e){this.si=t,this.ii=e,this.ri={}}function Fc(t,e,n){var r=t.store(Ba.store),i=t.store(Ga.store),o=[],s=(t=IDBKeyRange.only(n.batchId),0);t=r.ls({range:t},(function(t,e,n){return s++,n.delete()})),o.push(t.next((function(){Or(1===s)})));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],f=Ga.key(e,h.key.path,n.batchId);o.push(i.delete(f)),u.push(h.key)}return va.$n(o).next((function(){return u}))}function Hc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Dr();e=t.noDocument}return JSON.stringify(e).length}jc.prototype.ai=function(t){return(t=this.oi.get(t))?t.readTime:yi.min()},jc.prototype.ui=function(t,e){this.hi(),this.oi.set(t.key,{li:t,readTime:e})},jc.prototype._i=function(t,e){void 0===e&&(e=null),this.hi(),this.oi.set(t,{li:null,readTime:e})},jc.prototype.fi=function(t,e){this.hi();var n=this.oi.get(e);return void 0!==n?va.resolve(n.li):this.di(t,e)},jc.prototype.getEntries=function(t,e){return this.wi(t,e)},jc.prototype.apply=function(t){return this.hi(),this.ci=!0,this.Ei(t)},jc.prototype.hi=function(){},Ne=jc;var Bc=(Gc.Ai=function(t,e,n,r){return Or(""!==t.uid),new Gc(t.A()?t.uid:"",e,n,r)},Gc.prototype.Ri=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Kc(t).ls({index:Ba.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},Gc.prototype.Pi=function(t,e,n,r){var i=this,o=Jc(t),s=Kc(t);return s.add({}).next((function(u){Or("number"==typeof u);for(var a,c,h,f,l,p=new ac(u,e,n,r),d=(a=i.Kt,c=i.userId,f=(h=p).baseMutations.map((function(t){return ra(a.ks,t)})),l=h.mutations.map((function(t){return ra(a.ks,t)})),new Ba(c,h.batchId,h.Ss.toMillis(),f,l)),y=[],v=new lu((function(t,e){return Lr(t.ot(),e.ot())})),g=0,m=r;g<m.length;g++){var w=m[g],b=Ga.key(i.userId,w.key.path,u);v=v.add(w.key.path.Z()),y.push(s.put(d)),y.push(o.put(b,Ga.PLACEHOLDER))}return v.forEach((function(e){y.push(i.Ti.Us(t,e))})),t.Vs((function(){i.mi[u]=p.keys()})),va.$n(y).next((function(){return p}))}))},Gc.prototype.yi=function(t,e){var n=this;return Kc(t).get(e).next((function(t){return t?(Or(t.userId===n.userId),wc(n.Kt,t)):null}))},Gc.prototype.gi=function(t,e){var n=this;return this.mi[e]?va.resolve(this.mi[e]):this.yi(t,e).next((function(t){return t?(t=t.keys(),n.mi[e]=t):null}))},Gc.prototype.Vi=function(t,e){var n=this,r=e+1,i=(e=IDBKeyRange.lowerBound([this.userId,r]),null);return Kc(t).ls({index:Ba.userMutationsIndex,range:e},(function(t,e,o){e.userId===n.userId&&(Or(e.batchId>=r),i=wc(n.Kt,e)),o.done()})).next((function(){return i}))},Gc.prototype.pi=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Kc(t).ls({index:Ba.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},Gc.prototype.bi=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Kc(t).os(Ba.userMutationsIndex,n).next((function(t){return t.map((function(t){return wc(e.Kt,t)}))}))},Gc.prototype.vi=function(t,e){var n=this,r=Ga.prefixForPath(this.userId,e.path),i=(r=IDBKeyRange.lowerBound(r),[]);return Jc(t).ls({range:r},(function(r,o,s){var u=r[0],a=r[1];if(r=r[2],a=ja(a),u===n.userId&&e.path.isEqual(a))return Kc(t).get(r).next((function(t){if(!t)throw Dr();Or(t.userId===n.userId),i.push(wc(n.Kt,t))}));s.done()})).next((function(){return i}))},Gc.prototype.Si=function(t,e){var n=this,r=new lu(Lr),i=[];return e.forEach((function(e){var o=Ga.prefixForPath(n.userId,e.path);o=IDBKeyRange.lowerBound(o),o=Jc(t).ls({range:o},(function(t,i,o){var s=t[0],u=t[1];t=t[2],u=ja(u),s===n.userId&&e.path.isEqual(u)?r=r.add(t):o.done()})),i.push(o)})),va.$n(i).next((function(){return n.Di(t,r)}))},Gc.prototype.Ci=function(t,e){var n=this,r=e.path,i=r.length+1,o=(e=Ga.prefixForPath(this.userId,r),e=IDBKeyRange.lowerBound(e),new lu(Lr));return Jc(t).ls({range:e},(function(t,e,s){var u=t[0],a=t[1];t=t[2],a=ja(a),u===n.userId&&r.st(a)?a.length===i&&(o=o.add(t)):s.done()})).next((function(){return n.Di(t,o)}))},Gc.prototype.Di=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(Kc(t).get(e).next((function(t){if(null===t)throw Dr();Or(t.userId===n.userId),r.push(wc(n.Kt,t))})))})),va.$n(i).next((function(){return r}))},Gc.prototype.xi=function(t,e){var n=this;return Fc(t.bs,this.userId,e).next((function(r){return t.Vs((function(){n.Ni(e.batchId)})),va.forEach(r,(function(e){return n.Ii.Oi(t,e)}))}))},Gc.prototype.Ni=function(t){delete this.mi[t]},Gc.prototype.Fi=function(t){var e=this;return this.Ri(t).next((function(n){if(!n)return va.resolve();n=IDBKeyRange.lowerBound(Ga.prefixForUser(e.userId));var r=[];return Jc(t).ls({range:n},(function(t,n,i){t[0]===e.userId?(t=ja(t[1]),r.push(t)):i.done()})).next((function(){Or(0===r.length)}))}))},Gc.prototype.ki=function(t,e){return zc(t,this.userId,e)},Gc.prototype.Mi=function(t){var e=this;return Wc(t).get(this.userId).next((function(t){return t||new Ha(e.userId,-1,"")}))},Gc);function Gc(t,e,n,r){this.userId=t,this.Kt=e,this.Ti=n,this.Ii=r,this.mi={}}function zc(t,e,n){var r=(n=Ga.prefixForPath(e,n.path))[1],i=(n=IDBKeyRange.lowerBound(n),!1);return Jc(t).ls({range:n,hs:!0},(function(t,n,o){var s=t[0],u=t[1];t[2],s===e&&u===r&&(i=!0),o.done()})).next((function(){return i}))}function Kc(t){return uc(t,Ba.store)}function Jc(t){return uc(t,Ga.store)}function Wc(t){return uc(t,Ha.store)}var Xc=($c.prototype.next=function(){return this.Li+=2,this.Li},$c.$i=function(){return new $c(0)},$c.Bi=function(){return new $c(-1)},$c),Yc=(Qc.prototype.qi=function(t){var e=this;return this.Ui(t).next((function(n){var r=new Xc(n.highestTargetId);return n.highestTargetId=r.next(),e.Qi(t,n).next((function(){return n.highestTargetId}))}))},Qc.prototype.Ki=function(t){return this.Ui(t).next((function(t){return yi.j(new di(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},Qc.prototype.ji=function(t){return this.Ui(t).next((function(t){return t.highestListenSequenceNumber}))},Qc.prototype.Wi=function(t,e,n){var r=this;return this.Ui(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.G()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Qi(t,i)}))},Qc.prototype.Gi=function(t,e){var n=this;return this.zi(t,e).next((function(){return n.Ui(t).next((function(r){return r.targetCount+=1,n.Hi(e,r),n.Qi(t,r)}))}))},Qc.prototype.Ji=function(t,e){return this.zi(t,e)},Qc.prototype.Yi=function(t,e){var n=this;return this.Xi(t,e.targetId).next((function(){return Zc(t).delete(e.targetId)})).next((function(){return n.Ui(t)})).next((function(e){return Or(0<e.targetCount),--e.targetCount,n.Qi(t,e)}))},Qc.prototype.Zi=function(t,e,n){var r=this,i=0,o=[];return Zc(t).ls((function(s,u){(u=bc(u)).sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.Yi(t,u)))})).next((function(){return va.$n(o)})).next((function(){return i}))},Qc.prototype.mn=function(t,e){return Zc(t).ls((function(t,n){n=bc(n),e(n)}))},Qc.prototype.Ui=function(t){return th(t).get($a.key).next((function(t){return Or(null!==t),t}))},Qc.prototype.Qi=function(t,e){return th(t).put($a.key,e)},Qc.prototype.zi=function(t,e){return Zc(t).put(Ic(this.Kt,e))},Qc.prototype.Hi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},Qc.prototype.tr=function(t){return this.Ui(t).next((function(t){return t.targetCount}))},Qc.prototype.er=function(t,e){var n=po(e),r=(n=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),null);return Zc(t).ls({range:n,index:Ya.queryTargetsIndexName},(function(t,n,i){n=bc(n),yo(e,n.target)&&(r=n,i.done())})).next((function(){return r}))},Qc.prototype.nr=function(t,e,n){var r=this,i=[],o=eh(t);return e.forEach((function(e){var s=Ma(e.path);i.push(o.put(new Qa(n,s))),i.push(r.Ii.sr(t,n,e))})),va.$n(i)},Qc.prototype.ir=function(t,e,n){var r=this,i=eh(t);return va.forEach(e,(function(e){var o=Ma(e.path);return va.$n([i.delete([n,o]),r.Ii.rr(t,n,e)])}))},Qc.prototype.Xi=function(t,e){return t=eh(t),e=IDBKeyRange.bound([e],[e+1],!1,!0),t.delete(e)},Qc.prototype.cr=function(t,e){e=IDBKeyRange.bound([e],[e+1],!1,!0),t=eh(t);var n=bu();return t.ls({range:e,hs:!0},(function(t,e,r){t=ja(t[1]),t=new wi(t),n=n.add(t)})).next((function(){return n}))},Qc.prototype.ki=function(t,e){e=Ma(e.path),e=IDBKeyRange.bound([e],[Rr(e)],!1,!0);var n=0;return eh(t).ls({index:Qa.documentTargetsIndex,hs:!0,range:e},(function(t,e,r){var i=t[0];t[1],0!==i&&(n++,r.done())})).next((function(){return 0<n}))},Qc.prototype.Dn=function(t,e){return Zc(t).get(e).next((function(t){return t?bc(t):null}))},Qc);function Qc(t,e){this.Ii=t,this.Kt=e}function $c(t){this.Li=t}function Zc(t){return uc(t,Ya.store)}function th(t){return uc(t,$a.store)}function eh(t){return uc(t,Qa.store)}function nh(t,e){var n=t[0],r=t[1];return t=e[0],e=e[1],0===(t=Lr(n,t))?Lr(r,e):t}var rh=(hh.prototype.hr=function(){return++this.ur},hh.prototype.lr=function(t){var e=[t,this.hr()];this.buffer.size<this.ar?this.buffer=this.buffer.add(e):nh(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(hh.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),hh),ih=(ch.prototype.start=function(t){-1!==this._r.params.Hs&&this.Er(t)},ch.prototype.stop=function(){this.wr&&(this.wr.cancel(),this.wr=null)},Object.defineProperty(ch.prototype,"Tr",{get:function(){return null!==this.wr},enumerable:!1,configurable:!0}),ch.prototype.Er=function(t){var e=this,n=this.dr?3e5:6e4;Nr("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.wr=this.fs.Ir("lru_garbage_collection",n,(function(){return d(e,void 0,void 0,(function(){var e;return y(this,(function(n){switch(n.label){case 0:this.wr=null,this.dr=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.mr(this._r)];case 2:return n.sent(),[3,7];case 3:return Sa(e=n.sent())?(Nr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Mc(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.Er(t)];case 8:return n.sent(),[2]}}))}))}))},ch),oh=(ah.prototype.Rr=function(t,e){return this.Ar.Pr(t).next((function(t){return Math.floor(e/100*t)}))},ah.prototype.yr=function(t,e){var n=this;if(0===e)return va.resolve(si.U);var r=new rh(e);return this.Ar.mn(t,(function(t){return r.lr(t.sequenceNumber)})).next((function(){return n.Ar.gr(t,(function(t){return r.lr(t)}))})).next((function(){return r.maxValue}))},ah.prototype.Zi=function(t,e,n){return this.Ar.Zi(t,e,n)},ah.prototype.Vr=function(t,e){return this.Ar.Vr(t,e)},ah.prototype.pr=function(t,e){var n=this;return-1===this.params.Hs?(Nr("LruGarbageCollector","Garbage collection skipped; disabled"),va.resolve(Cc)):this.br(t).next((function(r){return r<n.params.Hs?(Nr("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.Hs),Cc):n.vr(t,e)}))},ah.prototype.br=function(t){return this.Ar.br(t)},ah.prototype.vr=function(t,e){var n,i,o,s,u,a,c,h=this,f=Date.now();return this.Rr(t,this.params.Js).next((function(e){return i=e>h.params.Ys?(Nr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.Ys+" from "+e),h.params.Ys):e,s=Date.now(),h.yr(t,i)})).next((function(r){return n=r,u=Date.now(),h.Zi(t,n,e)})).next((function(e){return o=e,a=Date.now(),h.Vr(t,n)})).next((function(t){return c=Date.now(),Tr()<=r.DEBUG&&Nr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),va.resolve({js:!0,Ws:i,Gs:o,zs:t})}))},ah),sh=(uh.prototype.Pr=function(t){var e=this.Sr(t);return this.db.Dr().tr(t).next((function(t){return e.next((function(e){return t+e}))}))},uh.prototype.Sr=function(t){var e=0;return this.gr(t,(function(t){e++})).next((function(){return e}))},uh.prototype.mn=function(t,e){return this.db.Dr().mn(t,e)},uh.prototype.gr=function(t,e){return this.Cr(t,(function(t,n){return e(n)}))},uh.prototype.sr=function(t,e,n){return fh(t,n)},uh.prototype.rr=function(t,e,n){return fh(t,n)},uh.prototype.Zi=function(t,e,n){return this.db.Dr().Zi(t,e,n)},uh.prototype.Oi=fh,uh.prototype.Nr=function(t,e){return r=e,i=!1,Wc(n=t)._s((function(t){return zc(n,t,r).next((function(t){return t&&(i=!0),va.resolve(!t)}))})).next((function(){return i}));var n,r,i},uh.prototype.Vr=function(t,e){var n=this,r=this.db.Fr().Or(),i=[],o=0;return this.Cr(t,(function(s,u){u<=e&&(u=n.Nr(t,s).next((function(e){if(!e)return o++,r.fi(t,s).next((function(){return r._i(s),eh(t).delete([0,Ma(s.path)])}))})),i.push(u))})).next((function(){return va.$n(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},uh.prototype.removeTarget=function(t,e){return e=e.Lt(t.vs),this.db.Dr().Ji(t,e)},uh.prototype.kr=fh,uh.prototype.Cr=function(t,e){t=eh(t);var n,r=si.U;return t.ls({index:Qa.documentTargetsIndex},(function(t,i){var o=t[0];t[1],t=i.path,i=i.sequenceNumber,0===o?(r!==si.U&&e(new wi(ja(n)),r),r=i,n=t):r=si.U})).next((function(){r!==si.U&&e(new wi(ja(n)),r)}))},uh.prototype.br=function(t){return this.db.Fr().Mr(t)},uh);function uh(t,e){this.db=t,this._r=new oh(this,e)}function ah(t,e){this.Ar=t,this.params=e}function ch(t,e){this._r=t,this.fs=e,this.dr=!1,this.wr=null}function hh(t){this.ar=t,this.buffer=new lu(nh),this.ur=0}function fh(t,e){return eh(t).put((t=t.vs,new Qa(0,Ma(e.path),t)))}var lh,ph=(vh.prototype.ui=function(t,e,n){return mh(t).put(wh(e),n)},vh.prototype._i=function(t,e){return t=mh(t),e=wh(e),t.delete(e)},vh.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.Lr(t,r)}))},vh.prototype.fi=function(t,e){var n=this;return mh(t).get(wh(e)).next((function(t){return n.$r(t)}))},vh.prototype.Br=function(t,e){var n=this;return mh(t).get(wh(e)).next((function(t){var e=n.$r(t);return e?{li:e,size:Hc(t)}:null}))},vh.prototype.getEntries=function(t,e){var n=this,r=du;return this.qr(t,e,(function(t,e){e=n.$r(e),r=r.Ht(t,e)})).next((function(){return r}))},vh.prototype.Ur=function(t,e){var n=this,r=du,i=new ou(wi.J);return this.qr(t,e,(function(t,e){var o=n.$r(e);i=o?(r=r.Ht(t,o),i.Ht(t,Hc(e))):(r=r.Ht(t,null),i.Ht(t,0))})).next((function(){return{Qr:r,Kr:i}}))},vh.prototype.qr=function(t,e,n){if(e.nt())return va.resolve();var r=IDBKeyRange.bound(e.first().path.rt(),e.last().path.rt()),i=e.ee(),o=i.ce();return mh(t).ls({range:r},(function(t,e,r){for(var s=wi.Tt(t);o&&wi.J(o,s)<0;)n(o,null),o=i.ce();o&&o.isEqual(s)&&(n(o,e),o=i.ae()?i.ce():null),o?r.rs(o.path.rt()):r.done()})).next((function(){for(;o;)n(o,null),o=i.ae()?i.ce():null}))},vh.prototype.jr=function(t,e,n){var r,i=this,o=gu,s=e.path.length+1,u={};return n.isEqual(yi.min())?(r=e.path.rt(),u.range=IDBKeyRange.lowerBound(r)):(r=e.path.rt(),n=yc(n),u.range=IDBKeyRange.lowerBound([r,n],!0),u.index=Wa.collectionReadTimeIndex),mh(t).ls(u,(function(t,n,r){t.length===s&&(n=pc(i.Kt,n),e.path.st(n.key.path)?n instanceof oo&&us(e,n)&&(o=o.Ht(n.key,n)):r.done())})).next((function(){return o}))},vh.prototype.Or=function(t){return new dh(this,!!t&&t.Wr)},vh.prototype.Mr=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},vh.prototype.getMetadata=function(t){return gh(t).get(Xa.key).next((function(t){return Or(!!t),t}))},vh.prototype.Lr=function(t,e){return gh(t).put(Xa.key,e)},vh.prototype.$r=function(t){return t?(t=pc(this.Kt,t))instanceof so&&t.version.isEqual(yi.min())?null:t:null},vh),dh=(p(yh,lh=Ne),yh.prototype.Ei=function(t){var e=this,n=[],r=0,i=new lu((function(t,e){return Lr(t.ot(),e.ot())}));return this.oi.forEach((function(o,s){var u,a=e.zr.get(o);s.li?(u=dc(e.Gr.Kt,s.li,e.ai(o)),i=i.add(o.path.Z()),s=Hc(u),r+=s-a,n.push(e.Gr.ui(t,o,u))):(r-=a,e.Wr?(a=dc(e.Gr.Kt,new so(o,yi.min()),e.ai(o)),n.push(e.Gr.ui(t,o,a))):n.push(e.Gr._i(t,o)))})),i.forEach((function(r){n.push(e.Gr.Ti.Us(t,r))})),n.push(this.Gr.updateMetadata(t,r)),va.$n(n)},yh.prototype.di=function(t,e){var n=this;return this.Gr.Br(t,e).next((function(t){return null===t?(n.zr.set(e,0),null):(n.zr.set(e,t.size),t.li)}))},yh.prototype.wi=function(t,e){var n=this;return this.Gr.Ur(t,e).next((function(t){var e=t.Qr;return t.Kr.forEach((function(t,e){n.zr.set(t,e)})),e}))},yh);function yh(t,e){var n=this;return(n=lh.call(this)||this).Gr=t,n.Wr=e,n.zr=new Uc((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),n}function vh(t,e){this.Kt=t,this.Ti=e}function gh(t){return uc(t,Xa.store)}function mh(t){return uc(t,Wa.store)}function wh(t){return t.path.rt()}var bh=(Ih.prototype.Yn=function(t,e,n,r){var i=this;Or(n<r&&0<=n&&r<=11);var o=new ga("createOrUpgrade",e);n<1&&1<=r&&(t.createObjectStore(qa.store),(s=t).createObjectStore(Ha.store,{keyPath:Ha.keyPath}),s.createObjectStore(Ba.store,{keyPath:Ba.keyPath,autoIncrement:!0}).createIndex(Ba.userMutationsIndex,Ba.userMutationsKeyPath,{unique:!0}),s.createObjectStore(Ga.store),_h(t),t.createObjectStore(Wa.store));var s,u=va.resolve();return n<3&&3<=r&&(0!==n&&((s=t).deleteObjectStore(Qa.store),s.deleteObjectStore(Ya.store),s.deleteObjectStore($a.store),_h(t)),u=u.next((function(){return t=o.store($a.store),e=new $a(0,0,yi.min().G(),0),t.put($a.key,e);var t,e}))),n<4&&4<=r&&(0!==n&&(u=u.next((function(){return e=t,(n=o).store(Ba.store).os().next((function(t){e.deleteObjectStore(Ba.store),e.createObjectStore(Ba.store,{keyPath:Ba.keyPath,autoIncrement:!0}).createIndex(Ba.userMutationsIndex,Ba.userMutationsKeyPath,{unique:!0});var r=n.store(Ba.store);return t=t.map((function(t){return r.put(t)})),va.$n(t)}));var e,n}))),u=u.next((function(){t.createObjectStore(tc.store,{keyPath:tc.keyPath})}))),n<5&&5<=r&&(u=u.next((function(){return i.Hr(o)}))),n<6&&6<=r&&(u=u.next((function(){return t.createObjectStore(Xa.store),i.Jr(o)}))),n<7&&7<=r&&(u=u.next((function(){return i.Yr(o)}))),n<8&&8<=r&&(u=u.next((function(){return i.Xr(t,o)}))),n<9&&9<=r&&(u=u.next((function(){var n;(n=t).objectStoreNames.contains("remoteDocumentChanges")&&n.deleteObjectStore("remoteDocumentChanges"),(n=e.objectStore(Wa.store)).createIndex(Wa.readTimeIndex,Wa.readTimeIndexPath,{unique:!1}),n.createIndex(Wa.collectionReadTimeIndex,Wa.collectionReadTimeIndexPath,{unique:!1})}))),n<10&&10<=r&&(u=u.next((function(){return i.Zr(o)}))),n<11&&11<=r&&(u=u.next((function(){t.createObjectStore(ec.store,{keyPath:ec.keyPath}),t.createObjectStore(nc.store,{keyPath:nc.keyPath})}))),u},Ih.prototype.Jr=function(t){var e=0;return t.store(Wa.store).ls((function(t,n){e+=Hc(n)})).next((function(){var n=new Xa(e);return t.store(Xa.store).put(Xa.key,n)}))},Ih.prototype.Hr=function(t){var e=this,n=t.store(Ha.store),r=t.store(Ba.store);return n.os().next((function(n){return va.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.os(Ba.userMutationsIndex,i).next((function(r){return va.forEach(r,(function(r){return Or(r.userId===n.userId),r=wc(e.Kt,r),Fc(t,n.userId,r).next((function(){}))}))}))}))}))},Ih.prototype.Yr=function(t){var e=t.store(Qa.store),n=t.store(Wa.store);return t.store($a.store).get($a.key).next((function(t){var r=[];return n.ls((function(n,i){var o=new vi(n);n=[0,Ma(o)],r.push(e.get(n).next((function(n){return n?va.resolve():e.put(new Qa(0,Ma(o),t.highestListenSequenceNumber))})))})).next((function(){return va.$n(r)}))}))},Ih.prototype.Xr=function(t,e){function n(t){if(i.add(t)){var e=t.et();return t=t.Z(),r.put({collectionId:e,parent:Ma(t)})}}t.createObjectStore(Za.store,{keyPath:Za.keyPath});var r=e.store(Za.store),i=new xc;return e.store(Wa.store).ls({hs:!0},(function(t,e){return n((t=new vi(t)).Z())})).next((function(){return e.store(Ga.store).ls({hs:!0},(function(t,e){t[0];var r=t[1];return n((t[2],r=ja(r)).Z())}))}))},Ih.prototype.Zr=function(t){var e=this,n=t.store(Ya.store);return n.ls((function(t,r){return r=bc(r),r=Ic(e.Kt,r),n.put(r)}))},Ih);function Ih(t){this.Kt=t}function _h(t){t.createObjectStore(Qa.store,{keyPath:Qa.keyPath}).createIndex(Qa.documentTargetsIndex,Qa.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Ya.store,{keyPath:Ya.keyPath}).createIndex(Ya.queryTargetsIndexName,Ya.queryTargetsKeyPath,{unique:!0}),t.createObjectStore($a.store)}var Eh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Th=(Nh.prototype.start=function(){var t=this;return this.Io().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new qr(jr.FAILED_PRECONDITION,Eh);return t.mo(),t.Ao(),t.Ro(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.fo.ji(e)}))})).then((function(e){t.io=new si(e,t.no)})).then((function(){t.ro=!0})).catch((function(e){return t._o&&t._o.close(),Promise.reject(e)}))},Nh.prototype.Po=function(t){var e=this;return this.ho=function(n){return d(e,void 0,void 0,(function(){return y(this,(function(e){return this.Tr?[2,t(n)]:[2]}))}))},t(this.isPrimary)},Nh.prototype.yo=function(t){var e=this;this._o.Zn((function(n){return d(e,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},Nh.prototype.Vo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.eo.ys((function(){return d(e,void 0,void 0,(function(){return y(this,(function(t){switch(t.label){case 0:return this.Tr?[4,this.Io()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},Nh.prototype.Io=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return Ah(e).put(new tc(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.po(e).next((function(e){e||(t.isPrimary=!1,t.eo.bo((function(){return t.ho(!1)})))}))})).next((function(){return t.vo(e)})).next((function(n){return t.isPrimary&&!n?t.So(e).next((function(){return!1})):!!n&&t.Do(e).next((function(){return!0}))}))})).catch((function(e){if(Sa(e))return Nr("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return Nr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.eo.bo((function(){return t.ho(e)})),t.isPrimary=e}))},Nh.prototype.po=function(t){var e=this;return Sh(t).get(qa.key).next((function(t){return va.resolve(e.Co(t))}))},Nh.prototype.xo=function(t){return Ah(t).delete(this.clientId)},Nh.prototype.No=function(){return d(this,void 0,void 0,(function(){var t,e,n,r,i=this;return y(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.Oo(this.uo,18e5)?[3,2]:(this.uo=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=uc(t,tc.store);return e.os().next((function(t){var n=i.Fo(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return va.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=o.sent(),this.To)for(e=0,n=t;e<n.length;e++)r=n[e],this.To.removeItem(this.ko(r.clientId));o.label=2;case 2:return[2]}}))}))},Nh.prototype.Ro=function(){var t=this;this.ao=this.eo.Ir("client_metadata_refresh",4e3,(function(){return t.Io().then((function(){return t.No()})).then((function(){return t.Ro()}))}))},Nh.prototype.Co=function(t){return!!t&&t.ownerId===this.clientId},Nh.prototype.vo=function(t){var e=this;return this.so?va.resolve(!0):Sh(t).get(qa.key).next((function(n){if(null!==n&&e.Oo(n.leaseTimestampMs,5e3)&&!e.Mo(n.ownerId)){if(e.Co(n)&&e.networkEnabled)return!0;if(!e.Co(n)){if(!n.allowTabSynchronization)throw new qr(jr.FAILED_PRECONDITION,Eh);return!1}}return!(!e.networkEnabled||!e.inForeground)||Ah(t).os().next((function(t){return void 0===e.Fo(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground;if(t=e.networkEnabled===t.networkEnabled,n||r&&t)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&Nr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},Nh.prototype.Lo=function(){return d(this,void 0,void 0,(function(){var t=this;return y(this,(function(e){switch(e.label){case 0:return this.ro=!1,this.$o(),this.ao&&(this.ao.cancel(),this.ao=null),this.Bo(),this.qo(),[4,this._o.runTransaction("shutdown","readwrite",[qa.store,tc.store],(function(e){var n=new oc(e,si.U);return t.So(n).next((function(){return t.xo(n)}))}))];case 1:return e.sent(),this._o.close(),this.Uo(),[2]}}))}))},Nh.prototype.Fo=function(t,e){var n=this;return t.filter((function(t){return n.Oo(t.updateTimeMs,e)&&!n.Mo(t.clientId)}))},Nh.prototype.Qo=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return Ah(e).os().next((function(e){return t.Fo(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(Nh.prototype,"Tr",{get:function(){return this.ro},enumerable:!1,configurable:!0}),Nh.prototype.Ko=function(t){return Bc.Ai(t,this.Kt,this.Ti,this.Ii)},Nh.prototype.Dr=function(){return this.fo},Nh.prototype.Fr=function(){return this.wo},Nh.prototype.jo=function(){return this.Ti},Nh.prototype.Wo=function(){return this.Eo},Nh.prototype.runTransaction=function(t,e,n){var r=this;Nr("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this._o.runTransaction(t,o,ic,(function(o){return i=new oc(o,r.io?r.io.next():si.U),"readwrite-primary"===e?r.po(i).next((function(t){return!!t||r.vo(i)})).next((function(e){if(!e)throw Sr("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.eo.bo((function(){return r.ho(!1)})),new qr(jr.FAILED_PRECONDITION,Ra);return n(i)})).next((function(t){return r.Do(i).next((function(){return t}))})):r.Go(i).next((function(){return n(i)}))})).then((function(t){return i.ps(),t}))},Nh.prototype.Go=function(t){var e=this;return Sh(t).get(qa.key).next((function(t){if(null!==t&&e.Oo(t.leaseTimestampMs,5e3)&&!e.Mo(t.ownerId)&&!e.Co(t)&&!(e.so||e.allowTabSynchronization&&t.allowTabSynchronization))throw new qr(jr.FAILED_PRECONDITION,Eh)}))},Nh.prototype.Do=function(t){var e=new qa(this.clientId,this.allowTabSynchronization,Date.now());return Sh(t).put(qa.key,e)},Nh.jn=function(){return ma.jn()},Nh.prototype.So=function(t){var e=this,n=Sh(t);return n.get(qa.key).next((function(t){return e.Co(t)?(Nr("IndexedDbPersistence","Releasing primary lease."),n.delete(qa.key)):va.resolve()}))},Nh.prototype.Oo=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Sr("Detected an update time that is in the future: "+t+" > "+n),1))},Nh.prototype.mo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.co=function(){t.eo.ys((function(){return t.inForeground="visible"===t.document.visibilityState,t.Io()}))},this.document.addEventListener("visibilitychange",this.co),this.inForeground="visible"===this.document.visibilityState)},Nh.prototype.Bo=function(){this.co&&(this.document.removeEventListener("visibilitychange",this.co),this.co=null)},Nh.prototype.Ao=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.oo=function(){e.$o(),e.eo.ys((function(){return e.Lo()}))},this.window.addEventListener("unload",this.oo))},Nh.prototype.qo=function(){this.oo&&(this.window.removeEventListener("unload",this.oo),this.oo=null)},Nh.prototype.Mo=function(t){try{var e=null!==(null===(e=this.To)||void 0===e?void 0:e.getItem(this.ko(t)));return Nr("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Sr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Nh.prototype.$o=function(){if(this.To)try{this.To.setItem(this.ko(this.clientId),String(Date.now()))}catch(t){Sr("Failed to set zombie client id.",t)}},Nh.prototype.Uo=function(){if(this.To)try{this.To.removeItem(this.ko(this.clientId))}catch(t){}},Nh.prototype.ko=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Nh);function Nh(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.eo=i,this.window=o,this.document=s,this.no=a,this.so=c,this.io=null,this.ro=!1,this.isPrimary=!1,this.networkEnabled=!0,this.oo=null,this.inForeground=!1,this.co=null,this.ao=null,this.uo=Number.NEGATIVE_INFINITY,this.ho=function(t){return Promise.resolve()},!Nh.jn())throw new qr(jr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Ii=new sh(this,r),this.lo=e+"main",this.Kt=new hc(u),this._o=new ma(this.lo,11,new bh(this.Kt)),this.fo=new Yc(this.Ii,this.Kt),this.Ti=new Dc,this.wo=(e=this.Kt,u=this.Ti,new ph(e,u)),this.Eo=new Ec,this.window&&this.window.localStorage?this.To=this.window.localStorage:(this.To=null,!1===c&&Sr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function Sh(t){return uc(t,qa.store)}function Ah(t){return uc(t,tc.store)}function xh(t,e){var n=t.projectId;return t.m||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}function Dh(t,e){this.progress=t,this.zo=e}var Oh=(Mh.prototype.Jo=function(t,e){var n=this;return this.Ho.vi(t,e).next((function(r){return n.Yo(t,e,r)}))},Mh.prototype.Yo=function(t,e,n){return this.wo.fi(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].xs(e,t);return t}))},Mh.prototype.Xo=function(t,e,n){var r=du;return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].xs(t,e);r=r.Ht(t,e)})),r},Mh.prototype.Zo=function(t,e){var n=this;return this.wo.getEntries(t,e).next((function(e){return n.tc(t,e)}))},Mh.prototype.tc=function(t,e){var n=this;return this.Ho.Si(t,e).next((function(r){r=n.Xo(t,e,r);var i=du;return r.forEach((function(t,e){e=e||new so(t,yi.min()),i=i.Ht(t,e)})),i}))},Mh.prototype.jr=function(t,e,n){return r=e,wi.Et(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ec(t,e.path):ts(e)?this.nc(t,e,n):this.sc(t,e,n);var r},Mh.prototype.ec=function(t,e){return this.Jo(t,new wi(e)).next((function(t){var e=gu;return t instanceof oo&&(e=e.Ht(t.key,t)),e}))},Mh.prototype.nc=function(t,e,n){var r=this,i=e.collectionGroup,o=gu;return this.Ti.Qs(t,i).next((function(s){return va.forEach(s,(function(s){var u=(u=e,s=s.child(i),new Jo(s,null,u.Nt.slice(),u.filters.slice(),u.limit,u.limitType,u.startAt,u.endAt));return r.sc(t,u,n).next((function(t){t.forEach((function(t,e){o=o.Ht(t,e)}))}))})).next((function(){return o}))}))},Mh.prototype.sc=function(t,e,n){var r,i,o=this;return this.wo.jr(t,e,n).next((function(n){return r=n,o.Ho.Ci(t,e)})).next((function(e){return i=e,o.ic(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=(c=u[s]).key,c=Vs(c,r.get(a),0,o.Ss);r=c instanceof oo?r.Ht(a,c):r.remove(a)}}))})).next((function(){return r.forEach((function(t,n){us(e,n)||(r=r.remove(t))})),r}))},Mh.prototype.ic=function(t,e,n){for(var r=bu(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Hs&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.wo.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof oo&&(c=c.Ht(t,e))})),c}))},Mh),kh=(Vh.cc=function(t,e){for(var n=bu(),r=bu(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Vh(t,e.fromCache,n,r)},Vh),Ph=(Rh.prototype.ac=function(t){this.uc=t},Rh.prototype.jr=function(t,e,n,i){var o=this;return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.Nt.length||1===e.Nt.length&&e.Nt[0].field.ht())||n.isEqual(yi.min())?this.hc(t,e):this.uc.Zo(t,i).next((function(s){var u=o.lc(e,s);return(Yo(e)||Qo(e))&&o._c(e.limitType,u,i,n)?o.hc(t,e):(Tr()<=r.DEBUG&&Nr("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),ss(e)),o.uc.jr(t,e,n).next((function(t){return u.forEach((function(e){t=t.Ht(e.key,e)})),t})))}))},Rh.prototype.lc=function(t,e){var n=new lu(as(t));return e.forEach((function(e,r){r instanceof oo&&us(t,r)&&(n=n.add(r))})),n},Rh.prototype._c=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.u(r))},Rh.prototype.hc=function(t,e){return Tr()<=r.DEBUG&&Nr("QueryEngine","Using full collection scan to execute query:",ss(e)),this.uc.jr(t,e,yi.min())},Rh),Lh=(Ch.prototype.mr=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.pr(n,e.dc)}))},Ch);function Ch(t,e,n,r){this.persistence=t,this.fc=e,this.Kt=r,this.dc=new ou(Lr),this.wc=new Uc(po,yo),this.Ec=yi.min(),this.Ho=t.Ko(n),this.Tc=t.Fr(),this.fo=t.Dr(),this.Ic=new Oh(this.Tc,this.Ho,this.persistence.jo()),this.Eo=t.Wo(),this.fc.ac(this.Ic)}function Rh(){}function Vh(t,e,n,r){this.targetId=t,this.fromCache=e,this.rc=n,this.oc=r}function Mh(t,e,n){this.wo=t,this.Ho=e,this.Ti=n}function Uh(t,e,n,r){return new Lh(t,e,n,r)}function jh(t,e){return d(this,void 0,void 0,(function(){var n,r,i,o;return y(this,(function(s){switch(s.label){case 0:return r=(n=t).Ho,i=n.Ic,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n.Ho.bi(t).next((function(s){return o=s,r=n.persistence.Ko(e),i=new Oh(n.Tc,r,n.persistence.jo()),r.bi(t)})).next((function(e){for(var n=[],r=[],s=bu(),u=0,a=o;u<a.length;u++){var c=a[u];n.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++){var l=f[h];s=s.add(l.key)}}for(var p=0,d=e;p<d.length;p++){var y=d[p];r.push(y.batchId);for(var v=0,g=y.mutations;v<g.length;v++){var m=g[v];s=s.add(m.key)}}return i.Zo(t,s).next((function(t){return{mc:t,Ac:n,Rc:r}}))}))}))];case 1:return o=s.sent(),[2,(n.Ho=r,n.Ic=i,n.fc.ac(n.Ic),o)]}}))}))}function qh(t,e){var n=t;return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r,i,o,s,u,a,c,h=e.batch.keys(),f=n.Tc.Or({Wr:!0});return r=n,i=t,s=f,a=(u=(o=e).batch).keys(),c=va.resolve(),a.forEach((function(t){c=c.next((function(){return s.fi(i,t)})).next((function(e){var n=e;Or(null!==(e=o.Fs.get(t))),(!n||n.version.u(e)<0)&&(n=u.Ds(t,n,o))&&s.ui(n,o.Os)}))})),c.next((function(){return r.Ho.xi(i,u)})).next((function(){return f.apply(t)})).next((function(){return n.Ho.Fi(t)})).next((function(){return n.Ic.Zo(t,h)}))}))}function Fh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.fo.Ki(t)}))}function Hh(t,e){var n=t,r=e.Mt,i=n.dc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.Tc.Or({Wr:!0});i=n.dc;var s=[];e.Fe.forEach((function(e,o){var u,a,c,h=i.get(o);h&&(s.push(n.fo.ir(t,e.Ke,o).next((function(){return n.fo.nr(t,e.Ue,o)}))),0<(c=e.resumeToken).o()&&(u=h.$t(c,r).Lt(t.vs),i=i.Ht(o,u),a=h,c=e,Or(0<(h=u).resumeToken.o()),(0===a.resumeToken.o()||3e8<=h.Mt.W()-a.Mt.W()||0<c.Ue.size+c.Qe.size+c.Ke.size)&&s.push(n.fo.Ji(t,u))))}));var u,a=du;return e.Me.forEach((function(r,i){e.Le.has(r)&&s.push(n.persistence.Ii.kr(t,r))})),s.push(Bh(t,o,e.Me,r,void 0).next((function(t){a=t}))),r.isEqual(yi.min())||(u=n.fo.Ki(t).next((function(e){return n.fo.Wi(t,t.vs,r)})),s.push(u)),va.$n(s).next((function(){return o.apply(t)})).next((function(){return n.Ic.tc(t,a)}))})).then((function(t){return n.dc=i,t}))}function Bh(t,e,n,r,i){var o=bu();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=du;return n.forEach((function(n,s){var u=t.get(n),a=(null==i?void 0:i.get(n))||r;s instanceof so&&s.version.isEqual(yi.min())?(e._i(n,a),o=o.Ht(n,s)):null==u||0<s.version.u(u.version)||0===s.version.u(u.version)&&u.hasPendingWrites?(e.ui(s,a),o=o.Ht(n,s)):Nr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",u.version," Watch version:",s.version)})),o}))}function Gh(t,e){var n=t;return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.fo.er(t,e).next((function(i){return i?(r=i,va.resolve(r)):n.fo.qi(t).next((function(i){return r=new cs(e,i,0,t.vs),n.fo.Gi(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.dc.get(t.targetId);return(null===r||0<t.Mt.u(r.Mt))&&(n.dc=n.dc.Ht(t.targetId,t),n.wc.set(e,t.targetId)),t}))}function zh(t,e,n){return d(this,void 0,void 0,(function(){var r,i,o;return y(this,(function(s){switch(s.label){case 0:i=(r=t).dc.get(e),o=n?"readwrite":"readwrite-primary",s.label=1;case 1:return s.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.Ii.removeTarget(t,i)}))];case 2:s.sent(),s.label=3;case 3:return[3,5];case 4:if(!Sa(o=s.sent()))throw o;return Nr("LocalStore","Failed to update sequence numbers for target "+e+": "+o),[3,5];case 5:return r.dc=r.dc.remove(e),r.wc.delete(i.target),[2]}}))}))}function Kh(t,e,n){var r=t,i=yi.min(),o=bu();return r.persistence.runTransaction("Execute query","readonly",(function(t){return s=r,u=t,a=ns(e),(void 0!==(s=(c=s).wc.get(a))?va.resolve(c.dc.get(s)):c.fo.er(u,a)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.fo.cr(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.fc.jr(t,e,n?i:yi.min(),n?o:bu())})).next((function(t){return{documents:t,Pc:o}}));var s,u,a,c}))}function Jh(t,e){var n=t,r=n.fo;return(t=n.dc.get(e))?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.Dn(t,e).next((function(t){return t?t.target:null}))}))}function Wh(t){var e=t;return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return n=e.Tc,r=t,t=e.Ec,i=n,o=du,s=yc(t),t=mh(r),r=IDBKeyRange.lowerBound(s,!0),t.ls({index:Wa.readTimeIndex,range:r},(function(t,e){var n=pc(i.Kt,e);o=o.Ht(n.key,n),s=e.readTime})).next((function(){return{zo:o,readTime:vc(s)}}));var n,r,i,o,s})).then((function(t){var n=t.zo;return t=t.readTime,e.Ec=t,n}))}function Xh(t){return d(this,void 0,void 0,(function(){var e;return y(this,(function(n){return[2,(e=t).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return t=mh(t),e=yi.min(),t.ls({index:Wa.readTimeIndex,reverse:!0},(function(t,n,r){n.readTime&&(e=vc(n.readTime)),r.done()})).next((function(){return e}));var e})).then((function(t){e.Ec=t}))]}))}))}var Yh,Qh,$h=(mf.prototype.Ms=function(t,e){return va.resolve(this.bc.get(e))},mf.prototype.Ls=function(t,e){return this.bc.set(e.id,{id:e.id,version:e.version,createTime:Ku(e.createTime)}),va.resolve()},mf.prototype.$s=function(t,e){return va.resolve(this.vc.get(e))},mf.prototype.Bs=function(t,e){return this.vc.set(e.name,{name:(e=e).name,query:_c(e.bundledQuery),readTime:Ku(e.readTime)}),va.resolve()},mf),Zh=(gf.prototype.nt=function(){return this.Sc.nt()},gf.prototype.sr=function(t,e){e=new tf(t,e),this.Sc=this.Sc.add(e),this.Cc=this.Cc.add(e)},gf.prototype.Nc=function(t,e){var n=this;t.forEach((function(t){return n.sr(t,e)}))},gf.prototype.rr=function(t,e){this.Oc(new tf(t,e))},gf.prototype.Fc=function(t,e){var n=this;t.forEach((function(t){return n.rr(t,e)}))},gf.prototype.kc=function(t){var e=this,n=new wi(new vi([])),r=new tf(n,t),i=(t=new tf(n,t+1),[]);return this.Cc.Ae([r,t],(function(t){e.Oc(t),i.push(t.key)})),i},gf.prototype.Mc=function(){var t=this;this.Sc.forEach((function(e){return t.Oc(e)}))},gf.prototype.Oc=function(t){this.Sc=this.Sc.delete(t),this.Cc=this.Cc.delete(t)},gf.prototype.Lc=function(t){var e=new wi(new vi([])),n=new tf(e,t),r=(t=new tf(e,t+1),bu());return this.Cc.Ae([n,t],(function(t){r=r.add(t.key)})),r},gf.prototype.ki=function(t){var e=new tf(t,0);return null!==(e=this.Sc.Pe(e))&&t.isEqual(e.key)},gf),tf=(vf.Dc=function(t,e){return wi.J(t.key,e.key)||Lr(t.$c,e.$c)},vf.xc=function(t,e){return Lr(t.$c,e.$c)||wi.J(t.key,e.key)},vf),ef=(yf.prototype.Ri=function(t){return va.resolve(0===this.Ho.length)},yf.prototype.Pi=function(t,e,n,r){var i=this.Bc;this.Bc++,0<this.Ho.length&&this.Ho[this.Ho.length-1],n=new ac(i,e,n,r),this.Ho.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.qc=this.qc.add(new tf(u.key,i)),this.Ti.Us(t,u.key.path.Z())}return va.resolve(n)},yf.prototype.yi=function(t,e){return va.resolve(this.Uc(e))},yf.prototype.Vi=function(t,e){return e+=1,e=(e=this.Qc(e))<0?0:e,va.resolve(this.Ho.length>e?this.Ho[e]:null)},yf.prototype.pi=function(){return va.resolve(0===this.Ho.length?-1:this.Bc-1)},yf.prototype.bi=function(t){return va.resolve(this.Ho.slice())},yf.prototype.vi=function(t,e){var n=this,r=new tf(e,0),i=(e=new tf(e,Number.POSITIVE_INFINITY),[]);return this.qc.Ae([r,e],(function(t){t=n.Uc(t.$c),i.push(t)})),va.resolve(i)},yf.prototype.Si=function(t,e){var n=this,r=new lu(Lr);return e.forEach((function(t){var e=new tf(t,0);t=new tf(t,Number.POSITIVE_INFINITY),n.qc.Ae([e,t],(function(t){r=r.add(t.$c)}))})),va.resolve(this.Kc(r))},yf.prototype.Ci=function(t,e){var n=e.path,r=n.length+1;e=n,wi.Et(e)||(e=e.child("")),e=new tf(new wi(e),0);var i=new lu(Lr);return this.qc.Re((function(t){var e=t.key.path;return!!n.st(e)&&(e.length===r&&(i=i.add(t.$c)),!0)}),e),va.resolve(this.Kc(i))},yf.prototype.Kc=function(t){var e=this,n=[];return t.forEach((function(t){null!==(t=e.Uc(t))&&n.push(t)})),n},yf.prototype.xi=function(t,e){var n=this;Or(0===this.jc(e.batchId,"removed")),this.Ho.shift();var r=this.qc;return va.forEach(e.mutations,(function(i){var o=new tf(i.key,e.batchId);return r=r.delete(o),n.Ii.Oi(t,i.key)})).next((function(){n.qc=r}))},yf.prototype.Ni=function(t){},yf.prototype.ki=function(t,e){var n=new tf(e,0);return n=this.qc.Pe(n),va.resolve(e.isEqual(n&&n.key))},yf.prototype.Fi=function(t){return this.Ho.length,va.resolve()},yf.prototype.jc=function(t,e){return this.Qc(t)},yf.prototype.Qc=function(t){return 0===this.Ho.length?0:t-this.Ho[0].batchId},yf.prototype.Uc=function(t){return(t=this.Qc(t))<0||t>=this.Ho.length?null:this.Ho[t]},yf),nf=(df.prototype.ui=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.Wc(e);return this.docs=this.docs.Ht(r,{li:e,size:o,readTime:n}),this.size+=o-i,this.Ti.Us(t,r.path.Z())},df.prototype._i=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},df.prototype.fi=function(t,e){return e=this.docs.get(e),va.resolve(e?e.li:null)},df.prototype.getEntries=function(t,e){var n=this,r=du;return e.forEach((function(t){var e=n.docs.get(t);r=r.Ht(t,e?e.li:null)})),va.resolve(r)},df.prototype.jr=function(t,e,n){for(var r=gu,i=new wi(e.path.child("")),o=this.docs.ne(i);o.ae();){var s=(u=o.ce()).key,u=(a=u.value).li,a=a.readTime;if(!e.path.st(s.path))break;a.u(n)<=0||u instanceof oo&&us(e,u)&&(r=r.Ht(u.key,u))}return va.resolve(r)},df.prototype.Gc=function(t,e){return va.forEach(this.docs,(function(t){return e(t)}))},df.prototype.Or=function(t){return new rf(this)},df.prototype.Mr=function(t){return va.resolve(this.size)},df),rf=(p(pf,Qh=Ne),pf.prototype.Ei=function(t){var e=this,n=[];return this.oi.forEach((function(r,i){i&&i.li?n.push(e.Gr.ui(t,i.li,e.ai(r))):e.Gr._i(r)})),va.$n(n)},pf.prototype.di=function(t,e){return this.Gr.fi(t,e)},pf.prototype.wi=function(t,e){return this.Gr.getEntries(t,e)},pf),of=(lf.prototype.mn=function(t,e){return this.zc.forEach((function(t,n){return e(n)})),va.resolve()},lf.prototype.Ki=function(t){return va.resolve(this.lastRemoteSnapshotVersion)},lf.prototype.ji=function(t){return va.resolve(this.Hc)},lf.prototype.qi=function(t){return this.highestTargetId=this.Yc.next(),va.resolve(this.highestTargetId)},lf.prototype.Wi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Hc&&(this.Hc=e),va.resolve()},lf.prototype.zi=function(t){this.zc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Yc=new Xc(e),this.highestTargetId=e),t.sequenceNumber>this.Hc&&(this.Hc=t.sequenceNumber)},lf.prototype.Gi=function(t,e){return this.zi(e),this.targetCount+=1,va.resolve()},lf.prototype.Ji=function(t,e){return this.zi(e),va.resolve()},lf.prototype.Yi=function(t,e){return this.zc.delete(e.target),this.Jc.kc(e.targetId),--this.targetCount,va.resolve()},lf.prototype.Zi=function(t,e,n){var r=this,i=0,o=[];return this.zc.forEach((function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.zc.delete(s),o.push(r.Xi(t,u.targetId)),i++)})),va.$n(o).next((function(){return i}))},lf.prototype.tr=function(t){return va.resolve(this.targetCount)},lf.prototype.er=function(t,e){return e=this.zc.get(e)||null,va.resolve(e)},lf.prototype.nr=function(t,e,n){return this.Jc.Nc(e,n),va.resolve()},lf.prototype.ir=function(t,e,n){this.Jc.Fc(e,n);var r=this.persistence.Ii,i=[];return r&&e.forEach((function(e){i.push(r.Oi(t,e))})),va.$n(i)},lf.prototype.Xi=function(t,e){return this.Jc.kc(e),va.resolve()},lf.prototype.cr=function(t,e){return e=this.Jc.Lc(e),va.resolve(e)},lf.prototype.ki=function(t,e){return va.resolve(this.Jc.ki(e))},lf),sf=(ff.prototype.start=function(){return Promise.resolve()},ff.prototype.Lo=function(){return this.ro=!1,Promise.resolve()},Object.defineProperty(ff.prototype,"Tr",{get:function(){return this.ro},enumerable:!1,configurable:!0}),ff.prototype.yo=function(){},ff.prototype.Vo=function(){},ff.prototype.jo=function(){return this.Ti},ff.prototype.Ko=function(t){var e=this.Xc[t.R()];return e||(e=new ef(this.Ti,this.Ii),this.Xc[t.R()]=e),e},ff.prototype.Dr=function(){return this.fo},ff.prototype.Fr=function(){return this.wo},ff.prototype.Wo=function(){return this.Eo},ff.prototype.runTransaction=function(t,e,n){var r=this;Nr("MemoryPersistence","Starting transaction:",t);var i=new uf(this.io.next());return this.Ii.ta(),n(i).next((function(t){return r.Ii.ea(i).next((function(){return t}))})).Mn().then((function(t){return i.ps(),t}))},ff.prototype.na=function(t,e){return va.Bn(Object.values(this.Xc).map((function(n){return function(){return n.ki(t,e)}})))},ff),uf=(p(hf,Yh=h),hf),af=(cf.ra=function(t){return new cf(t)},Object.defineProperty(cf.prototype,"oa",{get:function(){if(this.ia)return this.ia;throw Dr()},enumerable:!1,configurable:!0}),cf.prototype.sr=function(t,e,n){return this.sa.sr(n,e),this.oa.delete(n.toString()),va.resolve()},cf.prototype.rr=function(t,e,n){return this.sa.rr(n,e),this.oa.add(n.toString()),va.resolve()},cf.prototype.Oi=function(t,e){return this.oa.add(e.toString()),va.resolve()},cf.prototype.removeTarget=function(t,e){var n=this;this.sa.kc(e.targetId).forEach((function(t){return n.oa.add(t.toString())}));var r=this.persistence.Dr();return r.cr(t,e.targetId).next((function(t){t.forEach((function(t){return n.oa.add(t.toString())}))})).next((function(){return r.Yi(t,e)}))},cf.prototype.ta=function(){this.ia=new Set},cf.prototype.ea=function(t){var e=this,n=this.persistence.Fr().Or();return va.forEach(this.oa,(function(r){var i=wi.ft(r);return e.ca(t,i).next((function(t){t||n._i(i)}))})).next((function(){return e.ia=null,n.apply(t)}))},cf.prototype.kr=function(t,e){var n=this;return this.ca(t,e).next((function(t){t?n.oa.delete(e.toString()):n.oa.add(e.toString())}))},cf.prototype.Zc=function(t){return 0},cf.prototype.ca=function(t,e){var n=this;return va.Bn([function(){return va.resolve(n.sa.ki(e))},function(){return n.persistence.Dr().ki(t,e)},function(){return n.persistence.na(t,e)}])},cf);function cf(t){this.persistence=t,this.sa=new Zh,this.ia=null}function hf(t){var e=this;return(e=Yh.call(this)||this).vs=t,e}function ff(t,e){var n=this;this.Xc={},this.io=new si(0),this.ro=!1,this.ro=!0,this.Ii=t(this),this.fo=new of(this),this.Ti=new Ac,this.wo=(t=this.Ti,new nf(t,(function(t){return n.Ii.Zc(t)}))),this.Kt=new hc(e),this.Eo=new $h(this.Kt)}function lf(t){this.persistence=t,this.zc=new Uc(po,yo),this.lastRemoteSnapshotVersion=yi.min(),this.highestTargetId=0,this.Hc=0,this.Jc=new Zh,this.targetCount=0,this.Yc=Xc.$i()}function pf(t){var e=this;return(e=Qh.call(this)||this).Gr=t,e}function df(t,e){this.Ti=t,this.Wc=e,this.docs=new ou(wi.J),this.size=0}function yf(t,e){this.Ti=t,this.Ii=e,this.Ho=[],this.Bc=1,this.qc=new lu(tf.Dc)}function vf(t,e){this.key=t,this.$c=e}function gf(){this.Sc=new lu(tf.Dc),this.Cc=new lu(tf.xc)}function mf(t){this.Kt=t,this.bc=new Map,this.vc=new Map}function wf(t,e){return"firestore_clients_"+t+"_"+e}function bf(t,e,n){return n="firestore_mutations_"+t+"_"+n,e.A()&&(n+="_"+e.uid),n}function If(t,e){return"firestore_targets_"+t+"_"+e}var _f,Ef=(Kf.aa=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new qr(r.error.code,r.error.message)),i?new Kf(t,e,r.state,o):(Sr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},Kf.prototype.ua=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Kf),Tf=(zf.aa=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new qr(n.error.code,n.error.message)),r?new zf(t,n.state,i):(Sr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},zf.prototype.ua=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},zf),Nf=(Gf.aa=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Iu,o=0;r&&o<n.activeTargetIds.length;++o)r=ji(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new Gf(t,i):(Sr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},Gf),Sf=(Bf.aa=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Bf(e.clientId,e.onlineState):(Sr("SharedClientState","Failed to parse online state: "+t),null)},Bf),Af=(Hf.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Hf.prototype.la=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Hf.prototype.ua=function(){var t={activeTargetIds:this.activeTargetIds.rt(),updateTimeMs:Date.now()};return JSON.stringify(t)},Hf),xf=(Ff.jn=function(t){return!(!t||!t.localStorage)},Ff.prototype.start=function(){return d(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,u,a,c,h=this;return y(this,(function(f){switch(f.label){case 0:return[4,this.fa.Qo()];case 1:for(o=f.sent(),t=0,e=o;t<e.length;t++)(n=e[t])!==this._a&&(r=this.getItem(wf(this.persistenceKey,n)))&&(i=Nf.aa(n,r))&&(this.Ta=this.Ta.Ht(i.clientId,i));for(this.pa(),(o=this.storage.getItem(this.ga))&&(s=this.ba(o))&&this.va(s),u=0,a=this.Ia;u<a.length;u++)c=a[u],this.Ea(c);return this.Ia=[],this.window.addEventListener("unload",(function(){return h.Lo()})),this.Tr=!0,[2]}}))}))},Ff.prototype.q=function(t){this.setItem(this.Aa,JSON.stringify(t))},Ff.prototype.Sa=function(){return this.Da(this.Ta)},Ff.prototype.Ca=function(t){var e=!1;return this.Ta.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},Ff.prototype.xa=function(t){this.Na(t,"pending")},Ff.prototype.Oa=function(t,e,n){this.Na(t,e,n),this.Fa(t)},Ff.prototype.ka=function(t){var e,n="not-current";return this.Ca(t)&&(!(e=this.storage.getItem(If(this.persistenceKey,t)))||(e=Tf.aa(t,e))&&(n=e.state)),this.Ma.ha(t),this.pa(),n},Ff.prototype.La=function(t){this.Ma.la(t),this.pa()},Ff.prototype.$a=function(t){return this.Ma.activeTargetIds.has(t)},Ff.prototype.Ba=function(t){this.removeItem(If(this.persistenceKey,t))},Ff.prototype.qa=function(t,e,n){this.Ua(t,e,n)},Ff.prototype.Qa=function(t,e,n){var r=this;e.forEach((function(t){r.Fa(t)})),this.currentUser=t,n.forEach((function(t){r.xa(t)}))},Ff.prototype.Ka=function(t){this.ja(t)},Ff.prototype.Wa=function(){this.Ga()},Ff.prototype.Lo=function(){this.Tr&&(this.window.removeEventListener("storage",this.wa),this.removeItem(this.ma),this.Tr=!1)},Ff.prototype.getItem=function(t){var e=this.storage.getItem(t);return Nr("SharedClientState","READ",t,e),e},Ff.prototype.setItem=function(t,e){Nr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},Ff.prototype.removeItem=function(t){Nr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},Ff.prototype.Ea=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(Nr("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ma)return void Sr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.eo.bo((function(){return d(e,void 0,void 0,(function(){var t,e,r,i;return y(this,(function(o){if(this.Tr){if(null!==n.key)if(this.Ra.test(n.key)){if(null==n.newValue)return t=this.za(n.key),[2,this.Ha(t,null)];if(t=this.Ja(n.key,n.newValue))return[2,this.Ha(t.clientId,t)]}else if(this.Pa.test(n.key)){if(null!==n.newValue&&(e=this.Ya(n.key,n.newValue)))return[2,this.Xa(e)]}else if(this.ya.test(n.key)){if(null!==n.newValue&&(r=this.Za(n.key,n.newValue)))return[2,this.tu(r)]}else if(n.key===this.ga){if(null!==n.newValue&&(i=this.ba(n.newValue)))return[2,this.va(i)]}else if(n.key===this.Aa)(i=function(t){var e=si.U;if(null!=t)try{var n=JSON.parse(t);Or("number"==typeof n),e=n}catch(t){Sr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==si.U&&this.L(i);else if(n.key===this.Va)return[2,this.fa.eu()]}else this.Ia.push(n);return[2]}))}))}))}},Object.defineProperty(Ff.prototype,"Ma",{get:function(){return this.Ta.get(this._a)},enumerable:!1,configurable:!0}),Ff.prototype.pa=function(){this.setItem(this.ma,this.Ma.ua())},Ff.prototype.Na=function(t,e,n){n=new Ef(this.currentUser,t,e,n),t=bf(this.persistenceKey,this.currentUser,t),this.setItem(t,n.ua())},Ff.prototype.Fa=function(t){t=bf(this.persistenceKey,this.currentUser,t),this.removeItem(t)},Ff.prototype.ja=function(t){t={clientId:this._a,onlineState:t},this.storage.setItem(this.ga,JSON.stringify(t))},Ff.prototype.Ua=function(t,e,n){var r=If(this.persistenceKey,t);n=new Tf(t,e,n),this.setItem(r,n.ua())},Ff.prototype.Ga=function(){this.setItem(this.Va,"value-not-used")},Ff.prototype.za=function(t){return(t=this.Ra.exec(t))?t[1]:null},Ff.prototype.Ja=function(t,e){return t=this.za(t),Nf.aa(t,e)},Ff.prototype.Ya=function(t,e){var n=this.Pa.exec(t);return t=Number(n[1]),n=void 0!==n[2]?n[2]:null,Ef.aa(new Qr(n),t,e)},Ff.prototype.Za=function(t,e){return t=this.ya.exec(t),t=Number(t[1]),Tf.aa(t,e)},Ff.prototype.ba=function(t){return Sf.aa(t)},Ff.prototype.Xa=function(t){return d(this,void 0,void 0,(function(){return y(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.fa.nu(t.batchId,t.state,t.error)]:(Nr("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},Ff.prototype.tu=function(t){return this.fa.su(t.targetId,t.state,t.error)},Ff.prototype.Ha=function(t,e){var n=this,r=e?this.Ta.Ht(t,e):this.Ta.remove(t),i=this.Da(this.Ta),o=this.Da(r),s=[],u=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||u.push(t)})),this.fa.iu(s,u).then((function(){n.Ta=r}))},Ff.prototype.va=function(t){this.Ta.get(t.clientId)&&this.da(t.onlineState)},Ff.prototype.Da=function(t){var e=Iu;return t.forEach((function(t,n){e=e.ye(n.activeTargetIds)})),e},Ff),Df=(qf.prototype.xa=function(t){},qf.prototype.Oa=function(t,e,n){},qf.prototype.ka=function(t){return this.ru.ha(t),this.ou[t]||"not-current"},qf.prototype.qa=function(t,e,n){this.ou[t]=e},qf.prototype.La=function(t){this.ru.la(t)},qf.prototype.$a=function(t){return this.ru.activeTargetIds.has(t)},qf.prototype.Ba=function(t){delete this.ou[t]},qf.prototype.Sa=function(){return this.ru.activeTargetIds},qf.prototype.Ca=function(t){return this.ru.activeTargetIds.has(t)},qf.prototype.start=function(){return this.ru=new Af,Promise.resolve()},qf.prototype.Qa=function(t,e,n){},qf.prototype.Ka=function(t){},qf.prototype.Lo=function(){},qf.prototype.q=function(t){},qf.prototype.Wa=function(){},qf),Of=(jf.prototype.cu=function(t){},jf.prototype.Lo=function(){},jf),kf=(Uf.prototype.cu=function(t){this._u.push(t)},Uf.prototype.Lo=function(){window.removeEventListener("online",this.au),window.removeEventListener("offline",this.hu)},Uf.prototype.fu=function(){window.addEventListener("online",this.au),window.addEventListener("offline",this.hu)},Uf.prototype.uu=function(){Nr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(0)},Uf.prototype.lu=function(){Nr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(1)},Uf.jn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Uf),Pf={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Lf=(Mf.prototype.Eu=function(t){this.Tu=t},Mf.prototype.Iu=function(t){this.mu=t},Mf.prototype.onMessage=function(t){this.Au=t},Mf.prototype.close=function(){this.wu()},Mf.prototype.send=function(t){this.du(t)},Mf.prototype.Ru=function(){this.Tu()},Mf.prototype.Pu=function(t){this.mu(t)},Mf.prototype.yu=function(t){this.Au(t)},Mf),Cf=(Vf.prototype.bu=function(t,e,n,r){var i=this.vu(t,e);return Nr("RestConnection","Sending: ",i,n),e={},this.Su(e,r),this.Du(t,i,e,n).then((function(t){return Nr("RestConnection","Received: ",t),t}),(function(e){throw Ar("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},Vf.prototype.Cu=function(t,e,n,r){return this.bu(t,e,n,r)},Vf.prototype.Su=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.2",t["Content-Type"]="text/plain",e)for(var n in e.V)e.V.hasOwnProperty(n)&&(t[n]=e.V[n])},Vf.prototype.vu=function(t,e){return t=Pf[t],this.Vu+"/v1/"+e+":"+t},p(Rf,_f=Vf),Rf.prototype.Du=function(t,e,n,r){return new Promise((function(i,o){var s=new _r;s.listenOnce(wr.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case mr.NO_ERROR:var e=s.getResponseJson();Nr("Connection","XHR received:",JSON.stringify(e)),i(e);break;case mr.TIMEOUT:Nr("Connection",'RPC "'+t+'" timed out'),o(new qr(jr.DEADLINE_EXCEEDED,"Request time out"));break;case mr.HTTP_ERROR:var n=s.getStatus();Nr("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),0<n?(e=s.getResponseJson().error)&&e.status&&e.message?(n=e.status.toLowerCase().replace(/_/g,"-"),n=0<=Object.values(jr).indexOf(n)?n:jr.UNKNOWN,o(new qr(n,e.message))):o(new qr(jr.UNKNOWN,"Server responded with status "+s.getStatus())):o(new qr(jr.UNAVAILABLE,"Connection failed."));break;default:Dr()}}finally{Nr("Connection",'RPC "'+t+'" completed.')}}));var u=JSON.stringify(r);s.send(e,"POST",u,n,15)}))},Rf.prototype.xu=function(t,e){var n,r=[this.Vu,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new lr,o=gr();t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.T.projectId+"/databases/"+this.T.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.I},this.Su(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(g())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=g().indexOf("Electron/")||0<=(n=g()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=g().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),Nr("Connection","Creating WebChannel: "+(r=r.join("")),t);var s=i.createWebChannel(r,t),u=!1,a=!1,c=new Lf({du:function(t){a?Nr("Connection","Not sending because WebChannel is closed:",t):(u||(Nr("Connection","Opening WebChannel transport."),s.open(),u=!0),Nr("Connection","WebChannel sending:",t),s.send(t))},wu:function(){return s.close()}});return(t=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))})(s,Ir.EventType.OPEN,(function(){a||Nr("Connection","WebChannel transport opened.")})),t(s,Ir.EventType.CLOSE,(function(){a||(a=!0,Nr("Connection","WebChannel transport closed"),c.Pu())})),t(s,Ir.EventType.ERROR,(function(t){a||(a=!0,Ar("Connection","WebChannel transport errored:",t),c.Pu(new qr(jr.UNAVAILABLE,"The operation could not be completed")))})),t(s,Ir.EventType.MESSAGE,(function(t){var e,n,r,i;a||(Or(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Nr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Ys[r];if(void 0!==t)return iu(t)}(),i=n.message,void 0===t&&(t=jr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),a=!0,c.Pu(new qr(t,i)),s.close()):(Nr("Connection","WebChannel received:",e),c.yu(e)))})),t(o,br.STAT_EVENT,(function(t){10===t.stat?Nr("Connection","Detected buffering proxy"):11===t.stat&&Nr("Connection","Detected no buffering proxy")})),setTimeout((function(){c.Ru()}),0),c},Rf);function Rf(t){var e=this;return(e=_f.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.I=t.I,e}function Vf(t){this.gu=t,this.T=t.T;var e=t.ssl?"https":"http";this.Vu=e+"://"+t.host,this.pu="projects/"+this.T.projectId+"/databases/"+this.T.database+"/documents"}function Mf(t){this.du=t.du,this.wu=t.wu}function Uf(){var t=this;this.au=function(){return t.uu()},this.hu=function(){return t.lu()},this._u=[],this.fu()}function jf(){}function qf(){this.ru=new Af,this.ou={},this.da=null,this.L=null}function Ff(t,e,n,r,i){this.window=t,this.eo=e,this.persistenceKey=n,this._a=r,this.fa=null,this.da=null,this.L=null,this.wa=this.Ea.bind(this),this.Ta=new ou(Lr),this.Tr=!1,this.Ia=[],n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),this.storage=this.window.localStorage,this.currentUser=i,this.ma=wf(this.persistenceKey,this._a),this.Aa="firestore_sequence_number_"+this.persistenceKey,this.Ta=this.Ta.Ht(this._a,new Af),this.Ra=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.Pa=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.ya=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.ga="firestore_online_state_"+this.persistenceKey,this.Va="firestore_bundle_loaded_"+this.persistenceKey,this.window.addEventListener("storage",this.wa)}function Hf(){this.activeTargetIds=Iu}function Bf(t,e){this.clientId=t,this.onlineState=e}function Gf(t,e){this.clientId=t,this.activeTargetIds=e}function zf(t,e,n){this.targetId=t,this.state=e,this.error=n}function Kf(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Jf(){return"undefined"!=typeof window?window:null}function Wf(){return"undefined"!=typeof document?document:null}function Xf(t){return new Bu(t,!0)}function Yf(t,e,n,r,i){var o=this;this.Sh=t,this.Dh=e,this.fs=n,this.Ch={},this.xh=[],this.Nh=new Map,this.Oh=new Set,this.Fh=[],this.kh=i,this.kh.cu((function(t){n.ys((function(){return d(o,void 0,void 0,(function(){return y(this,(function(t){switch(t.label){case 0:return wl(this)?(Nr("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return d(this,void 0,void 0,(function(){var e;return y(this,(function(n){switch(n.label){case 0:return(e=t).Oh.add(4),[4,ll(e)];case 1:return n.sent(),e.Mh.set("Unknown"),e.Oh.delete(4),[4,fl(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Mh=new il(n,r)}var Qf,$f,Zf,tl=(hl.prototype.reset=function(){this.ku=0},hl.prototype.$u=function(){this.ku=this.Fu},hl.prototype.Bu=function(t){var e=this;this.cancel();var n=Math.floor(this.ku+this.qu()),r=Math.max(0,Date.now()-this.Lu),i=Math.max(0,n-r);0<i&&Nr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.ku+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Mu=this.eo.Ir(this.ds,i,(function(){return e.Lu=Date.now(),t()})),this.ku*=this.Ou,this.ku<this.Nu&&(this.ku=this.Nu),this.ku>this.Fu&&(this.ku=this.Fu)},hl.prototype.Uu=function(){null!==this.Mu&&(this.Mu.Ps(),this.Mu=null)},hl.prototype.cancel=function(){null!==this.Mu&&(this.Mu.cancel(),this.Mu=null)},hl.prototype.qu=function(){return(Math.random()-.5)*this.ku},hl),el=(cl.prototype.Hu=function(){return 1===this.state||2===this.state||4===this.state},cl.prototype.Ju=function(){return 2===this.state},cl.prototype.start=function(){3!==this.state?this.auth():this.Yu()},cl.prototype.stop=function(){return d(this,void 0,void 0,(function(){return y(this,(function(t){switch(t.label){case 0:return this.Hu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},cl.prototype.Xu=function(){this.state=0,this.zu.reset()},cl.prototype.Zu=function(){var t=this;this.Ju()&&null===this.Gu&&(this.Gu=this.eo.Ir(this.Qu,6e4,(function(){return t.th()})))},cl.prototype.eh=function(t){this.nh(),this.stream.send(t)},cl.prototype.th=function(){return d(this,void 0,void 0,(function(){return y(this,(function(t){return this.Ju()?[2,this.close(0)]:[2]}))}))},cl.prototype.nh=function(){this.Gu&&(this.Gu.cancel(),this.Gu=null)},cl.prototype.close=function(t,e){return d(this,void 0,void 0,(function(){return y(this,(function(n){switch(n.label){case 0:return this.nh(),this.zu.cancel(),this.Wu++,3!==t?this.zu.reset():e&&e.code===jr.RESOURCE_EXHAUSTED?(Sr(e.toString()),Sr("Using maximum backoff delay to prevent overloading the backend."),this.zu.$u()):e&&e.code===jr.UNAUTHENTICATED&&this.ju.v(),null!==this.stream&&(this.sh(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Iu(e)];case 1:return n.sent(),[2]}}))}))},cl.prototype.sh=function(){},cl.prototype.auth=function(){var t=this;this.state=1;var e=this.ih(this.Wu),n=this.Wu;this.ju.getToken().then((function(e){t.Wu===n&&t.rh(e)}),(function(n){e((function(){var e=new qr(jr.UNKNOWN,"Fetching auth token failed: "+n.message);return t.oh(e)}))}))},cl.prototype.rh=function(t){var e=this,n=this.ih(this.Wu);this.stream=this.ah(t),this.stream.Eu((function(){n((function(){return e.state=2,e.listener.Eu()}))})),this.stream.Iu((function(t){n((function(){return e.oh(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},cl.prototype.Yu=function(){var t=this;this.state=4,this.zu.Bu((function(){return d(t,void 0,void 0,(function(){return y(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},cl.prototype.oh=function(t){return Nr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},cl.prototype.ih=function(t){var e=this;return function(n){e.eo.ys((function(){return e.Wu===t?n():(Nr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},p(al,Zf=Ne=cl),al.prototype.ah=function(t){return this.Ku.xu("Listen",t)},al.prototype.onMessage=function(t){this.zu.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Dr(),r=e.targetChange.targetIds||[],i=(s=e.targetChange.resumeToken,t.qt?(Or(void 0===s||"string"==typeof s),Vr.fromBase64String(s||"")):(Or(void 0===s||s instanceof Uint8Array),Vr.fromUint8Array(s||new Uint8Array))),o=(u=e.targetChange.cause)&&(a=void 0===(c=u).code?jr.UNKNOWN:iu(c.code),new qr(a,c.message||"")),s=new Du(n,r,i,o||null)}else if("documentChange"in e){e.documentChange,(n=e.documentChange).document,n.document.name,n.document.updateTime,r=Yu(t,n.document.name),i=Ku(n.document.updateTime);var u=new $i({mapValue:{fields:n.document.fields}}),a=(o=new oo(r,i,u,{}),n.targetIds||[]),c=n.removedTargetIds||[];s=new Au(a,c,o.key,o)}else if("documentDelete"in e)e.documentDelete,(n=e.documentDelete).document,r=Yu(t,n.document),i=n.readTime?Ku(n.readTime):yi.min(),u=new so(r,i),o=n.removedTargetIds||[],s=new Au([],o,u.key,u);else if("documentRemove"in e)e.documentRemove,(n=e.documentRemove).document,r=Yu(t,n.document),i=n.removedTargetIds||[],s=new Au([],i,r,null);else{if(!("filter"in e))return Dr();e.filter,(e=e.filter).targetId,r=new Xs(n=e.count||0),i=e.targetId,s=new xu(i,r)}return s}(this.Kt,t);return t=function(t){return"targetChange"in t?(t=t.targetChange).targetIds&&t.targetIds.length||!t.readTime?yi.min():Ku(t.readTime):yi.min()}(t),this.listener.uh(e,t)},al.prototype.hh=function(t){var e,n,r,i,o={};o.database=Zu(this.Kt),o.addTarget=(e=this.Kt,(r=vo(r=(n=t).target)?{documents:oa(e,r)}:{query:sa(e,r)}).targetId=n.targetId,0<n.resumeToken.o()?r.resumeToken=zu(e,n.resumeToken):0<n.Mt.u(yi.min())&&(r.readTime=Gu(e,n.Mt.G())),r),this.Kt,i=t,(t=null==(t=function(){switch(i.kt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Dr()}}())?null:{"goog-listen-tags":t})&&(o.labels=t),this.eh(o)},al.prototype.lh=function(t){var e={};e.database=Zu(this.Kt),e.removeTarget=t,this.eh(e)},al),nl=(p(ul,$f=Ne),Object.defineProperty(ul.prototype,"fh",{get:function(){return this._h},enumerable:!1,configurable:!0}),ul.prototype.start=function(){this._h=!1,this.lastStreamToken=void 0,$f.prototype.start.call(this)},ul.prototype.sh=function(){this._h&&this.dh([])},ul.prototype.ah=function(t){return this.Ku.xu("Write",t)},ul.prototype.onMessage=function(t){if(Or(!!t.streamToken),this.lastStreamToken=t.streamToken,this._h){this.zu.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Or(void 0!==r),n.map((function(t){return function(t,e){var n=t.updateTime?Ku(t.updateTime):Ku(e);return n.isEqual(yi.min())&&(n=Ku(e)),e=null,t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new ks(n,e)}(t,r)}))):[]),n=Ku(t.commitTime);return this.listener.wh(n,e)}var r;return Or(!t.writeResults||0===t.writeResults.length),this._h=!0,this.listener.Eh()},ul.prototype.Th=function(){var t={};t.database=Zu(this.Kt),this.eh(t)},ul.prototype.dh=function(t){var e=this;t={streamToken:this.lastStreamToken,writes:t.map((function(t){return ra(e.Kt,t)}))},this.eh(t)},ul),rl=(p(sl,Qf=function(){}),sl.prototype.mh=function(){if(this.Ih)throw new qr(jr.FAILED_PRECONDITION,"The client has already been terminated.")},sl.prototype.bu=function(t,e,n){var r=this;return this.mh(),this.credentials.getToken().then((function(i){return r.Ku.bu(t,e,n,i)})).catch((function(t){throw t.code===jr.UNAUTHENTICATED&&r.credentials.v(),t}))},sl.prototype.Cu=function(t,e,n){var r=this;return this.mh(),this.credentials.getToken().then((function(i){return r.Ku.Cu(t,e,n,i)})).catch((function(t){throw t.code===jr.UNAUTHENTICATED&&r.credentials.v(),t}))},sl.prototype.terminate=function(){this.Ih=!1},sl),il=(ol.prototype.yh=function(){var t=this;0===this.Ah&&(this.gh("Unknown"),this.Rh=this.fs.Ir("online_state_timeout",1e4,(function(){return t.Rh=null,t.Vh("Backend didn't respond within 10 seconds."),t.gh("Offline"),Promise.resolve()})))},ol.prototype.ph=function(t){"Online"===this.state?this.gh("Unknown"):(this.Ah++,1<=this.Ah&&(this.bh(),this.Vh("Connection failed 1 times. Most recent error: "+t.toString()),this.gh("Offline")))},ol.prototype.set=function(t){this.bh(),this.Ah=0,"Online"===t&&(this.Ph=!1),this.gh(t)},ol.prototype.gh=function(t){t!==this.state&&(this.state=t,this.da(t))},ol.prototype.Vh=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.Ph?(Sr(t),this.Ph=!1):Nr("OnlineStateTracker",t)},ol.prototype.bh=function(){null!==this.Rh&&(this.Rh.cancel(),this.Rh=null)},ol);function ol(t,e){this.fs=t,this.da=e,this.state="Unknown",this.Ah=0,this.Rh=null,this.Ph=!0}function sl(t,e,n){var r=this;return(r=Qf.call(this)||this).credentials=t,r.Ku=e,r.Kt=n,r.Ih=!1,r}function ul(t,e,n,r,i){var o=this;return(o=$f.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).Kt=r,o._h=!1,o}function al(t,e,n,r,i){var o=this;return(o=Zf.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).Kt=r,o}function cl(t,e,n,r,i,o){this.eo=t,this.Qu=n,this.Ku=r,this.ju=i,this.listener=o,this.state=0,this.Wu=0,this.Gu=null,this.stream=null,this.zu=new tl(t,e)}function hl(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.eo=t,this.ds=e,this.Nu=n,this.Ou=r,this.Fu=i,this.ku=0,this.Mu=null,this.Lu=Date.now(),this.reset()}function fl(t){return d(this,void 0,void 0,(function(){var e,n;return y(this,(function(r){switch(r.label){case 0:if(!wl(t))return[3,4];e=0,n=t.Fh,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function ll(t){return d(this,void 0,void 0,(function(){var e,n;return y(this,(function(r){switch(r.label){case 0:e=0,n=t.Fh,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function pl(t,e){t.Nh.has(e.targetId)||(t.Nh.set(e.targetId,e),ml(t)?gl(t):xl(t).Ju()&&yl(t,e))}function dl(t,e){var n=t;t=xl(n),n.Nh.delete(e),t.Ju()&&vl(n,e),0===n.Nh.size&&(t.Ju()?t.Zu():wl(n)&&n.Mh.set("Unknown"))}function yl(t,e){t.Lh.cn(e.targetId),xl(t).hh(e)}function vl(t,e){t.Lh.cn(e),xl(t).lh(e)}function gl(t){t.Lh=new ku({Sn:function(e){return t.Ch.Sn(e)},Dn:function(e){return t.Nh.get(e)||null}}),xl(t).start(),t.Mh.yh()}function ml(t){return wl(t)&&!xl(t).Hu()&&0<t.Nh.size}function wl(t){return 0===t.Oh.size}function bl(t){t.Lh=void 0}function Il(t,e,n){return d(this,void 0,void 0,(function(){var r,i;return y(this,(function(o){switch(o.label){case 0:if(t.Mh.set("Online"),!(e instanceof Du&&2===e.state&&e.cause))return[3,6];o.label=1;case 1:return o.trys.push([1,3,,5]),[4,function(t,e){return d(this,void 0,void 0,(function(){var n,r,i,o;return y(this,(function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?(o=i[r],t.Nh.has(o)?[4,t.Ch.$h(o,n)]:[3,3]):[3,5];case 2:s.sent(),t.Nh.delete(o),t.Lh.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return o.sent(),[3,5];case 3:return r=o.sent(),Nr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,_l(t,r)];case 4:return o.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Au?t.Lh.wn(e):e instanceof xu?t.Lh.yn(e):t.Lh.In(e),n.isEqual(yi.min()))return[3,13];o.label=7;case 7:return o.trys.push([7,11,,13]),[4,Fh(t.Sh)];case 8:return i=o.sent(),0<=n.u(i)?[4,(u=n,(a=(s=t).Lh.pn(u)).Fe.forEach((function(t,e){var n;0<t.resumeToken.o()&&(n=s.Nh.get(e))&&s.Nh.set(e,n.$t(t.resumeToken,u))})),a.ke.forEach((function(t){var e=s.Nh.get(t);e&&(s.Nh.set(t,e.$t(Vr.h,e.Mt)),vl(s,t),e=new cs(e.target,t,1,e.sequenceNumber),yl(s,e))})),s.Ch.Bh(a))]:[3,10];case 9:o.sent(),o.label=10;case 10:return[3,13];case 11:return Nr("RemoteStore","Failed to raise snapshot:",i=o.sent()),[4,_l(t,i)];case 12:return o.sent(),[3,13];case 13:return[2]}var s,u,a}))}))}function _l(t,e,n){return d(this,void 0,void 0,(function(){var r=this;return y(this,(function(i){switch(i.label){case 0:if(!Sa(e))throw e;return t.Oh.add(1),[4,ll(t)];case 1:return i.sent(),t.Mh.set("Offline"),n=n||function(){return Fh(t.Sh)},t.fs.bo((function(){return d(r,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return Nr("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Oh.delete(1),[4,fl(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function El(t,e){return e().catch((function(n){return _l(t,n,e)}))}function Tl(t){return d(this,void 0,void 0,(function(){var e,n,r,i;return y(this,(function(o){switch(o.label){case 0:n=Dl(e=t),r=0<e.xh.length?e.xh[e.xh.length-1].batchId:-1,o.label=1;case 1:if(!(wl(e)&&e.xh.length<10))return[3,7];o.label=2;case 2:return o.trys.push([2,4,,6]),[4,(s=e.Sh,u=r,(a=s).persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===u&&(u=-1),a.Ho.Vi(t,u)})))];case 3:return null===(i=o.sent())?(0===e.xh.length&&n.Zu(),[3,7]):(r=i.batchId,function(t,e){t.xh.push(e),(t=Dl(t)).Ju()&&t.fh&&t.dh(e.mutations)}(e,i),[3,6]);case 4:return i=o.sent(),[4,_l(e,i)];case 5:return o.sent(),[3,6];case 6:return[3,1];case 7:return Nl(e)&&Sl(e),[2]}var s,u,a}))}))}function Nl(t){return wl(t)&&!Dl(t).Hu()&&0<t.xh.length}function Sl(t){Dl(t).start()}function Al(t,e){return d(this,void 0,void 0,(function(){var n;return y(this,(function(r){switch(r.label){case 0:return n=t,e?(n.Oh.delete(2),[4,fl(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Oh.add(2),[4,ll(n)]);case 3:r.sent(),n.Mh.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function xl(t){var e,n,r,i=this;return t.Qh||(t.Qh=(e=t.Dh,n=t.fs,r={Eu:function(t){return d(this,void 0,void 0,(function(){return y(this,(function(e){return t.Nh.forEach((function(e,n){yl(t,e)})),[2]}))}))}.bind(null,t),Iu:function(t,e){return d(this,void 0,void 0,(function(){return y(this,(function(n){return bl(t),ml(t)?(t.Mh.ph(e),gl(t)):t.Mh.set("Unknown"),[2]}))}))}.bind(null,t),uh:Il.bind(null,t)},e.mh(),new el(n,e.Ku,e.credentials,e.Kt,r)),t.Fh.push((function(e){return d(i,void 0,void 0,(function(){return y(this,(function(n){switch(n.label){case 0:return e?(t.Qh.Xu(),ml(t)?gl(t):t.Mh.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Qh.stop()];case 2:n.sent(),bl(t),n.label=3;case 3:return[2]}}))}))}))),t.Qh}function Dl(t){var e,n,r,i=this;return t.Kh||(t.Kh=(e=t.Dh,n=t.fs,r={Eu:function(t){return d(this,void 0,void 0,(function(){return y(this,(function(e){return Dl(t).Th(),[2]}))}))}.bind(null,t),Iu:function(t,e){return d(this,void 0,void 0,(function(){return y(this,(function(n){switch(n.label){case 0:return e&&Dl(t).fh?[4,function(t,e){return d(this,void 0,void 0,(function(){var n,r;return y(this,(function(i){switch(i.label){case 0:return ru(r=e.code)&&r!==jr.ABORTED?(n=t.xh.shift(),Dl(t).Xu(),[4,El(t,(function(){return t.Ch.Uh(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,Tl(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return Nl(t)&&Sl(t),[2]}}))}))}.bind(null,t),Eh:function(t){return d(this,void 0,void 0,(function(){var e,n,r,i;return y(this,(function(o){for(e=Dl(t),n=0,r=t.xh;n<r.length;n++)i=r[n],e.dh(i.mutations);return[2]}))}))}.bind(null,t),wh:function(t,e,n){return d(this,void 0,void 0,(function(){var r,i;return y(this,(function(o){switch(o.label){case 0:return r=t.xh.shift(),i=cc.from(r,e,n),[4,El(t,(function(){return t.Ch.qh(i)}))];case 1:return o.sent(),[4,Tl(t)];case 2:return o.sent(),[2]}}))}))}.bind(null,t)},e.mh(),new nl(n,e.Ku,e.credentials,e.Kt,r)),t.Fh.push((function(e){return d(i,void 0,void 0,(function(){return y(this,(function(n){switch(n.label){case 0:return e?(t.Kh.Xu(),[4,Tl(t)]):[3,2];case 1:return n.sent(),[3,4];case 2:return[4,t.Kh.stop()];case 3:n.sent(),0<t.xh.length&&(Nr("RemoteStore","Stopping write stream with "+t.xh.length+" pending writes"),t.xh=[]),n.label=4;case 4:return[2]}}))}))}))),t.Kh}function Ol(){this.queries=new Uc(os,is),this.onlineState="Unknown",this.Wh=new Set}var kl=function(){this.jh=void 0,this.listeners=[]};function Pl(t,e){return d(this,void 0,void 0,(function(){var n,r,i,o,s;return y(this,(function(u){switch(u.label){case 0:if(n=t,r=e.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new kl),!i)return[3,4];u.label=1;case 1:return u.trys.push([1,3,,4]),s=o,[4,n.Gh(r)];case 2:return s.jh=u.sent(),[3,4];case 3:return s=Ca(s=u.sent(),"Initialization of query '"+ss(e.query)+"' failed"),[2,void e.onError(s)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zh(n.onlineState),o.jh&&e.Hh(o.jh)&&Cl(n),[2]}}))}))}function Ll(t,e){return d(this,void 0,void 0,(function(){var n,r,i,o,s;return y(this,(function(u){return n=t,r=e.query,i=!1,(o=n.queries.get(r))&&0<=(s=o.listeners.indexOf(e))&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.Jh(r))]:[2]}))}))}function Cl(t){t.Wh.forEach((function(t){t.next()}))}var Rl=(Hl.prototype.Hh=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Tu(t.query,t.docs,t.De,e,t.Ce,t.fromCache,t.xe,!0)}var o=!1;return this.Xh?this.tl(t)&&(this.Yh.next(t),o=!0):this.el(t,this.onlineState)&&(this.nl(t),o=!0),this.Zh=t,o},Hl.prototype.onError=function(t){this.Yh.error(t)},Hl.prototype.zh=function(t){this.onlineState=t;var e=!1;return this.Zh&&!this.Xh&&this.el(this.Zh,t)&&(this.nl(this.Zh),e=!0),e},Hl.prototype.el=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.sl&&n||t.docs.nt()&&"Offline"!==e)},Hl.prototype.tl=function(t){if(0<t.docChanges.length)return!0;var e=this.Zh&&this.Zh.hasPendingWrites!==t.hasPendingWrites;return!(!t.xe&&!e)&&!0===this.options.includeMetadataChanges},Hl.prototype.nl=function(t){t=Tu.Oe(t.query,t.docs,t.Ce,t.fromCache),this.Xh=!0,this.Yh.next(t)},Hl),Vl=(Fl.prototype.il=function(){return"metadata"in this.payload},Fl),Ml=(ql.prototype.yc=function(t){return Yu(this.Kt,t)},ql.prototype.gc=function(t){return t.metadata.exists?na(this.Kt,t.document,!1):new so(this.yc(t.metadata.name),this.Vc(t.metadata.readTime))},ql.prototype.Vc=Ku,ql),Ul=(jl.prototype.ol=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},jl.prototype.cl=function(t){for(var e=new Map,n=new Ml(this.Kt),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.yc(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||bu()).add(s);e.set(c,h)}}return e},jl.prototype.complete=function(){return d(this,void 0,void 0,(function(){var t,e,n,r;return y(this,(function(i){switch(i.label){case 0:return[4,function(t,e,n,r){return d(this,void 0,void 0,(function(){var i,o,s,u,a,c,h,f,l,p;return y(this,(function(d){switch(d.label){case 0:for(i=t,o=bu(),s=du,u=mu,a=0,c=n;a<c.length;a++)h=c[a],f=e.yc(h.metadata.name),h.document&&(o=o.add(f)),s=s.Ht(f,e.gc(h)),u=u.Ht(f,e.Vc(h.metadata.readTime));return l=i.Tc.Or({Wr:!0}),[4,Gh(i,ns(Xo(vi.ct("__bundle__/docs/"+r))))];case 1:return p=d.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",(function(t){return Bh(t,l,s,yi.min(),u).next((function(e){return l.apply(t),e})).next((function(e){return i.fo.Xi(t,p.targetId).next((function(){return i.fo.nr(t,o,p.targetId)})).next((function(){return i.Ic.tc(t,e)}))}))}))]}}))}))}(this.Sh,new Ml(this.Kt),this.documents,this.rl.id)];case 1:t=i.sent(),e=this.cl(this.documents),n=0,r=this.queries,i.label=2;case 2:return n<r.length?(r=r[n],[4,function(t,e,n){return void 0===n&&(n=bu()),d(this,void 0,void 0,(function(){var r,i;return y(this,(function(o){switch(o.label){case 0:return[4,Gh(t,ns(_c(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=t).persistence.runTransaction("Save named query","readwrite",(function(t){var o=Ku(e.readTime);return 0<=r.Mt.u(o)?i.Eo.Bs(t,e):(o=r.$t(Vr.h,o),i.dc=i.dc.Ht(o.targetId,o),i.fo.Ji(t,o).next((function(){return i.fo.Xi(t,r.targetId)})).next((function(){return i.fo.nr(t,n,r.targetId)})).next((function(){return i.Eo.Bs(t,e)})))}))]}}))}))}(this.Sh,r,e.get(r.name))]):[3,5];case 3:i.sent(),i.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Dh(Object.assign({},this.progress),t))]}}))}))},jl);function jl(t,e,n){this.rl=t,this.Sh=e,this.Kt=n,this.queries=[],this.documents=[],this.progress=Bl(t)}function ql(t){this.Kt=t}function Fl(t,e){this.payload=t,this.byteLength=e}function Hl(t,e,n){this.query=t,this.Yh=e,this.Xh=!1,this.Zh=null,this.onlineState="Unknown",this.options=n||{}}function Bl(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var Gl=function(t){this.key=t},zl=function(t){this.key=t},Kl=(Object.defineProperty(Ql.prototype,"fl",{get:function(){return this.al},enumerable:!1,configurable:!0}),Ql.prototype.dl=function(t,e){var n=this,r=e?e.wl:new Eu,i=(e||this)._l,o=(e||this).Ce,s=i,u=!1,a=Yo(this.query)&&i.size===this.query.limit?i.last():null,c=Qo(this.query)&&i.size===this.query.limit?i.first():null;if(t.Zt((function(t,e){var h=i.get(t),f=(f=e instanceof oo?e:null)&&(us(n.query,f)?f:null),l=!!h&&n.Ce.has(h.key),p=!!f&&(f.bt||n.Ce.has(f.key)&&f.hasCommittedMutations);e=!1,h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),e=!0):n.El(h,f)||(r.track({type:2,doc:f}),e=!0,(a&&0<n.ll(f,a)||c&&n.ll(f,c)<0)&&(u=!0)):!h&&f?(r.track({type:0,doc:f}),e=!0):h&&!f&&(r.track({type:1,doc:h}),e=!0,(a||c)&&(u=!0)),e&&(o=f?(s=s.add(f),p?o.add(t):o.delete(t)):(s=s.delete(t),o.delete(t)))})),Yo(this.query)||Qo(this.query))for(;s.size>this.query.limit;){var h=Yo(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{_l:s,wl:r,_c:u,Ce:o}},Ql.prototype.El=function(t,e){return t.bt&&e.hasCommittedMutations&&!e.bt},Ql.prototype.Ei=function(t,e,n){var r=this,i=this._l;this._l=t._l,this.Ce=t.Ce;var o=t.wl.Se();o.sort((function(t,e){return i=t.type,o=e.type,n(i)-n(o)||r.ll(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Dr()}}var i,o})),this.Tl(n);var s=e?this.Il():[];return e=(n=0===this.hl.size&&this.qe?1:0)!==this.ul,this.ul=n,0!==o.length||e?{snapshot:new Tu(this.query,t._l,i,o,t.Ce,0==n,e,!1),ml:s}:{ml:s}},Ql.prototype.zh=function(t){return this.qe&&"Offline"===t?(this.qe=!1,this.Ei({_l:this._l,wl:new Eu,Ce:this.Ce,_c:!1},!1)):{ml:[]}},Ql.prototype.Al=function(t){return!this.al.has(t)&&!!this._l.has(t)&&!this._l.get(t).bt},Ql.prototype.Tl=function(t){var e=this;t&&(t.Ue.forEach((function(t){return e.al=e.al.add(t)})),t.Qe.forEach((function(t){})),t.Ke.forEach((function(t){return e.al=e.al.delete(t)})),this.qe=t.qe)},Ql.prototype.Il=function(){var t=this;if(!this.qe)return[];var e=this.hl;this.hl=bu(),this._l.forEach((function(e){t.Al(e.key)&&(t.hl=t.hl.add(e.key))}));var n=[];return e.forEach((function(e){t.hl.has(e)||n.push(new zl(e))})),this.hl.forEach((function(t){e.has(t)||n.push(new Gl(t))})),n},Ql.prototype.Rl=function(t){return this.al=t.Pc,this.hl=bu(),t=this.dl(t.documents),this.Ei(t,!0)},Ql.prototype.Pl=function(){return Tu.Oe(this.query,this._l,this.Ce,0===this.ul)},Ql),Jl=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Wl=function(t){this.key=t,this.yl=!1},Xl=(Object.defineProperty(Yl.prototype,"$l",{get:function(){return!0===this.Ll},enumerable:!1,configurable:!0}),Yl);function Yl(t,e,n,r,i,o){this.Sh=t,this.gl=e,this.Vl=n,this.pl=r,this.currentUser=i,this.bl=o,this.vl={},this.Sl=new Uc(os,is),this.Dl=new Map,this.Cl=[],this.xl=new ou(wi.J),this.Nl=new Map,this.Ol=new Zh,this.Fl={},this.kl=new Map,this.Ml=Xc.Bi(),this.onlineState="Unknown",this.Ll=void 0}function Ql(t,e){this.query=t,this.al=e,this.ul=null,this.qe=!1,this.hl=bu(),this.Ce=bu(),this.ll=as(t),this._l=new _u(this.ll)}function $l(t,e,n,r){return d(this,void 0,void 0,(function(){var i,o,s;return y(this,(function(u){switch(u.label){case 0:return t.Bl=function(e,n,r){return function(t,e,n,r){return d(this,void 0,void 0,(function(){var i,o;return y(this,(function(s){switch(s.label){case 0:return(i=e.view.dl(n))._c?[4,Kh(t.Sh,e.query,!1).then((function(t){return t=t.documents,e.view.dl(t,i)}))]:[3,2];case 1:i=s.sent(),s.label=2;case 2:return o=r&&r.Fe.get(e.targetId),o=e.view.Ei(i,t.$l,o),[2,(ap(t,e.targetId,o.ml),o.snapshot)]}}))}))}(t,e,n,r)},[4,Kh(t.Sh,e,!0)];case 1:return o=u.sent(),s=new Kl(e,o.Pc),i=s.dl(o.documents),o=Su.Be(n,r&&"Offline"!==t.onlineState),o=s.Ei(i,t.$l,o),ap(t,n,o.ml),s=new Jl(e,n,s),[2,(t.Sl.set(e,s),t.Dl.has(n)?t.Dl.get(n).push(e):t.Dl.set(n,[e]),o.snapshot)]}}))}))}function Zl(t,e,n){return d(this,void 0,void 0,(function(){var r,i;return y(this,(function(o){switch(o.label){case 0:i=gp(t),o.label=1;case 1:return o.trys.push([1,5,,6]),[4,(c=i.Sh,h=e,l=c,p=di.now(),d=h.reduce((function(t,e){return t.add(e.key)}),bu()),l.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return l.Ic.Zo(t,d).next((function(e){f=e;for(var n,r=[],i=0,o=h;i<o.length;i++){var s=o[i],u=(n=s,u=f.get(s.key),function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof oo?e.field(o.field):void 0;null!=(s=ds(o.transform,s||null))&&(n=(null==n?new Zi:n).set(o.field,s))}return n?n.yt():null}(n.fieldTransforms,u));null!=u&&r.push(new Hs(s.key,u,function t(e){var n=[];return Ai(e.fields||{},(function(e,r){var i=new mi([e]);if(Qi(r))if(0===(r=t(r.mapValue).fields).length)n.push(i);else for(var o=0,s=r;o<s.length;o++){var u=s[o];n.push(i.child(u))}else n.push(i)})),new Di(n)}(u.proto.mapValue),Ls.exists(!0)))}return l.Ho.Pi(t,p,r,h)}))})).then((function(t){var e=t.Ns(f);return{batchId:t.batchId,oi:e}})))];case 2:return r=o.sent(),i.pl.xa(r.batchId),s=i,u=r.batchId,a=n,c=(c=(c=s.Fl[s.currentUser.R()])||new ou(Lr)).Ht(u,a),s.Fl[s.currentUser.R()]=c,[4,hp(i,r.oi)];case 3:return o.sent(),[4,Tl(i.gl)];case 4:return o.sent(),[3,6];case 5:return i=Ca(i=o.sent(),"Failed to persist write"),n.reject(i),[3,6];case 6:return[2]}var s,u,a,c,h,f,l,p,d}))}))}function tp(t,e){return d(this,void 0,void 0,(function(){var n,r;return y(this,(function(i){switch(i.label){case 0:n=t,i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Hh(n.Sh,e)];case 2:return r=i.sent(),e.Fe.forEach((function(t,e){(e=n.Nl.get(e))&&(Or(t.Ue.size+t.Qe.size+t.Ke.size<=1),0<t.Ue.size?e.yl=!0:0<t.Qe.size?Or(e.yl):0<t.Ke.size&&(Or(e.yl),e.yl=!1))})),[4,hp(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Mc(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function ep(t,e,n){var r;((t=t).$l&&0===n||!t.$l&&1===n)&&(r=[],t.Sl.forEach((function(t,n){(n=n.view.zh(e)).snapshot&&r.push(n.snapshot)})),function(t,e){t.onlineState=e;var n=!1;t.queries.forEach((function(t,r){for(var i=0,o=r.listeners;i<o.length;i++)o[i].zh(e)&&(n=!0)})),n&&Cl(t)}(t.Vl,e),r.length&&t.vl.uh(r),t.onlineState=e,t.$l&&t.pl.Ka(e))}function np(t,e,n){return d(this,void 0,void 0,(function(){var r,i;return y(this,(function(o){switch(o.label){case 0:r=t,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,(s=r.Sh,u=e,(a=s).persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var e;return a.Ho.yi(t,u).next((function(n){return Or(null!==n),e=n.keys(),a.Ho.xi(t,n)})).next((function(){return a.Ho.Fi(t)})).next((function(){return a.Ic.Zo(t,e)}))})))];case 2:return i=o.sent(),op(r,e,n),ip(r,e),r.pl.Oa(e,"rejected",n),[4,hp(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Mc(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}var s,u,a}))}))}function rp(t,e){return d(this,void 0,void 0,(function(){var n,r,i;return y(this,(function(o){switch(o.label){case 0:wl((n=t).gl)||Nr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,(s=n.Sh).persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return s.Ho.pi(t)}))];case 2:return-1===(r=o.sent())?[2,void e.resolve()]:((i=n.kl.get(r)||[]).push(e),n.kl.set(r,i),[3,4]);case 3:return i=Ca(i=o.sent(),"Initialization of waitForPendingWrites() operation failed"),e.reject(i),[3,4];case 4:return[2]}var s}))}))}function ip(t,e){(t.kl.get(e)||[]).forEach((function(t){t.resolve()})),t.kl.delete(e)}function op(t,e,n){var r=t,i=r.Fl[r.currentUser.R()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.Fl[r.currentUser.R()]=i)}function sp(t,e,n){void 0===n&&(n=null),t.pl.La(e);for(var r=0,i=t.Dl.get(e);r<i.length;r++){var o=i[r];t.Sl.delete(o),n&&t.vl.ql(o,n)}t.Dl.delete(e),t.$l&&t.Ol.kc(e).forEach((function(e){t.Ol.ki(e)||up(t,e)}))}function up(t,e){var n=t.xl.get(e);null!==n&&(dl(t.gl,n),t.xl=t.xl.remove(e),t.Nl.delete(n),cp(t))}function ap(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Gl?(t.Ol.sr(o.key,e),function(t,e){e=e.key,t.xl.get(e)||(Nr("SyncEngine","New document in limbo: "+e),t.Cl.push(e),cp(t))}(t,o)):o instanceof zl?(Nr("SyncEngine","Document no longer in limbo: "+o.key),t.Ol.rr(o.key,e),t.Ol.ki(o.key)||up(t,o.key)):Dr()}}function cp(t){for(;0<t.Cl.length&&t.xl.size<t.bl;){var e=t.Cl.shift(),n=t.Ml.next();t.Nl.set(n,new Wl(e)),t.xl=t.xl.Ht(e,n),pl(t.gl,new cs(ns(Xo(e.path)),n,2,si.U))}}function hp(t,e,n){return d(this,void 0,void 0,(function(){var r,i,o,s;return y(this,(function(u){switch(u.label){case 0:return i=[],o=[],s=[],(r=t).Sl.nt()?[3,3]:(r.Sl.forEach((function(t,u){s.push(r.Bl(u,e,n).then((function(t){t&&(r.$l&&r.pl.qa(u.targetId,t.fromCache?"not-current":"current"),i.push(t),t=kh.cc(u.targetId,t),o.push(t))})))})),[4,Promise.all(s)]);case 1:return u.sent(),r.vl.uh(i),[4,function(t,e){return d(this,void 0,void 0,(function(){var n,r,i,o,s,u,a;return y(this,(function(c){switch(c.label){case 0:n=t,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return va.forEach(e,(function(e){return va.forEach(e.rc,(function(r){return n.persistence.Ii.sr(t,e.targetId,r)})).next((function(){return va.forEach(e.oc,(function(r){return n.persistence.Ii.rr(t,e.targetId,r)}))}))}))}))];case 2:return c.sent(),[3,4];case 3:if(!Sa(r=c.sent()))throw r;return Nr("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)a=o[i],s=a.targetId,a.fromCache||(u=n.dc.get(s),a=u.Mt,a=u.Bt(a),n.dc=n.dc.Ht(s,a));return[2]}}))}))}(r.Sh,o)];case 2:u.sent(),u.label=3;case 3:return[2]}}))}))}function fp(t,e){return d(this,void 0,void 0,(function(){var n,r;return y(this,(function(i){switch(i.label){case 0:return(n=t).currentUser.isEqual(e)?[3,3]:(Nr("SyncEngine","User change. New user:",e.R()),[4,jh(n.Sh,e)]);case 1:return r=i.sent(),n.currentUser=e,(o=n).kl.forEach((function(t){t.forEach((function(t){t.reject(new qr(jr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),o.kl.clear(),n.pl.Qa(e,r.Ac,r.Rc),[4,hp(n,r.mc)];case 2:i.sent(),i.label=3;case 3:return[2]}var o}))}))}function lp(t,e,n,r){return d(this,void 0,void 0,(function(){var i,o;return y(this,(function(s){switch(s.label){case 0:return[4,(u=(i=t).Sh,a=e,h=(c=u).Ho,c.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return h.gi(t,a).next((function(e){return e?c.Ic.Zo(t,e):va.resolve(null)}))})))];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,Tl(i.gl)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(op(i,e,r||null),ip(i,e),i.Sh.Ho.Ni(e)):Dr(),s.label=4;case 4:return[4,hp(i,o)];case 5:return s.sent(),[3,7];case 6:Nr("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}var u,a,c,h}))}))}function pp(t,e){return d(this,void 0,void 0,(function(){var n,r,i,o,s,u,a,c;return y(this,(function(h){switch(h.label){case 0:return vp(n=t),gp(n),!0!==e||!0===n.Ll?[3,3]:(r=n.pl.Sa(),[4,dp(n,r.rt())]);case 1:return i=h.sent(),n.Ll=!0,[4,Al(n.gl,!0)];case 2:for(h.sent(),o=0,s=i;o<s.length;o++)u=s[o],pl(n.gl,u);return[3,7];case 3:return!1!==e||!1===n.Ll?[3,7]:(a=[],c=Promise.resolve(),n.Dl.forEach((function(t,e){n.pl.$a(e)?a.push(e):c=c.then((function(){return sp(n,e),zh(n.Sh,e,!0)})),dl(n.gl,e)})),[4,c]);case 4:return h.sent(),[4,dp(n,a)];case 5:return h.sent(),(f=n).Nl.forEach((function(t,e){dl(f.gl,e)})),f.Ol.Mc(),f.Nl=new Map,f.xl=new ou(wi.J),n.Ll=!1,[4,Al(n.gl,!1)];case 6:h.sent(),h.label=7;case 7:return[2]}var f}))}))}function dp(t,e){return d(this,void 0,void 0,(function(){var n,r,i,o,s,u,a,c,h,f,l,p;return y(this,(function(v){switch(v.label){case 0:n=t,r=[],i=[],o=0,s=e,v.label=1;case 1:return o<s.length?(u=s[o],a=void 0,(c=n.Dl.get(u))&&0!==c.length?[4,Gh(n.Sh,ns(c[0]))]:[3,7]):[3,13];case 2:a=v.sent(),h=0,f=c,v.label=3;case 3:return h<f.length?(l=f[h],l=n.Sl.get(l),[4,function(t,e){return d(this,void 0,void 0,(function(){var n,r;return y(this,(function(i){switch(i.label){case 0:return[4,Kh((n=t).Sh,e.query,!0)];case 1:return r=i.sent(),r=e.view.Rl(r),[2,(n.$l&&ap(n,e.targetId,r.ml),r)]}}))}))}(n,l)]):[3,6];case 4:(l=v.sent()).snapshot&&i.push(l.snapshot),v.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,Jh(n.Sh,u)];case 8:return p=v.sent(),[4,Gh(n.Sh,p)];case 9:return a=v.sent(),[4,$l(n,yp(p),u,!1)];case 10:v.sent(),v.label=11;case 11:r.push(a),v.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vl.uh(i),r)]}}))}))}function yp(t){return Wo(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function vp(t){return t.gl.Ch.Bh=tp.bind(null,t),t.gl.Ch.Sn=function(t,e){var n=t;if((t=n.Nl.get(e))&&t.yl)return bu().add(t.key);var r=bu();if(!(e=n.Dl.get(e)))return r;for(var i=0,o=e;i<o.length;i++){var s=o[i];s=n.Sl.get(s),r=r.ye(s.view.fl)}return r}.bind(null,t),t.gl.Ch.$h=function(t,e,n){return d(this,void 0,void 0,(function(){var r,i,o,s;return y(this,(function(u){switch(u.label){case 0:return(r=t).pl.qa(e,"rejected",n),s=r.Nl.get(e),(i=s&&s.key)?(o=(o=new ou(wi.J)).Ht(i,new so(i,yi.min())),s=bu().add(i),s=new Nu(yi.min(),new Map,new lu(Lr),o,s),[4,tp(r,s)]):[3,2];case 1:return u.sent(),r.xl=r.xl.remove(i),r.Nl.delete(e),cp(r),[3,4];case 2:return[4,zh(r.Sh,e,!1).then((function(){return sp(r,e,n)})).catch(Mc)];case 3:u.sent(),u.label=4;case 4:return[2]}}))}))}.bind(null,t),t.vl.uh=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.queries.get(u)){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Hh(s)&&(r=!0);u.jh=s}}r&&Cl(n)}.bind(null,t.Vl),t.vl.ql=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,t.Vl),t}function gp(t){return t.gl.Ch.qh=function(t,e){return d(this,void 0,void 0,(function(){var n,r,i;return y(this,(function(o){switch(o.label){case 0:n=t,r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,qh(n.Sh,e)];case 2:return i=o.sent(),op(n,r,null),ip(n,r),n.pl.Oa(r,"acknowledged"),[4,hp(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Mc(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}.bind(null,t),t.gl.Ch.Uh=np.bind(null,t),t}function mp(t,e,n){var r=t;(function(t,e,n){return d(this,void 0,void 0,(function(){var r,i,o,s,u;return y(this,(function(a){switch(a.label){case 0:return a.trys.push([0,14,,15]),[4,e.getMetadata()];case 1:return r=a.sent(),[4,(f=t.Sh,p=f,d=Ku((l=r).createTime),p.persistence.runTransaction("hasNewerBundle","readonly",(function(t){return p.Eo.Ms(t,l.id)})).then((function(t){return!!t&&0<=t.createTime.u(d)})))];case 2:return a.sent()?[4,e.close()]:[3,4];case 3:return[2,(a.sent(),void n.Ul({taskState:"Success",documentsLoaded:r.totalDocuments,bytesLoaded:r.totalBytes,totalDocuments:r.totalDocuments,totalBytes:r.totalBytes}))];case 4:return n.Ql(Bl(r)),i=new Ul(r,t.Sh,e.Kt),[4,e.Kl()];case 5:o=a.sent(),a.label=6;case 6:return o?[4,i.ol(o)]:[3,10];case 7:return(s=a.sent())&&n.Ql(s),[4,e.Kl()];case 8:o=a.sent(),a.label=9;case 9:return[3,6];case 10:return[4,i.complete()];case 11:return u=a.sent(),[4,hp(t,u.zo,void 0)];case 12:return a.sent(),[4,(f=t.Sh,c=r,(h=f).persistence.runTransaction("Save bundle","readwrite",(function(t){return h.Eo.Ls(t,c)})))];case 13:return a.sent(),n.Ul(u.progress),[3,15];case 14:return Ar("SyncEngine","Loading bundle failed with "+(u=a.sent())),n.jl(u),[3,15];case 15:return[2]}var c,h,f,l,p,d}))}))})(r,e,n).then((function(){r.pl.Wa()}))}var wp,bp,Ip=(xp.prototype.initialize=function(t){return d(this,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return this.Kt=Xf(t.gu.T),this.pl=this.Wl(t),this.persistence=this.Gl(t),[4,this.persistence.start()];case 1:return e.sent(),this.zl=this.Hl(t),this.Sh=this.Jl(t),[2]}}))}))},xp.prototype.Hl=function(t){return null},xp.prototype.Jl=function(t){return Uh(this.persistence,new Ph,t.Yl,this.Kt)},xp.prototype.Gl=function(t){return new sf(af.ra,this.Kt)},xp.prototype.Wl=function(t){return new Df},xp.prototype.terminate=function(){return d(this,void 0,void 0,(function(){return y(this,(function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.pl.Lo()];case 1:return t.sent(),[4,this.persistence.Lo()];case 2:return t.sent(),[2]}}))}))},xp),_p=(p(Ap,bp=Ip),Ap.prototype.initialize=function(t){return d(this,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return[4,bp.prototype.initialize.call(this,t)];case 1:return e.sent(),[4,Xh(this.Sh)];case 2:return e.sent(),[4,this.Xl.initialize(this,t)];case 3:return e.sent(),[4,gp(this.Xl.fa)];case 4:return e.sent(),[4,Tl(this.Xl.gl)];case 5:return e.sent(),[2]}}))}))},Ap.prototype.Jl=function(t){return Uh(this.persistence,new Ph,t.Yl,this.Kt)},Ap.prototype.Hl=function(t){var e=this.persistence.Ii._r;return new ih(e,t.fs)},Ap.prototype.Gl=function(t){var e=xh(t.gu.T,t.gu.persistenceKey),n=void 0!==this.cacheSizeBytes?Rc.Xs(this.cacheSizeBytes):Rc.ei;return new Th(this.synchronizeTabs,e,t.clientId,n,t.fs,Jf(),Wf(),this.Kt,this.pl,!!this.forceOwnership)},Ap.prototype.Wl=function(t){return new Df},Ap),Ep=(p(Sp,wp=_p),Sp.prototype.initialize=function(t){return d(this,void 0,void 0,(function(){var e,n=this;return y(this,(function(r){switch(r.label){case 0:return[4,wp.prototype.initialize.call(this,t)];case 1:return r.sent(),e=this.Xl.fa,this.pl instanceof xf?(this.pl.fa={nu:lp.bind(null,e),su:function(t,e,n,r){return d(this,void 0,void 0,(function(){var i,o,s;return y(this,(function(u){switch(u.label){case 0:return(i=t).Ll?(Nr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Dl.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Wh(i.Sh)];case 3:return o=u.sent(),s=Nu.$e(e,"current"===n),[4,hp(i,o,s)];case 4:return u.sent(),[3,8];case 5:return[4,zh(i.Sh,e,!0)];case 6:return u.sent(),sp(i,e,r),[3,8];case 7:Dr(),u.label=8;case 8:return[2]}}))}))}.bind(null,e),iu:function(t,e,n){return d(this,void 0,void 0,(function(){var r,i,o,s,u,a,c,h;return y(this,(function(f){switch(f.label){case 0:if(!(r=vp(t)).Ll)return[3,10];i=0,o=e,f.label=1;case 1:return i<o.length?(o=o[i],r.Dl.has(o)?(Nr("SyncEngine","Adding an already active target "+o),[3,5]):[4,Jh(r.Sh,o)]):[3,6];case 2:return s=f.sent(),[4,Gh(r.Sh,s)];case 3:return u=f.sent(),[4,$l(r,yp(s),u.targetId,!1)];case 4:f.sent(),pl(r.gl,u),f.label=5;case 5:return i++,[3,1];case 6:a=function(t){return y(this,(function(e){switch(e.label){case 0:return r.Dl.has(t)?[4,zh(r.Sh,t,!1).then((function(){dl(r.gl,t),sp(r,t)})).catch(Mc)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},c=0,h=n,f.label=7;case 7:return c<h.length?(h=h[c],[5,a(h)]):[3,10];case 8:f.sent(),f.label=9;case 9:return c++,[3,7];case 10:return[2]}}))}))}.bind(null,e),Qo:function(t){return t.Sh.persistence.Qo()}.bind(null,e),eu:function(t){return d(this,void 0,void 0,(function(){var e;return y(this,(function(n){return[2,Wh((e=t).Sh).then((function(t){return hp(e,t)}))]}))}))}.bind(null,e)},[4,this.pl.start()]):[3,3];case 2:r.sent(),r.label=3;case 3:return[4,this.persistence.Po((function(t){return d(n,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return[4,pp(this.Xl.fa,t)];case 1:return e.sent(),this.zl&&(t&&!this.zl.Tr?this.zl.start(this.Sh):t||this.zl.stop()),[2]}}))}))}))];case 4:return r.sent(),[2]}}))}))},Sp.prototype.Wl=function(t){var e=Jf();if(!xf.jn(e))throw new qr(jr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=xh(t.gu.T,t.gu.persistenceKey);return new xf(e,t.fs,n,t.clientId,t.Yl)},Sp),Tp=(Np.prototype.initialize=function(t,e){return d(this,void 0,void 0,(function(){var n=this;return y(this,(function(r){switch(r.label){case 0:return this.Sh?[3,2]:(this.Sh=t.Sh,this.pl=t.pl,this.Dh=this.Zl(e),this.gl=this.t_(e),this.Vl=this.e_(e),this.fa=this.n_(e,!t.synchronizeTabs),this.pl.da=function(t){return ep(n.fa,t,1)},this.gl.Ch.s_=fp.bind(null,this.fa),[4,Al(this.gl,this.fa.$l)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},Np.prototype.e_=function(t){return new Ol},Np.prototype.Zl=function(t){var e=Xf(t.gu.T),n=(n=t.gu,new Cf(n));return t=t.credentials,new rl(t,n,e)},Np.prototype.t_=function(t){var e=this;return new Yf(this.Sh,this.Dh,t.fs,(function(t){return ep(e.fa,t,0)}),t=new(kf.jn()?kf:Of))},Np.prototype.n_=function(t,e){return function(t,e,n,r,i,o,s){return o=new Xl(t,e,n,r,i,o),s&&(o.Ll=!0),o}(this.Sh,this.gl,this.Vl,this.pl,t.Yl,t.bl,e)},Np.prototype.terminate=function(){return function(t){return d(this,void 0,void 0,(function(){var e;return y(this,(function(n){switch(n.label){case 0:return e=t,Nr("RemoteStore","RemoteStore shutting down."),e.Oh.add(5),[4,ll(e)];case 1:return n.sent(),e.kh.Lo(),e.Mh.set("Unknown"),[2]}}))}))}(this.gl)},Np);function Np(){}function Sp(t,e){var n=this;return(n=wp.call(this,t,e,!1)||this).Xl=t,n.cacheSizeBytes=e,n.synchronizeTabs=!0,n}function Ap(t,e,n){var r=this;return(r=bp.call(this)||this).Xl=t,r.cacheSizeBytes=e,r.forceOwnership=n,r.synchronizeTabs=!1,r}function xp(){this.synchronizeTabs=!1}function Dp(t,e){void 0===e&&(e=10240);var n=0;return{read:function(){return d(this,void 0,void 0,(function(){var r;return y(this,(function(i){return n<t.byteLength?(r={value:t.slice(n,n+e),done:!1},[2,(n+=e,r)]):[2,{done:!0}]}))}))},cancel:function(){return d(this,void 0,void 0,(function(){return y(this,(function(t){return[2]}))}))},releaseLock:function(){}}}var Op=(Vp.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},Vp.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Vp.prototype.r_=function(){this.muted=!0},Vp.prototype.i_=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},Vp),kp=(Rp.prototype.close=function(){return this.o_.cancel()},Rp.prototype.getMetadata=function(){return d(this,void 0,void 0,(function(){return y(this,(function(t){return[2,this.metadata.promise]}))}))},Rp.prototype.Kl=function(){return d(this,void 0,void 0,(function(){return y(this,(function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.a_())]}}))}))},Rp.prototype.a_=function(){return d(this,void 0,void 0,(function(){var t,e,n;return y(this,(function(r){switch(r.label){case 0:return[4,this.u_()];case 1:return null===(t=r.sent())?[2,null]:(n=this.c_.decode(t),e=Number(n),isNaN(e)&&this.h_("length string ("+n+") is not valid number"),[4,this.l_(e)]);case 2:return n=r.sent(),[2,new Vl(JSON.parse(n),t.length+e)]}}))}))},Rp.prototype.__=function(){return this.buffer.findIndex((function(t){return t==="{".charCodeAt(0)}))},Rp.prototype.u_=function(){return d(this,void 0,void 0,(function(){var t,e;return y(this,(function(n){switch(n.label){case 0:return this.__()<0?[4,this.f_()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.__())<0&&this.h_("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}}))}))},Rp.prototype.l_=function(t){return d(this,void 0,void 0,(function(){var e;return y(this,(function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.f_()]:[3,3];case 1:n.sent()&&this.h_("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.c_.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}}))}))},Rp.prototype.h_=function(t){throw this.o_.cancel(),new Error("Invalid bundle format: "+t)},Rp.prototype.f_=function(){return d(this,void 0,void 0,(function(){var t,e;return y(this,(function(n){switch(n.label){case 0:return[4,this.o_.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}}))}))},Rp),Pp=(Cp.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},Cp),Lp=function(t){this._methodName=t};function Cp(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new qr(jr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.d_=new mi(t)}function Rp(t,e){var n=this;this.o_=t,this.Kt=e,this.metadata=new ya,this.buffer=new Uint8Array,this.c_=new TextDecoder("utf-8"),this.a_().then((function(t){t&&t.il()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))}),(function(t){return n.metadata.reject(t)}))}function Vp(t){this.observer=t,this.muted=!1}function Mp(t,e,n){if(!n)throw new qr(jr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Up(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new qr(jr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function jp(t,e,n,r){if(!0===e&&!0===r)throw new qr(jr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function qp(t){if(!wi.Et(t))throw new qr(jr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Fp(t){if(wi.Et(t))throw new qr(jr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Hp(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return 20<t.length&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"!=typeof t)return"function"==typeof t?"a function":Dr();if(t instanceof Array)return"an array";var e=function(){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&1<e.length)return e[1]}return null}();return e?"a custom "+e+" object":"an object"}function Bp(t,e){if("_delegate"in t&&(t=t._),t instanceof e)return t;if(e.name===t.constructor.name)throw new qr(jr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");throw t=Hp(t),new qr(jr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function Gp(t,e){if(e<=0)throw new qr(jr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var zp,Kp=(nd.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},nd),Jp=new Map,Wp=(Object.defineProperty(ed.prototype,"app",{get:function(){if(!this.A_)throw new qr(jr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(ed.prototype,"R_",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Object.defineProperty(ed.prototype,"P_",{get:function(){return void 0!==this.y_},enumerable:!1,configurable:!0}),ed.prototype.g_=function(t){if(this.T_)throw new qr(jr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.E_=new Kp(t),void 0!==t.credentials&&(this.m_=function(t){if(!t)return new ni;switch(t.type){case"gapi":var e=t.client;return Or(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new oi(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new qr(jr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},ed.prototype.V_=function(){return this.E_},ed.prototype.p_=function(){return this.T_=!0,this.E_},ed.prototype._delete=function(){return this.y_||(this.y_=this.b_()),this.y_},ed.prototype.b_=function(){return(t=Jp.get(this))&&(Nr("ComponentProvider","Removing Datastore"),Jp.delete(this),t.terminate()),Promise.resolve();var t},ed),Xp=(Object.defineProperty(td.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(td.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(td.prototype,"path",{get:function(){return this.S_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(td.prototype,"parent",{get:function(){return new Qp(this.firestore,this.v_,this.S_.path.Z())},enumerable:!1,configurable:!0}),td.prototype.withConverter=function(t){return new td(this.firestore,t,this.S_)},td),Yp=(Zp.prototype.withConverter=function(t){return new Zp(this.firestore,t,this.C_)},Zp),Qp=(p($p,zp=Yp),Object.defineProperty($p.prototype,"id",{get:function(){return this.C_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty($p.prototype,"path",{get:function(){return this.C_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty($p.prototype,"parent",{get:function(){var t=this.D_.Z();return t.nt()?null:new Xp(this.firestore,null,new wi(t))},enumerable:!1,configurable:!0}),$p.prototype.withConverter=function(t){return new $p(this.firestore,t,this.D_)},$p);function $p(t,e,n){var r=this;return(r=zp.call(this,t,e,Xo(n))||this).firestore=t,r.D_=n,r.type="collection",r}function Zp(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}function td(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}function ed(t,e){this.w_="(lite)",this.E_=new Kp({}),this.T_=!1,t instanceof Yr?(this.I_=t,this.m_=new ni):(this.A_=t,this.I_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new qr(jr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Yr(t.options.projectId)}(t),this.m_=new ri(e))}function nd(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new qr(jr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new qr(jr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,jp("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function rd(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Hr&&(t=t._),Mp("collection","path",e),t instanceof Wp)return Fp(n=vi.ct.apply(vi,v([e],r))),new Qp(t,null,n);if(!(t instanceof Xp||t instanceof Qp))throw new qr(jr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Fp(n=vi.ct.apply(vi,v([t.path],r)).child(vi.ct(e))),new Qp(t.firestore,null,n)}function id(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Hr&&(t=t._),1===arguments.length&&(e=kr.t()),Mp("doc","path",e),t instanceof Wp)return qp(n=vi.ct.apply(vi,v([e],r))),new Xp(t,null,new wi(n));if(!(t instanceof Xp||t instanceof Qp))throw new qr(jr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return qp(n=t.D_.child(vi.ct.apply(vi,v([e],r)))),new Xp(t.firestore,t instanceof Qp?t.v_:null,new wi(n))}function od(t,e){return t instanceof Hr&&(t=t._),e instanceof Hr&&(e=e._),(t instanceof Xp||t instanceof Qp)&&(e instanceof Xp||e instanceof Qp)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function sd(t,e){return t instanceof Hr&&(t=t._),e instanceof Hr&&(e=e._),t instanceof Yp&&e instanceof Yp&&t.firestore===e.firestore&&is(t.C_,e.C_)&&t.v_===e.v_}var ud=(Object.defineProperty(pd.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),pd.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},pd.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},pd.prototype.K=function(t){return Lr(this.x_,t.x_)||Lr(this.N_,t.N_)},pd),ad=/^__.*__$/,cd=(ld.prototype.O_=function(t,e){return null!==this.zt?new Hs(t,this.data,this.zt,e,this.fieldTransforms):new Fs(t,this.data,e,this.fieldTransforms)},ld),hd=(fd.prototype.O_=function(t,e){return new Hs(t,this.data,this.zt,e,this.fieldTransforms)},fd);function fd(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}function ld(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}function pd(t,e){if(!isFinite(t)||t<-90||90<t)throw new qr(jr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new qr(jr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}function dd(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Dr()}}var yd=(Object.defineProperty(md.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(md.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),md.prototype.M_=function(t){return new md(Object.assign(Object.assign({},this.settings),t),this.T,this.Kt,this.ignoreUndefinedProperties,this.fieldTransforms,this.zt)},md.prototype.L_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.M_({path:e,B_:!1})).q_(t),e},md.prototype.U_=function(t){var e;return t=null===(e=this.path)||void 0===e?void 0:e.child(t),(t=this.M_({path:t,B_:!1})).F_(),t},md.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},md.prototype.K_=function(t){return Jd(t,this.settings.methodName,this.settings.j_||!1,this.path,this.settings.W_)},md.prototype.contains=function(t){return void 0!==this.zt.find((function(e){return t.st(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.st(e.field)}))},md.prototype.F_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},md.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(dd(this.k_)&&ad.test(t))throw this.K_('Document fields cannot begin and end with "__"')},md),vd=(gd.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new yd({k_:t,methodName:e,W_:n,path:mi.at(),B_:!1,j_:r},this.T,this.Kt,this.ignoreUndefinedProperties)},gd);function gd(t,e,n){this.T=t,this.ignoreUndefinedProperties=e,this.Kt=n||Xf(t)}function md(t,e,n,r,i,o){this.settings=t,this.T=e,this.Kt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.F_(),this.fieldTransforms=i||[],this.zt=o||[]}function wd(t){var e=t.p_(),n=Xf(t.I_);return new vd(t.I_,!!e.ignoreUndefinedProperties,n)}function bd(t,e,n,r,i,o){void 0===o&&(o={});var s,u,a=t.G_(o.merge||o.mergeFields?2:0,e,n,i);if(Bd("Data must be an object, but it was:",a,r),r=Fd(r,a),o.merge)s=new Di(a.zt),u=a.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=Gd(e,f[h],n);if(!a.contains(l))throw new qr(jr.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");Wd(c,l)||c.push(l)}s=new Di(c),u=a.fieldTransforms.filter((function(t){return s.It(t.field)}))}else s=null,u=a.fieldTransforms;return new cd(new $i(r),s,u)}var Id,_d=(p(Ed,Id=Lp),Ed.prototype.z_=function(t){if(2!==t.k_)throw 1===t.k_?t.K_(this._methodName+"() can only appear at the top level of your update data"):t.K_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.zt.push(t.path),null},Ed.prototype.isEqual=function(t){return t instanceof Ed},Ed);function Ed(){return null!==Id&&Id.apply(this,arguments)||this}function Td(t,e,n){return new yd({k_:3,W_:e.settings.W_,methodName:t._methodName,B_:n},e.T,e.Kt,e.ignoreUndefinedProperties)}var Nd,Sd,Ad,xd,Dd=(p(Vd,xd=Lp),Vd.prototype.z_=function(t){return new Ps(t.path,new gs)},Vd.prototype.isEqual=function(t){return t instanceof Vd},Vd),Od=(p(Rd,Ad=Lp),Rd.prototype.z_=function(t){var e=Td(this,t,!0),n=this.H_.map((function(t){return qd(t,e)}));return n=new ms(n),new Ps(t.path,n)},Rd.prototype.isEqual=function(t){return this===t},Rd),kd=(p(Cd,Sd=Lp),Cd.prototype.z_=function(t){var e=Td(this,t,!0),n=this.H_.map((function(t){return qd(t,e)}));return n=new Es(n),new Ps(t.path,n)},Cd.prototype.isEqual=function(t){return this===t},Cd),Pd=(p(Ld,Nd=Lp),Ld.prototype.z_=function(t){var e=new As(t.Kt,ps(t.Kt,this.J_));return new Ps(t.path,e)},Ld.prototype.isEqual=function(t){return this===t},Ld);function Ld(t,e){var n=this;return(n=Nd.call(this,t)||this).J_=e,n}function Cd(t,e){var n=this;return(n=Sd.call(this,t)||this).H_=e,n}function Rd(t,e){var n=this;return(n=Ad.call(this,t)||this).H_=e,n}function Vd(){return null!==xd&&xd.apply(this,arguments)||this}function Md(t,e,n,r){var i=t.G_(1,e,n);Bd("Data must be an object, but it was:",i,r);var o=[],s=new Zi;return Ai(r,(function(t,r){var u=Kd(e,t,n);r instanceof Hr&&(r=r._),t=i.U_(u),r instanceof _d?o.push(u):null!=(t=qd(r,t))&&(o.push(u),s.set(u,t))})),r=new Di(o),new hd(s.yt(),r,i.fieldTransforms)}function Ud(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[Gd(e,r,n)],a=[i];if(o.length%2!=0)throw new qr(jr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Gd(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new Zi,y=u.length-1;0<=y;--y)Wd(p,u[y])||(h=u[y],(f=a[y])instanceof Hr&&(f=f._),l=s.U_(h),f instanceof _d?p.push(h):null!=(l=qd(f,l))&&(p.push(h),d.set(h,l)));return i=new Di(p),new hd(d.yt(),i,s.fieldTransforms)}function jd(t,e,n,r){return void 0===r&&(r=!1),qd(n,t.G_(r?4:3,e))}function qd(t,e){if(t instanceof Hr&&(t=t._),Hd(t))return Bd("Unsupported field value:",e,t),Fd(t,e);if(t instanceof Lp)return function(t,e){if(!dd(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");(t=t.z_(e))&&e.fieldTransforms.push(t)}(t,e),null;if(e.path&&e.zt.push(e.path),t instanceof Array){if(e.settings.B_&&4!==e.k_)throw e.K_("Nested arrays are not supported");return function(e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=qd(o[i],e.Q_(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(e)}return function(t,e){if(t instanceof Hr&&(t=t._),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ps(e.Kt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=di.fromDate(t);return{timestampValue:Gu(e.Kt,n)}}if(t instanceof di)return n=new di(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Gu(e.Kt,n)};if(t instanceof ud)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Fr)return{bytesValue:zu(e.Kt,t.l)};if(t instanceof Xp){n=e.T;var r=t.firestore.I_;if(!r.isEqual(n))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Ju(t.firestore.I_||e.T,t.S_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.K_("Unsupported field value: "+Hp(t))}(t,e)}function Fd(t,e){var n={};return xi(t)?e.path&&0<e.path.length&&e.zt.push(e.path):Ai(t,(function(t,r){null!=(r=qd(r,e.L_(t)))&&(n[t]=r)})),{mapValue:{fields:n}}}function Hd(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof di||t instanceof ud||t instanceof Fr||t instanceof Xp||t instanceof Lp)}function Bd(t,e,n){if(!Hd(n)||"object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))throw"an object"===(n=Hp(n))?e.K_(t+" a custom object"):e.K_(t+" "+n);var r}function Gd(t,e,n){if(e instanceof Hr&&(e=e._),e instanceof Pp)return e.d_;if("string"==typeof e)return Kd(t,e);throw Jd("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var zd=new RegExp("[~\\*/\\[\\]]");function Kd(t,e,n){if(0<=e.search(zd))throw Jd("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(Pp.bind.apply(Pp,v([void 0],e.split("."))))).d_}catch(r){throw Jd("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Jd(t,e,n,r,i){var o=r&&!r.nt(),s=void 0!==i;return e="Function "+e+"() called with invalid data",n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new qr(jr.INVALID_ARGUMENT,(e+=". ")+t+n)}function Wd(t,e){return t.some((function(t){return t.isEqual(e)}))}var Xd=(ty.prototype.ef=function(t){return d(this,void 0,void 0,(function(){var e,n=this;return y(this,(function(r){switch(r.label){case 0:if(this.nf(),0<this.mutations.length)throw new qr(jr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return d(this,void 0,void 0,(function(){var n,r,i,o,s;return y(this,(function(u){switch(u.label){case 0:return r=Zu((n=t).Kt)+"/documents",i={documents:e.map((function(t){return Xu(n.Kt,t)}))},[4,n.Cu("BatchGetDocuments",r,i)];case 1:return i=u.sent(),o=new Map,i.forEach((function(t){var e;e=n.Kt,t="found"in(t=t)?function(t,e){Or(!!e.found),e.found.name,e.found.updateTime;var n=Yu(t,e.found.name);return t=Ku(e.found.updateTime),e=new $i({mapValue:{fields:e.found.fields}}),new oo(n,t,e,{})}(e,t):"missing"in t?function(t,e){return Or(!!e.missing),Or(!!e.readTime),t=Yu(t,e.missing),e=Ku(e.readTime),new so(t,e)}(e,t):Dr(),o.set(t.key.toString(),t)})),s=[],[2,(e.forEach((function(t){Or(!!(t=o.get(t.toString()))),s.push(t)})),s)]}}))}))}(this.Dh,t)];case 1:return[2,((e=r.sent()).forEach((function(t){t instanceof so||t instanceof oo?n.sf(t):Dr()})),e)]}}))}))},ty.prototype.set=function(t,e){this.write(e.O_(t,this.Gt(t))),this.tf.add(t.toString())},ty.prototype.update=function(t,e){try{this.write(e.O_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},ty.prototype.delete=function(t){this.write(new Zs(t,this.Gt(t))),this.tf.add(t.toString())},ty.prototype.commit=function(){return d(this,void 0,void 0,(function(){var t,e=this;return y(this,(function(n){switch(n.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return t=this.Y_,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){n=wi.ft(n),e.mutations.push(new tu(n,e.Gt(n)))})),[4,function(t,e){return d(this,void 0,void 0,(function(){var n,r,i;return y(this,(function(o){switch(o.label){case 0:return r=Zu((n=t).Kt)+"/documents",i={writes:e.map((function(t){return ra(n.Kt,t)}))},[4,n.bu("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.Dh,this.mutations)];case 1:return n.sent(),this.X_=!0,[2]}}))}))},ty.prototype.sf=function(t){var e;if(t instanceof oo)e=t.version;else{if(!(t instanceof so))throw Dr();e=yi.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new qr(jr.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},ty.prototype.Gt=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?Ls.updateTime(e):Ls.jt()},ty.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(this.tf.has(t.toString())||!e)return Ls.exists(!0);if(e.isEqual(yi.min()))throw new qr(jr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ls.updateTime(e)},ty.prototype.write=function(t){this.nf(),this.mutations.push(t)},ty.prototype.nf=function(){},ty),Yd=(Zd.prototype.run=function(){this.af()},Zd.prototype.af=function(){var t=this;this.zu.Bu((function(){return d(t,void 0,void 0,(function(){var t,e,n=this;return y(this,(function(r){return t=new Xd(this.Dh),(e=this.uf(t))&&e.then((function(e){n.fs.ys((function(){return t.commit().then((function(){n.Ts.resolve(e)})).catch((function(t){n.hf(t)}))}))})).catch((function(t){n.hf(t)})),[2]}))}))}))},Zd.prototype.uf=function(t){try{var e=this.updateFunction(t);return!Mi(e)&&e.catch&&e.then?e:(this.Ts.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ts.reject(t),null}},Zd.prototype.hf=function(t){var e=this;0<this.cf&&this.lf(t)?(--this.cf,this.fs.ys((function(){return e.af(),Promise.resolve()}))):this.Ts.reject(t)},Zd.prototype.lf=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!ru(t))},Zd),Qd=($d.prototype.getConfiguration=function(){return d(this,void 0,void 0,(function(){return y(this,(function(t){switch(t.label){case 0:return[4,this.N.promise];case 1:return[2,(t.sent(),{fs:this.fs,gu:this.gu,clientId:this.clientId,credentials:this.credentials,Yl:this.user,bl:100})]}}))}))},$d.prototype.ff=function(t){var e=this;this._f=t,this.N.promise.then((function(){return e._f(e.user)}))},$d.prototype.df=function(){if(this.fs.wf)throw new qr(jr.FAILED_PRECONDITION,"The client has already been terminated.")},$d.prototype.terminate=function(){var t=this;this.fs.Ef();var e=new ya;return this.fs.Tf((function(){return d(t,void 0,void 0,(function(){var t;return y(this,(function(n){switch(n.label){case 0:return n.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:n.sent(),n.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:n.sent(),n.label=4;case 4:return this.credentials.D(),e.resolve(),[3,6];case 5:return t=Ca(t=n.sent(),"Failed to shutdown persistence"),e.reject(t),[3,6];case 6:return[2]}}))}))})),e.promise},$d);function $d(t,e,n){var r=this;this.credentials=t,this.fs=e,this.gu=n,this.user=Qr.UNAUTHENTICATED,this.clientId=kr.t(),this._f=function(){},this.N=new ya,this.credentials.S((function(t){Nr("FirestoreClient","Received user=",t.uid),r.user=t,r._f(t),r.N.resolve()}))}function Zd(t,e,n,r){this.fs=t,this.Dh=e,this.updateFunction=n,this.Ts=r,this.cf=5,this.zu=new tl(this.fs,"transaction_retry")}function ty(t){this.Dh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}function ey(t,e){return d(this,void 0,void 0,(function(){var n,r,i=this;return y(this,(function(o){switch(o.label){case 0:return t.fs.Af(),Nr("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.Yl,t.ff((function(n){r.isEqual(n)||(r=n,t.fs.bo((function(){return d(i,void 0,void 0,(function(){return y(this,(function(t){switch(t.label){case 0:return[4,jh(e.Sh,n)];case 1:return t.sent(),[2]}}))}))})))})),e.persistence.yo((function(){return t.terminate()})),t.mf=e,[2]}}))}))}function ny(t,e){return d(this,void 0,void 0,(function(){var n,r;return y(this,(function(i){switch(i.label){case 0:return t.fs.Af(),[4,ry(t)];case 1:return n=i.sent(),Nr("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.ff((function(n){return t.fs.bo((function(){return function(t,e){return d(this,void 0,void 0,(function(){var n,r;return y(this,(function(i){switch(i.label){case 0:return(n=t).fs.Af(),Nr("RemoteStore","RemoteStore received new credentials"),r=wl(n),n.Oh.add(3),[4,ll(n)];case 1:return i.sent(),r&&n.Mh.set("Unknown"),[4,n.Ch.s_(e)];case 2:return i.sent(),n.Oh.delete(3),[4,fl(n)];case 3:return i.sent(),[2]}}))}))}(e.gl,n)}))})),t.If=e,[2]}}))}))}function ry(t){return d(this,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return t.mf?[3,2]:(Nr("FirestoreClient","Using default OfflineComponentProvider"),[4,ey(t,new Ip)]);case 1:e.sent(),e.label=2;case 2:return[2,t.mf]}}))}))}function iy(t){return d(this,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return t.If?[3,2]:(Nr("FirestoreClient","Using default OnlineComponentProvider"),[4,ny(t,new Tp)]);case 1:e.sent(),e.label=2;case 2:return[2,t.If]}}))}))}function oy(t){return ry(t).then((function(t){return t.persistence}))}function sy(t){return ry(t).then((function(t){return t.Sh}))}function uy(t){return iy(t).then((function(t){return t.gl}))}function ay(t){return iy(t).then((function(t){return t.fa}))}function cy(t){return d(this,void 0,void 0,(function(){var e,n;return y(this,(function(r){switch(r.label){case 0:return[4,iy(t)];case 1:return e=r.sent(),[2,((n=e.Vl).Gh=function(t,e){return d(this,void 0,void 0,(function(){var n,r,i,o,s;return y(this,(function(u){switch(u.label){case 0:return n=vp(t),(s=n.Sl.get(e))?(r=s.targetId,n.pl.ka(r),i=s.view.Pl(),[3,4]):[3,1];case 1:return[4,Gh(n.Sh,ns(e))];case 2:return o=u.sent(),s=n.pl.ka(o.targetId),r=o.targetId,[4,$l(n,e,r,"current"===s)];case 3:i=u.sent(),n.$l&&pl(n.gl,o),u.label=4;case 4:return[2,i]}}))}))}.bind(null,e.fa),n.Jh=function(t,e){return d(this,void 0,void 0,(function(){var n,r,i;return y(this,(function(o){switch(o.label){case 0:return r=(n=t).Sl.get(e),1<(i=n.Dl.get(r.targetId)).length?[2,(n.Dl.set(r.targetId,i.filter((function(t){return!is(t,e)}))),void n.Sl.delete(e))]:n.$l?(n.pl.La(r.targetId),n.pl.Ca(r.targetId)?[3,2]:[4,zh(n.Sh,r.targetId,!1).then((function(){n.pl.Ba(r.targetId),dl(n.gl,r.targetId),sp(n,r.targetId)})).catch(Mc)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return sp(n,r.targetId),[4,zh(n.Sh,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}.bind(null,e.fa),n)]}}))}))}function hy(t,e,n){var r=this;void 0===n&&(n={});var i=new ya;return t.fs.ys((function(){return d(r,void 0,void 0,(function(){var r;return y(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Op({next:function(o){e.ys((function(){return Ll(t,s)}));var u=o.docs.has(n);!u&&o.fromCache?i.reject(new qr(jr.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&o.fromCache&&r&&"server"===r.source?i.reject(new qr(jr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new Rl(Xo(n.path),o,{includeMetadataChanges:!0,sl:!0});return Pl(t,s)},[4,cy(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.fs,e,n,i])]}}))}))})),i.promise}function fy(t,e,n){var r=this;void 0===n&&(n={});var i=new ya;return t.fs.ys((function(){return d(r,void 0,void 0,(function(){var r;return y(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Op({next:function(n){e.ys((function(){return Ll(t,s)})),n.fromCache&&"server"===r.source?i.reject(new qr(jr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new Rl(n,o,{includeMetadataChanges:!0,sl:!0});return Pl(t,s)},[4,cy(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.fs,e,n,i])]}}))}))})),i.promise}var ly,py=(Object.defineProperty(vy.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),vy.prototype.ys=function(t){this.enqueue(t)},vy.prototype.Tf=function(t){this.Sf(),this.Df(t)},vy.prototype.Ef=function(){var t;this.yf||(this.yf=!0,(t=Wf())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf))},vy.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise((function(t){})):this.Df(t)},vy.prototype.bo=function(t){var e=this;this.ys((function(){return e.Pf.push(t),e.Cf()}))},vy.prototype.Cf=function(){return d(this,void 0,void 0,(function(){var t,e=this;return y(this,(function(n){switch(n.label){case 0:if(0===this.Pf.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return n.sent(),this.Pf.shift(),this.zu.reset(),[3,4];case 3:if(!Sa(t=n.sent()))throw t;return Nr("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:0<this.Pf.length&&this.zu.Bu((function(){return e.Cf()})),n.label=5;case 5:return[2]}}))}))},vy.prototype.Df=function(t){var e=this,n=this.Rf.then((function(){return e.pf=!0,t().catch((function(t){throw e.Vf=t,e.pf=!1,Sr("INTERNAL UNHANDLED ERROR: ",(r=(n=t).message||"",n.stack&&(r=n.stack.includes(n.message)?n.stack:n.message+"\n"+n.stack),r)),t;var n,r})).then((function(t){return e.pf=!1,t}))}));return this.Rf=n},vy.prototype.Ir=function(t,e,n){var r=this;return this.Sf(),-1<this.bf.indexOf(t)&&(e=0),n=Pa.Is(this,t,e,n,(function(t){return r.xf(t)})),this.gf.push(n),n},vy.prototype.Sf=function(){this.Vf&&Dr()},vy.prototype.Af=function(){},vy.prototype.Nf=function(){return d(this,void 0,void 0,(function(){var t;return y(this,(function(e){switch(e.label){case 0:return[4,t=this.Rf];case 1:e.sent(),e.label=2;case 2:if(t!==this.Rf)return[3,0];e.label=3;case 3:return[2]}}))}))},vy.prototype.Of=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].ds===t)return!0;return!1},vy.prototype.Ff=function(t){var e=this;return this.Nf().then((function(){e.gf.sort((function(t,e){return t.ws-e.ws}));for(var n=0,r=e.gf;n<r.length;n++){var i=r[n];if(i.Ps(),"all"!==t&&i.ds===t)break}return e.Nf()}))},vy.prototype.kf=function(t){this.bf.push(t)},vy.prototype.xf=function(t){t=this.gf.indexOf(t),this.gf.splice(t,1)},vy),dy=(p(yy,ly=Wp),yy.prototype.b_=function(){return this.Lf||my(this),this.Lf.terminate()},yy);function yy(t,e){var n=this;return(n=ly.call(this,t,e)||this).Mf=new py,n.w_="name"in t?t.name:"[DEFAULT]",n}function vy(){var t=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.zu=new tl(this,"async_queue_retry"),this.vf=function(){var e=Wf();e&&Nr("AsyncQueue","Visibility state changed to "+e.visibilityState),t.zu.Uu()};var e=Wf();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.vf)}function gy(t){return t.Lf||my(t),t.Lf.df(),t.Lf}function my(t){var e,n,r=t.p_();e=t.I_,n=t.w_,r=new Xr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling),t.Lf=new Qd(t.m_,t.Mf,r)}function wy(t,e,n){var r=this,i=new ya;return t.fs.enqueue((function(){return d(r,void 0,void 0,(function(){var r;return y(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,ey(t,n)];case 1:return o.sent(),[4,ny(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!("FirebaseError"===(o=r=o.sent()).name?o.code===jr.FAILED_PRECONDITION||o.code===jr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&o instanceof DOMException)||22===o.code||20===o.code||11===o.code))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return i.promise}))}function by(t){if(t.R_||t.P_)throw new qr(jr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}Sy.prototype.$f=function(t,e){switch(void 0===e&&(e="none"),qi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Li(t.integerValue||t.doubleValue);case 3:return this.Bf(t.timestampValue);case 4:return this.qf(t,e);case 5:return t.stringValue;case 6:return this.Uf(Ci(t.bytesValue));case 7:return this.Qf(t.referenceValue);case 8:return this.Kf(t.geoPointValue);case 9:return this.jf(t.arrayValue,e);case 10:return this.Wf(t.mapValue,e);default:throw Dr()}},Sy.prototype.Wf=function(t,e){var n=this,r={};return Ai(t.fields||{},(function(t,i){r[t]=n.$f(i,e)})),r},Sy.prototype.Kf=function(t){return new ud(Li(t.latitude),Li(t.longitude))},Sy.prototype.jf=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.$f(t,e)}))},Sy.prototype.qf=function(t,e){switch(e){case"previous":var n=function t(e){return Ri(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==n?null:this.$f(n,e);case"estimate":return this.Bf(Vi(t));default:return null}},Sy.prototype.Bf=function(t){return t=Pi(t),new di(t.seconds,t.nanos)},Sy.prototype.Gf=function(t,e){var n=vi.ct(t);return Or(pa(n)),t=new Yr(n.get(1),n.get(3)),n=new wi(n.X(5)),t.isEqual(e)||Sr("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},h=Sy;var Iy,_y=(Object.defineProperty(Ny.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(Ny.prototype,"ref",{get:function(){return new Xp(this.zf,this.v_,this.S_)},enumerable:!1,configurable:!0}),Ny.prototype.exists=function(){return null!==this.Jf},Ny.prototype.data=function(){if(this.Jf){if(this.v_){var t=new Ey(this.zf,this.Hf,this.S_,this.Jf,null);return this.v_.fromFirestore(t)}return this.Hf.$f(this.Jf.vt())}},Ny.prototype.get=function(t){if(this.Jf&&null!==(t=this.Jf.data().field(Ay("DocumentSnapshot.get",t))))return this.Hf.$f(t)},Ny),Ey=(p(Ty,Iy=_y),Ty.prototype.data=function(){return Iy.prototype.data.call(this)},Ty);function Ty(){return null!==Iy&&Iy.apply(this,arguments)||this}function Ny(t,e,n,r,i){this.zf=t,this.Hf=e,this.S_=n,this.Jf=r,this.v_=i}function Sy(){}function Ay(t,e){return"string"==typeof e?Kd(t,e):(e instanceof Hr?e._:e).d_}function xy(t){if(Qo(t)&&0===t.Nt.length)throw new qr(jr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}function Dy(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++)t=i[r].Yf(t);return t}var Oy,ky,Py,Ly,Cy,Ry=(p(Gy,Cy=Ne=function(){}),Gy.prototype.Yf=function(t){var e=wd(t.firestore);return e=function(t,e,n,r,i,o){if(r.ht()){if("array-contains"===i||"array-contains-any"===i)throw new qr(jr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){Jy(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(Ky(n,t,c))}h={arrayValue:{values:s}}}else h=Ky(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Jy(o,i),h=jd(e,"where",o,"in"===i||"not-in"===i);var h=mo.create(r,i,h);return function(t,e){if(e.xt()){var n=Zo(t);if(null!==n&&!n.isEqual(e.field))throw new qr(jr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=$o(t))&&Wy(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new qr(jr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new qr(jr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t.C_,e,t.firestore.I_,this.Xf,this.Zf,this.td),new Yp(t.firestore,t.v_,(e=(t=t.C_).filters.concat([e]),new Jo(t.path,t.collectionGroup,t.Nt.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},Gy),Vy=(p(By,Ly=Ne),By.prototype.Yf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new qr(jr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new qr(jr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Go(e,n);return e=r,null!==$o(n=t)||null!==(t=Zo(n))&&Wy(0,t,e.field),r}(t.C_,this.Xf,this.ed);return new Yp(t.firestore,t.v_,(e=(t=t.C_).Nt.concat([e]),new Jo(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},By),My=(p(Hy,Py=Ne),Hy.prototype.Yf=function(t){return new Yp(t.firestore,t.v_,rs(t.C_,this.nd,this.sd))},Hy),Uy=(p(Fy,ky=Ne),Fy.prototype.Yf=function(t){var e=zy(t,this.type,this.rd,this.od);return new Yp(t.firestore,t.v_,(t=t.C_,e=e,new Jo(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},Fy),jy=(p(qy,Oy=Ne),qy.prototype.Yf=function(t){var e=zy(t,this.type,this.rd,this.od);return new Yp(t.firestore,t.v_,(t=t.C_,e=e,new Jo(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},qy);function qy(t,e,n){var r=this;return(r=Oy.call(this)||this).type=t,r.rd=e,r.od=n,r}function Fy(t,e,n){var r=this;return(r=ky.call(this)||this).type=t,r.rd=e,r.od=n,r}function Hy(t,e,n){var r=this;return(r=Py.call(this)||this).type=t,r.nd=e,r.sd=n,r}function By(t,e){var n=this;return(n=Ly.call(this)||this).Xf=t,n.ed=e,n.type="orderBy",n}function Gy(t,e,n){var r=this;return(r=Cy.call(this)||this).Xf=t,r.Zf=e,r.td=n,r.type="where",r}function zy(t,e,n,r){if(n[0]instanceof Hr&&(n[0]=n[0]._),n[0]instanceof _y)return function(t,n,r,i){if(!r)throw new qr(jr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+e+"().");for(var o=[],s=0,u=es(t);s<u.length;s++){var a=u[s];if(a.field.ht())o.push(Ki(n,r.key));else{var c=r.field(a.field);if(Ri(c))throw new qr(jr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c)throw a=a.field.ot(),new qr(jr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+a+"' (used as the orderBy) does not exist.");o.push(c)}}return new Uo(o,i)}(t.C_,t.firestore.I_,n[0].Jf,r);var i=wd(t.firestore);return function(t,e,n,r,i,o){var s=t.Nt;if(i.length>s.length)throw new qr(jr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.ht()){if("string"!=typeof c)throw new qr(jr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!ts(t)&&-1!==c.indexOf("/"))throw new qr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(vi.ct(c));if(!wi.Et(h))throw new qr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new wi(h),u.push(Ki(e,h))}else c=jd(n,r,c),u.push(c)}return new Uo(u,o)}(t.C_,t.firestore.I_,i,e,n,r)}function Ky(t,e,n){if(n instanceof Hr&&(n=n._),"string"==typeof n){if(""===n)throw new qr(jr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!ts(e)&&-1!==n.indexOf("/"))throw new qr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(vi.ct(n)),!wi.Et(e))throw new qr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Ki(t,new wi(e))}if(n instanceof Xp)return Ki(t,n.S_);throw new qr(jr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Hp(n)+".")}function Jy(t,e){if(!Array.isArray(t)||0===t.length)throw new qr(jr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new qr(jr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Wy(t,e,n){if(!n.isEqual(e))throw new qr(jr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Xy(t){return function(){if("object"==typeof t&&null!==t)for(var e=t,n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return 1}}()}function Yy(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Qy,$y,Zy,tv=(p(cv,Zy=h),cv.prototype.Uf=function(t){return new Fr(t)},cv.prototype.Qf=function(t){return t=this.Gf(t,this.firestore.I_),new Xp(this.firestore,null,t)},cv),ev=(av.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},av),nv=(p(uv,$y=_y),uv.prototype.exists=function(){return $y.prototype.exists.call(this)},uv.prototype.data=function(t){if(void 0===t&&(t={}),this.Jf){if(this.v_){var e=new rv(this.zf,this.Hf,this.S_,this.Jf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Hf.$f(this.Jf.vt(),t.serverTimestamps)}},uv.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Jf&&null!==(t=this.Jf.data().field(Ay("DocumentSnapshot.get",t))))return this.Hf.$f(t,e.serverTimestamps)},uv),rv=(p(sv,Qy=nv),sv.prototype.data=function(t){return void 0===t&&(t={}),Qy.prototype.data.call(this,t)},sv),iv=(Object.defineProperty(ov.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(ov.prototype,"size",{get:function(){return this.ud.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(ov.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),ov.prototype.forEach=function(t,e){var n=this;this.ud.docs.forEach((function(r){t.call(e,new rv(n.zf,n.Hf,r.key,r,new ev(n.ud.Ce.has(r.key),n.ud.fromCache),n.query.v_))}))},ov.prototype.docChanges=function(t){if(void 0===t&&(t={}),(t=!!t.includeMetadataChanges)&&this.ud.Ne)throw new qr(jr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.hd&&this.ld===t||(this.hd=function(t,e){if(t.ud.De.nt()){var n=0;return t.ud.docChanges.map((function(e){var r=new rv(t.zf,t.Hf,e.doc.key,e.doc,new ev(t.ud.Ce.has(e.doc.key),t.ud.fromCache),t.query.v_);return e.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=t.ud.De;return t.ud.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new rv(t.zf,t.Hf,e.doc.key,e.doc,new ev(t.ud.Ce.has(e.doc.key),t.ud.fromCache),t.query.v_),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Dr()}}(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,t),this.ld=t),this.hd},ov);function ov(t,e,n,r){this.zf=t,this.Hf=e,this.ud=r,this.metadata=new ev(r.hasPendingWrites,r.fromCache),this.query=n}function sv(){return null!==Qy&&Qy.apply(this,arguments)||this}function uv(t,e,n,r,i,o){var s=this;return(s=$y.call(this,t,e,n,r,o)||this).zf=t,s.ad=t,s.metadata=i,s}function av(t,e){this.hasPendingWrites=t,this.fromCache=e}function cv(t){var e=this;return(e=Zy.call(this)||this).firestore=t,e}function hv(t,e){return t instanceof nv&&e instanceof nv?t.zf===e.zf&&t.S_.isEqual(e.S_)&&(null===t.Jf?null===e.Jf:t.Jf.isEqual(e.Jf))&&t.v_===e.v_:t instanceof iv&&e instanceof iv&&t.zf===e.zf&&sd(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.ud.isEqual(e.ud)}var fv,lv=(p(pv,fv=h),pv.prototype.Uf=function(t){return new Fr(t)},pv.prototype.Qf=function(t){return t=this.Gf(t,this.firestore.I_),new Xp(this.firestore,null,t)},pv);function pv(t){var e=this;return(e=fv.call(this)||this).firestore=t,e}function dv(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Bp(t,Xp);var o=Bp(t.firestore,dy),s=wd(o);return e instanceof Hr&&(e=e._),vv(o,[("string"==typeof e||e instanceof Pp?Ud(s,"updateDoc",t.S_,e,n,r):Md(s,"updateDoc",t.S_,e)).O_(t.S_,Ls.exists(!0))])}function yv(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t instanceof Hr&&(t=t._);var r={includeMetadataChanges:!1},i=0;"object"!=typeof e[i]||Xy(e[i])||(r=e[i],i++);var o,s,u,a,c,h,f={includeMetadataChanges:r.includeMetadataChanges};return Xy(e[i])&&(o=e[i],e[i]=null===(r=o.next)||void 0===r?void 0:r.bind(o),e[i+1]=null===(r=o.error)||void 0===r?void 0:r.bind(o),e[i+2]=null===(r=o.complete)||void 0===r?void 0:r.bind(o)),t instanceof Xp?(u=Bp(t.firestore,dy),a=Xo(t.S_.path),h={next:function(n){e[i]&&e[i](gv(u,t,n))},error:e[i+1],complete:e[i+2]}):(s=Bp(t,Yp),u=Bp(s.firestore,dy),a=s.C_,c=new lv(u),h={next:function(t){e[i]&&e[i](new iv(u,c,s,t))},error:e[i+1],complete:e[i+2]},xy(t.C_)),function(t,e,n){var r=this,i=new Op(h),o=new Rl(e,i,n);return t.fs.ys((function(){return d(r,void 0,void 0,(function(){var e;return y(this,(function(n){switch(n.label){case 0:return e=Pl,[4,cy(t)];case 1:return[2,e.apply(void 0,[n.sent(),o])]}}))}))})),function(){i.r_(),t.fs.ys((function(){return d(r,void 0,void 0,(function(){var e;return y(this,(function(n){switch(n.label){case 0:return e=Ll,[4,cy(t)];case 1:return[2,e.apply(void 0,[n.sent(),o])]}}))}))}))}}(gy(u),a,f)}function vv(t,e){return function(t,e){var n=this,r=new ya;return t.fs.ys((function(){return d(n,void 0,void 0,(function(){var n;return y(this,(function(i){switch(i.label){case 0:return n=Zl,[4,ay(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(gy(t),e)}function gv(t,e,n){var r=n.docs.get(e.S_),i=new lv(t);return new nv(t,i,e.S_,r,new ev(n.hasPendingWrites,n.fromCache),e.v_)}var mv=(wv.prototype.set=function(t,e,n){return this.Ed(),e=Yy((t=bv(t,this.zf)).v_,e,n),n=bd(this.wd,"WriteBatch.set",t.S_,e,null!==t.v_,n),this.fd.push(n.O_(t.S_,Ls.jt())),this},wv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return this.Ed(),t=bv(t,this.zf),e instanceof Hr&&(e=e._),e="string"==typeof e||e instanceof Pp?Ud(this.wd,"WriteBatch.update",t.S_,e,n,r):Md(this.wd,"WriteBatch.update",t.S_,e),this.fd.push(e.O_(t.S_,Ls.exists(!0))),this},wv.prototype.delete=function(t){return this.Ed(),t=bv(t,this.zf),this.fd=this.fd.concat(new Zs(t.S_,Ls.jt())),this},wv.prototype.commit=function(){return this.Ed(),this.dd=!0,0<this.fd.length?this._d(this.fd):Promise.resolve()},wv.prototype.Ed=function(){if(this.dd)throw new qr(jr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},wv);function wv(t,e){this.zf=t,this._d=e,this.fd=[],this.dd=!1,this.wd=wd(t)}function bv(t,e){if(t instanceof Hr&&(t=t._),t.firestore!==e)throw new qr(jr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var Iv,_v,Ev,Tv=(Pv.prototype.get=function(t){var e=this,n=bv(t,this.zf),r=new tv(this.zf);return this.Td.ef([n.S_]).then((function(t){if(!t||1!==t.length)return Dr();if((t=t[0])instanceof so)return new _y(e.zf,r,n.S_,null,n.v_);if(t instanceof oo)return new _y(e.zf,r,t.key,t,n.v_);throw Dr()}))},Pv.prototype.set=function(t,e,n){return e=Yy((t=bv(t,this.zf)).v_,e,n),n=bd(this.wd,"Transaction.set",t.S_,e,null!==t.v_,n),this.Td.set(t.S_,n),this},Pv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return t=bv(t,this.zf),e instanceof Hr&&(e=e._),e="string"==typeof e||e instanceof Pp?Ud(this.wd,"Transaction.update",t.S_,e,n,r):Md(this.wd,"Transaction.update",t.S_,e),this.Td.update(t.S_,e),this},Pv.prototype.delete=function(t){return t=bv(t,this.zf),this.Td.delete(t.S_),this},p(kv,Ev=Pv),kv.prototype.get=function(t){var e=this,n=bv(t,this.zf),r=new lv(this.zf);return Ev.prototype.get.call(this,t).then((function(t){return new nv(e.zf,r,n.S_,t.Jf,new ev(!1,!1),n.v_)}))},kv),Nv=(Ov.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){by(t=Bp(t,dy));var n=gy(t),r=t.p_();return wy(n,t=new Tp,new _p(t,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._,{forceOwnership:e})},Ov.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){by(t=Bp(t,dy));var e=gy(t),n=t.p_();return wy(e,t=new Tp,new Ep(t,n.cacheSizeBytes))}(t._)},Ov.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t.R_&&!t.P_)throw new qr(jr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new ya;return t.Mf.Tf((function(){return d(e,void 0,void 0,(function(){var e;return y(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return d(this,void 0,void 0,(function(){var e;return y(this,(function(n){switch(n.label){case 0:return ma.jn()?(e=t+"main",[4,ma.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(xh(t.I_,t.w_))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t._)},Ov),Sv=(p(Dv,_v=Hr),Object.defineProperty(Dv.prototype,"I_",{get:function(){return this._.I_},enumerable:!1,configurable:!0}),Dv.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._.V_()),t)).merge,this._.g_(t)},Dv.prototype.useEmulator=function(t,e){var n,r;r=t,t=e,"firestore.googleapis.com"!==(e=(n=Bp(n=this._,Wp)).V_()).host&&e.host!==r&&Ar("Host has been set in both settings() and useEmulator(), emulator host will be used"),n.g_(Object.assign(Object.assign({},e),{host:r+":"+t,ssl:!1}))},Dv.prototype.enableNetwork=function(){return function(t){var e=this;return t.fs.enqueue((function(){return d(e,void 0,void 0,(function(){var e,n;return y(this,(function(r){switch(r.label){case 0:return[4,oy(t)];case 1:return e=r.sent(),[4,uy(t)];case 2:return n=r.sent(),[2,(e.Vo(!0),(r=n).Oh.delete(0),fl(r))]}}))}))}))}(gy(Bp(this._,dy)))},Dv.prototype.disableNetwork=function(){return function(t){var e=this;return t.fs.enqueue((function(){return d(e,void 0,void 0,(function(){var e,n;return y(this,(function(r){switch(r.label){case 0:return[4,oy(t)];case 1:return e=r.sent(),[4,uy(t)];case 2:return n=r.sent(),[2,(e.Vo(!1),function(t){return d(this,void 0,void 0,(function(){var e;return y(this,(function(n){switch(n.label){case 0:return(e=t).Oh.add(0),[4,ll(e)];case 1:return n.sent(),e.Mh.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(gy(Bp(this._,dy)))},Dv.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&jp("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Id.enableMultiTabIndexedDbPersistence(this):this.Id.enableIndexedDbPersistence(this,n)},Dv.prototype.clearPersistence=function(){return this.Id.clearIndexedDbPersistence(this)},Dv.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this._._delete()},Dv.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new ya;return t.fs.ys((function(){return d(e,void 0,void 0,(function(){var e;return y(this,(function(r){switch(r.label){case 0:return e=rp,[4,ay(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(gy(Bp(this._,dy)))},Dv.prototype.onSnapshotsInSync=function(t){return t=t,function(t,e){var n=this,r=new Op(e);return t.fs.ys((function(){return d(n,void 0,void 0,(function(){var e;return y(this,(function(n){switch(n.label){case 0:return e=function(t,e){t.Wh.add(e),e.next()},[4,cy(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.r_(),t.fs.ys((function(){return d(n,void 0,void 0,(function(){var e;return y(this,(function(n){switch(n.label){case 0:return e=function(t,e){t.Wh.delete(e)},[4,cy(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(gy(Bp(this._,dy)),Xy(t)?t:{next:t})},Object.defineProperty(Dv.prototype,"app",{get:function(){if(!this.md)throw new qr(jr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.md},enumerable:!1,configurable:!0}),Dv.prototype.collection=function(t){try{return new ng(this,rd(this._,t))}catch(t){throw Hv(t,"collection()","Firestore.collection()")}},Dv.prototype.doc=function(t){try{return new Uv(this,id(this._,t))}catch(t){throw Hv(t,"doc()","Firestore.doc()")}},Dv.prototype.collectionGroup=function(t){try{return new Zv(this,function(t,e){if(t=Bp(t,Wp),Mp("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new qr(jr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Yp(t,null,(e=e,new Jo(vi.at(),e)))}(this._,t))}catch(t){throw Hv(t,"collectionGroup()","Firestore.collectionGroup()")}},Dv.prototype.runTransaction=function(t){var e,n=this;return function(t,e){var n=this,r=new ya;return t.fs.ys((function(){return d(n,void 0,void 0,(function(){var n;return y(this,(function(i){switch(i.label){case 0:return[4,iy(t).then((function(t){return t.Dh}))];case 1:return n=i.sent(),new Yd(t.fs,n,e,r).run(),[2]}}))}))})),r.promise}(gy(e=this._),(function(r){return r=new Tv(e,r),t(new Vv(n,r))}))},Dv.prototype.batch=function(){var t=this;return gy(this._),new Mv(new mv(this._,(function(e){return vv(t._,e)})))},Dv.prototype.loadBundle=function(t){throw new qr(jr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},Dv.prototype.namedQuery=function(t){throw new qr(jr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},Dv),Av=(p(xv,Iv=h),xv.prototype.Uf=function(t){return new Wr(new Fr(t))},xv.prototype.Qf=function(t){return t=this.Gf(t,this.firestore.I_),Uv.Ad(t,this.firestore,null)},xv);function xv(t){var e=this;return(e=Iv.call(this)||this).firestore=t,e}function Dv(t,e,n){var r=this;return(r=_v.call(this,e)||this).Id=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof Yr||(r.md=t),r}function Ov(){}function kv(t,e){var n=this;return(n=Ev.call(this,t,e)||this).zf=t,n}function Pv(t,e){this.zf=t,this.Td=e,this.wd=wd(t)}var Lv,Cv,Rv,Vv=(p(Fv,Rv=Hr),Fv.prototype.get=function(t){var e=this,n=cg(t);return this._.get(n).then((function(t){return new Qv(e.zf,new nv(e.zf._,e.Hf,t.S_,t.Jf,t.metadata,n.v_))}))},Fv.prototype.set=function(t,e,n){return t=cg(t),n?(Up("Transaction.set",n),this._.set(t,e,n)):this._.set(t,e),this},Fv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=cg(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,v([o,e,n],r)),this},Fv.prototype.delete=function(t){return t=cg(t),this._.delete(t),this},Fv),Mv=(p(qv,Cv=Hr),qv.prototype.set=function(t,e,n){return t=cg(t),n?(Up("WriteBatch.set",n),this._.set(t,e,n)):this._.set(t,e),this},qv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=cg(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,v([o,e,n],r)),this},qv.prototype.delete=function(t){return t=cg(t),this._.delete(t),this},qv.prototype.commit=function(){return this._.commit()},qv),Uv=(p(jv,Lv=Hr),jv.Rd=function(t,e,n){if(t.length%2!=0)throw new qr(jr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.ot()+" has "+t.length);return new jv(e,new Xp(e._,n,new wi(t)))},jv.Ad=function(t,e,n){return new jv(e,new Xp(e._,n,t))},Object.defineProperty(jv.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(jv.prototype,"parent",{get:function(){return new ng(this.firestore,this._.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(jv.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),jv.prototype.collection=function(t){try{return new ng(this.firestore,rd(this._,t))}catch(t){throw Hv(t,"collection()","DocumentReference.collection()")}},jv.prototype.isEqual=function(t){return t instanceof Hr&&(t=t._),t instanceof Xp&&od(this._,t)},jv.prototype.set=function(t,e){e=Up("DocumentReference.set",e);try{return function(t,e,n){t=Bp(t,Xp);var r=Bp(t.firestore,dy);return e=Yy(t.v_,e,n),vv(r,[bd(wd(r),"setDoc",t.S_,e,null!==t.v_,n).O_(t.S_,Ls.jt())])}(this._,t,e)}catch(t){throw Hv(t,"setDoc()","DocumentReference.set()")}},jv.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?dv(this._,t):dv.apply(void 0,v([this._,t,e],n))}catch(t){throw Hv(t,"updateDoc()","DocumentReference.update()")}},jv.prototype.delete=function(){return vv(Bp((t=this._).firestore,dy),[new Zs(t.S_,Ls.jt())]);var t},jv.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Bv(e),i=Gv(e,(function(e){return new Qv(t.firestore,new nv(t.firestore._,t.Hf,e.S_,e.Jf,e.metadata,t._.v_))}));return yv(this._,r,i)},jv.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Bp(t,Xp);var e=Bp(t.firestore,dy),n=gy(e),r=new lv(e);return function(t,e){var n=this,r=new ya;return t.fs.ys((function(){return d(n,void 0,void 0,(function(){var n;return y(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return d(this,void 0,void 0,(function(){var r,i;return y(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,(s=e,(u=t).persistence.runTransaction("read document","readonly",(function(t){return u.Ic.Jo(t,s)})))];case 1:return(i=o.sent())instanceof oo?n.resolve(i):i instanceof so?n.resolve(null):n.reject(new qr(jr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=Ca(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}var s,u}))}))},[4,sy(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t.S_).then((function(n){return new nv(e,r,t.S_,n,new ev(n instanceof oo&&n.bt,!0),t.v_)}))}:"server"===(null==t?void 0:t.source)?function(t){t=Bp(t,Xp);var e=Bp(t.firestore,dy);return hy(gy(e),t.S_,{source:"server"}).then((function(n){return gv(e,t,n)}))}:function(t){t=Bp(t,Xp);var e=Bp(t.firestore,dy);return hy(gy(e),t.S_).then((function(n){return gv(e,t,n)}))})(this._).then((function(t){return new Qv(e.firestore,new nv(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))}))},jv.prototype.withConverter=function(t){return new jv(this.firestore,this._.withConverter(t))},jv);function jv(t,e){var n=this;return(n=Lv.call(this,e)||this).firestore=t,n.Hf=new Av(t),n}function qv(){return null!==Cv&&Cv.apply(this,arguments)||this}function Fv(t,e){var n=this;return(n=Rv.call(this,e)||this).zf=t,n.Hf=new Av(t),n}function Hv(t,e,n){return t.message=t.message.replace(e,n),t}function Bv(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Xy(r))return r}return{}}function Gv(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=Xy(t[0])?t[0]:Xy(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var zv,Kv,Jv,Wv,Xv,Yv,Qv=(p(ag,Yv=Hr),Object.defineProperty(ag.prototype,"ref",{get:function(){return new Uv(this.zf,this._.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(ag.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(ag.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(ag.prototype,"exists",{get:function(){return this._.exists()},enumerable:!1,configurable:!0}),ag.prototype.data=function(t){return this._.data(t)},ag.prototype.get=function(t,e){return this._.get(t,e)},ag.prototype.isEqual=function(t){return hv(this._,t._)},ag),$v=(p(ug,Xv=Qv),ug.prototype.data=function(t){return this._.data(t)},ug),Zv=(p(sg,Wv=Hr),sg.prototype.where=function(t,e,n){try{return new sg(this.firestore,Dy(this._,(r=n,i=e,o=Ay("where",t),new Ry(o,i,r))))}catch(t){throw Hv(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},sg.prototype.orderBy=function(t,e){try{return new sg(this.firestore,Dy(this._,function(e){void 0===e&&(e="asc");var n=e;return e=Ay("orderBy",t),new Vy(e,n)}(e)))}catch(t){throw Hv(t,/(orderBy|where)\(\)/,"Query.$1()")}},sg.prototype.limit=function(t){try{return new sg(this.firestore,Dy(this._,(Gp("limit",e=t),new My("limit",e,"F"))))}catch(t){throw Hv(t,"limit()","Query.limit()")}var e},sg.prototype.limitToLast=function(t){try{return new sg(this.firestore,Dy(this._,(Gp("limitToLast",e=t),new My("limitToLast",e,"L"))))}catch(t){throw Hv(t,"limitToLast()","Query.limitToLast()")}var e},sg.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new sg(this.firestore,Dy(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Uy("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Hv(t,"startAt()","Query.startAt()")}},sg.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new sg(this.firestore,Dy(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Uy("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Hv(t,"startAfter()","Query.startAfter()")}},sg.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new sg(this.firestore,Dy(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new jy("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Hv(t,"endBefore()","Query.endBefore()")}},sg.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new sg(this.firestore,Dy(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new jy("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Hv(t,"endAt()","Query.endAt()")}},sg.prototype.isEqual=function(t){return sd(this._,t._)},sg.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Bp(t,Yp);var e=Bp(t.firestore,dy),n=gy(e),r=new lv(e);return function(t,e){var n=this,r=new ya;return t.fs.ys((function(){return d(n,void 0,void 0,(function(){var n;return y(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return d(this,void 0,void 0,(function(){var r,i,o;return y(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,Kh(t,e,!0)];case 1:return o=s.sent(),r=new Kl(e,o.Pc),i=r.dl(o.documents),i=r.Ei(i,!1),n.resolve(i.snapshot),[3,3];case 2:return i=s.sent(),o=Ca(i,"Failed to execute query '"+e+" against cache"),n.reject(o),[3,3];case 3:return[2]}}))}))},[4,sy(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t.C_).then((function(n){return new iv(e,r,t,n)}))}:"server"===(null==t?void 0:t.source)?function(t){t=Bp(t,Yp);var e=Bp(t.firestore,dy),n=gy(e),r=new lv(e);return fy(n,t.C_,{source:"server"}).then((function(n){return new iv(e,r,t,n)}))}:function(t){t=Bp(t,Yp);var e=Bp(t.firestore,dy),n=gy(e),r=new lv(e);return xy(t.C_),fy(n,t.C_).then((function(n){return new iv(e,r,t,n)}))})(this._).then((function(t){return new eg(e.firestore,new iv(e.firestore._,e.Hf,e._,t.ud))}))},sg.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Bv(e),i=Gv(e,(function(e){return new eg(t.firestore,new iv(t.firestore._,t.Hf,t._,e.ud))}));return yv(this._,r,i)},sg.prototype.withConverter=function(t){return new sg(this.firestore,this._.withConverter(t))},sg),tg=(p(og,Jv=Hr),Object.defineProperty(og.prototype,"type",{get:function(){return this._.type},enumerable:!1,configurable:!0}),Object.defineProperty(og.prototype,"doc",{get:function(){return new $v(this.zf,this._.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(og.prototype,"oldIndex",{get:function(){return this._.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(og.prototype,"newIndex",{get:function(){return this._.newIndex},enumerable:!1,configurable:!0}),og),eg=(p(ig,Kv=Hr),Object.defineProperty(ig.prototype,"query",{get:function(){return new Zv(this.zf,this._.query)},enumerable:!1,configurable:!0}),Object.defineProperty(ig.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(ig.prototype,"size",{get:function(){return this._.size},enumerable:!1,configurable:!0}),Object.defineProperty(ig.prototype,"empty",{get:function(){return this._.empty},enumerable:!1,configurable:!0}),Object.defineProperty(ig.prototype,"docs",{get:function(){var t=this;return this._.docs.map((function(e){return new $v(t.zf,e)}))},enumerable:!1,configurable:!0}),ig.prototype.docChanges=function(t){var e=this;return this._.docChanges(t).map((function(t){return new tg(e.zf,t)}))},ig.prototype.forEach=function(t,e){var n=this;this._.forEach((function(r){t.call(e,new $v(n.zf,r))}))},ig.prototype.isEqual=function(t){return hv(this._,t._)},ig),ng=(p(rg,zv=Zv),Object.defineProperty(rg.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(rg.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Object.defineProperty(rg.prototype,"parent",{get:function(){var t=this._.parent;return t?new Uv(this.firestore,t):null},enumerable:!1,configurable:!0}),rg.prototype.doc=function(t){try{return new Uv(this.firestore,void 0===t?id(this._):id(this._,t))}catch(t){throw Hv(t,"doc()","CollectionReference.doc()")}},rg.prototype.add=function(t){var e,n,r,i=this;return n=t,t=Bp((e=this._).firestore,dy),r=id(e),n=Yy(e.v_,n),vv(t,[bd(wd(e.firestore),"addDoc",r.S_,n,null!==e.v_,{}).O_(r.S_,Ls.exists(!1))]).then((function(){return r})).then((function(t){return new Uv(i.firestore,t)}))},rg.prototype.isEqual=function(t){return od(this._,t._)},rg.prototype.withConverter=function(t){return new rg(this.firestore,this._.withConverter(t))},rg);function rg(t,e){var n=this;return(n=zv.call(this,t,e)||this).firestore=t,n._=e,n}function ig(t,e){var n=this;return(n=Kv.call(this,e)||this).zf=t,n}function og(t,e){var n=this;return(n=Jv.call(this,e)||this).zf=t,n}function sg(t,e){var n=this;return(n=Wv.call(this,e)||this).firestore=t,n.Hf=new Av(t),n}function ug(){return null!==Xv&&Xv.apply(this,arguments)||this}function ag(t,e){var n=this;return(n=Yv.call(this,e)||this).zf=t,n}function cg(t){return t instanceof Hr&&(t=t._),Bp(t,Xp)}p(yg,fg=Hr),yg.documentId=function(){return new yg(mi.lt().ot())},yg.prototype.isEqual=function(t){return t instanceof Hr&&(t=t._),t instanceof Pp&&this._.d_.isEqual(t.d_)},Ne=yg,p(dg,hg=Hr),dg.serverTimestamp=function(){var t=new Dd("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new dg(t)},dg.delete=function(){var t=new _d("deleteField");return t._methodName="FieldValue.delete",new dg(t)},dg.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Od("arrayUnion",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayUnion",new dg(n)},dg.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new kd("arrayRemove",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayRemove",new dg(n)},dg.increment=function(t){return(t=new Pd("increment",t))._methodName="FieldValue.increment",new dg(t)},dg.prototype.isEqual=function(t){return this._.isEqual(t._)},h=dg;var hg,fg,lg=(pg.prototype.onProgress=function(t,e,n){this.Pd={next:t,error:e,complete:n}},pg.prototype.catch=function(t){return this.yd.promise.catch(t)},pg.prototype.then=function(t,e){return this.yd.promise.then(t,e)},pg.prototype.Ul=function(t){this.Ql(t),this.Pd.complete&&this.Pd.complete(),this.yd.resolve(t)},pg.prototype.jl=function(t){this.gd.taskState="Error",this.Pd.next&&this.Pd.next(this.gd),this.Pd.error&&this.Pd.error(t),this.yd.reject(t)},pg.prototype.Ql=function(t){this.gd=t,this.Pd.next&&this.Pd.next(t)},pg);function pg(){this.Pd={},this.yd=new ya,this.gd={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function dg(){return null!==hg&&hg.apply(this,arguments)||this}function yg(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return fg.call(this,new(Pp.bind.apply(Pp,v([void 0],t))))||this}var vg=(gg.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},gg.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},gg.prototype.setServiceProps=function(t){return this.serviceProps=t,this},gg);function gg(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var mg,wg,bg={Firestore:Sv,GeoPoint:ud,Timestamp:di,Blob:Wr,Transaction:Vv,WriteBatch:Mv,DocumentReference:Uv,DocumentSnapshot:Qv,Query:Zv,QueryDocumentSnapshot:$v,QuerySnapshot:eg,CollectionReference:ng,FieldPath:Ne,FieldValue:h,setLogLevel:function(t){Er.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(mg=i.default).INTERNAL.registerComponent(new vg("firestore",(function(t){var e=t.getProvider("app").getImmediate();return e=e,t=t.getProvider("auth-internal"),new Sv(e,new dy(e,t),new Nv)}),"PUBLIC").setServiceProps(Object.assign({},bg))),mg.registerVersion("@firebase/firestore","2.1.2"),(wg=Sv).prototype.loadBundle=function(t){return function(t,e){var n=new lg;return function(t,n,r){var i,o=this,s=(i=e,n=Xf(n),i=function(t){if(t instanceof Uint8Array)return Dp(t,void 0);if(t instanceof ArrayBuffer)return Dp(new Uint8Array(t),void 0);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof i?(new TextEncoder).encode(i):i),new kp(i,n));t.fs.ys((function(){return d(o,void 0,void 0,(function(){var e;return y(this,(function(n){switch(n.label){case 0:return e=mp,[4,ay(t)];case 1:return e.apply(void 0,[n.sent(),s,r]),[2]}}))}))}))}(gy(t._),t.I_,n),n}(this,t)},wg.prototype.namedQuery=function(t){return t=t,function(t,e){var n=this;return t.fs.enqueue((function(){return d(n,void 0,void 0,(function(){var n;return y(this,(function(r){switch(r.label){case 0:return n=function(t,e){var n=t;return n.persistence.runTransaction("Get named query","readonly",(function(t){return n.Eo.$s(t,e)}))},[4,sy(t)];case 1:return[2,n.apply(void 0,[r.sent(),e])]}}))}))}))}(gy((e=this)._),t).then((function(t){return t?new Zv(e,new Yp(e._,null,t.query)):null}));var e}}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}}(n(2))}).call(this,n(59),n(146))}}]);